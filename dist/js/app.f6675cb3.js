(function(e){function t(t){for(var n,s,i=t[0],c=t[1],r=t[2],d=0,u=[];d<i.length;d++)s=i[d],Object.prototype.hasOwnProperty.call(l,s)&&l[s]&&u.push(l[s][0]),l[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);p&&p(t);while(u.length)u.shift()();return o.push.apply(o,r||[]),a()}function a(){for(var e,t=0;t<o.length;t++){for(var a=o[t],n=!0,s=1;s<a.length;s++){var i=a[s];0!==l[i]&&(n=!1)}n&&(o.splice(t--,1),e=c(c.s=a[0]))}return e}var n={},s={app:0},l={app:0},o=[];function i(e){return c.p+"js/"+({}[e]||e)+"."+{"chunk-072d4340":"ad3f2beb","chunk-28f0112b":"f29ae4c0"}[e]+".js"}function c(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,c),a.l=!0,a.exports}c.e=function(e){var t=[],a={"chunk-072d4340":1,"chunk-28f0112b":1};s[e]?t.push(s[e]):0!==s[e]&&a[e]&&t.push(s[e]=new Promise((function(t,a){for(var n="css/"+({}[e]||e)+"."+{"chunk-072d4340":"512942e3","chunk-28f0112b":"f506f81f"}[e]+".css",l=c.p+n,o=document.getElementsByTagName("link"),i=0;i<o.length;i++){var r=o[i],d=r.getAttribute("data-href")||r.getAttribute("href");if("stylesheet"===r.rel&&(d===n||d===l))return t()}var u=document.getElementsByTagName("style");for(i=0;i<u.length;i++){r=u[i],d=r.getAttribute("data-href");if(d===n||d===l)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var n=t&&t.target&&t.target.src||l,o=new Error("Loading CSS chunk "+e+" failed.\n("+n+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=n,delete s[e],p.parentNode.removeChild(p),a(o)},p.href=l;var f=document.getElementsByTagName("head")[0];f.appendChild(p)})).then((function(){s[e]=0})));var n=l[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,a){n=l[e]=[t,a]}));t.push(n[2]=o);var r,d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=i(e);var u=new Error;r=function(t){d.onerror=d.onload=null,clearTimeout(p);var a=l[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),s=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+n+": "+s+")",u.name="ChunkLoadError",u.type=n,u.request=s,a[1](u)}l[e]=void 0}};var p=setTimeout((function(){r({type:"timeout",target:d})}),12e4);d.onerror=d.onload=r,document.head.appendChild(d)}return Promise.all(t)},c.m=e,c.c=n,c.d=function(e,t,a){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(c.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(a,n,function(t){return e[t]}.bind(null,n));return a},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var r=window["webpackJsonp"]=window["webpackJsonp"]||[],d=r.push.bind(r);r.push=t,r=r.slice();for(var u=0;u<r.length;u++)t(r[u]);var p=d;o.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"00ea":function(e,t,a){},"02ea":function(e,t,a){},"034f":function(e,t,a){"use strict";a("85ec")},"051e":function(e,t,a){},"056a":function(e,t,a){},"0c15":function(e,t,a){"use strict";a("f2ba")},"11e3":function(e,t,a){},"181c":function(e,t,a){},"1f57":function(e,t,a){"use strict";a("051e")},"22b4":function(e,t,a){"use strict";a("3b30")},2779:function(e,t,a){"use strict";a("9b3f")},"2c6a":function(e,t,a){"use strict";a("db90")},"2f03":function(e,t,a){"use strict";a("88d9")},"34c4":function(e,t,a){},"3b09":function(e,t,a){},"3b30":function(e,t,a){},"3e49":function(e,t,a){},"406b":function(e,t,a){},"409f":function(e,t,a){"use strict";a("6aa7")},"4e39":function(e,t,a){},5051:function(e,t,a){},5075:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},l=[],o={data:function(){return{}}},i=o,c=(a("034f"),a("2877")),r=Object(c["a"])(i,s,l,!1,null,null,null),d=r.exports,u=(a("d3b7"),a("8c4f")),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-Register"},[a("div",{staticClass:"head-btn"},[a("div",{staticClass:"oper-btns-left"},[a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1),a("div",{staticClass:"input"},[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),a("div",{staticClass:"input"},[a("el-input",{attrs:{placeholder:"姓名"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),a("div",{staticClass:"input"},[a("el-input",{attrs:{placeholder:"邮箱"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),a("div",{staticClass:"search"},[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1)]),["ROOT","ADMIN"].includes(e.userRole)?a("div",{staticClass:"oper-btns-right"},[a("el-button",{staticClass:"bigdel-btn",attrs:{icon:"el-icon-delete"},on:{click:e.delectExtraInfo}},[e._v("批量删除")])],1):e._e()]),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"id",label:"用户ID",width:"100"}}),a("el-table-column",{attrs:{prop:"username",label:"用户名",width:"150"}}),a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"150"}}),a("el-table-column",{attrs:{prop:"email",label:"用户邮箱"}}),a("el-table-column",{attrs:{prop:"userrole",label:"用户权限"}}),["ROOT","ADMIN"].includes(e.userRole)?a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("修改")]),a("el-button",{on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}],null,!1,3922900450)}):e._e()],1)],1)},f=[],m=(a("4160"),a("a434"),a("b0c0"),a("159b"),a("bc3a")),v=a.n(m);v.a.defaults.headers.common["Authorization"]=localStorage.getItem("token");var h={created:function(){var e=this;v.a.get("http://47.102.214.37:8080/user/me").then((function(t){console.log(t.data),e.userRole=t.data.role})),setTimeout((function(){v.a.get("http://47.102.214.37:8080/user/query").then((function(t){console.log(t),e.total=t.data.content.length;for(var a=0;a<t.data.content.length;a++)"ROOT"==t.data.content[a].role?e.tableData.unshift({id:t.data.content[a].id,username:t.data.content[a].username,userrole:t.data.content[a].role,name:t.data.content[a].name,email:t.data.content[a].email}):"ADMIN"==t.data.content[a].role&&e.tableData.push({id:t.data.content[a].id,username:t.data.content[a].username,userrole:t.data.content[a].role,name:t.data.content[a].name,email:t.data.content[a].email});for(var n=0;n<t.data.content.length;n++)"ROOT"!=t.data.content[n].role&&"ADMIN"!=t.data.content[n].role&&e.tableData.push({id:t.data.content[n].id,username:t.data.content[n].username,userrole:t.data.content[n].role,name:t.data.content[n].name,email:t.data.content[n].email})}))}),200)},data:function(){return{userRole:"",tableData:[],checkedDetail:[],currentPage:1,page:1,size:10,total:0,username:"",name:"",email:""}},methods:{handleDetailSelectionChange:function(e){this.checkedDetail=e},refresh:function(){var e=this;e.tableData=[],v.a.get("http://47.102.214.37:8080/user/query").then((function(t){console.log(t),e.total=t.data.content.length;for(var a=0;a<t.data.content.length;a++)"ROOT"==t.data.content[a].role?e.tableData.unshift({id:t.data.content[a].id,username:t.data.content[a].username,userrole:t.data.content[a].role,name:t.data.content[a].name,email:t.data.content[a].email}):"ADMIN"==t.data.content[a].role&&e.tableData.push({id:t.data.content[a].id,username:t.data.content[a].username,userrole:t.data.content[a].role,name:t.data.content[a].name,email:t.data.content[a].email});for(var n=0;n<t.data.content.length;n++)"ROOT"!=t.data.content[n].role&&"ADMIN"!=t.data.content[n].role&&e.tableData.push({id:t.data.content[n].id,username:t.data.content[n].username,userrole:t.data.content[n].role,name:t.data.content[n].name,email:t.data.content[n].email});e.$message({message:"列表已更新",type:"success"})})).catch((function(t){console.log(t.response),e.$message({message:"列表刷新失败",type:"error"})}))},handleEdit:function(e){console.log(this.tableData[e]),this.$router.push({path:"/edituser",query:this.tableData[e]})},handleDelete:function(e){var t=this,a=this;this.$confirm("删除后无法更改, 是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n="http://47.102.214.37:8080/user/"+a.tableData[e].id;console.log(n),v.a.delete(n).then((function(){a.tableData.splice(e,1),a.total--,t.$message({message:"删除成功",type:"success"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},delectExtraInfo:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("此用户将被永久删除, \n是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.checkedDetail.forEach((function(a){t.tableData.forEach((function(n,s){if(a.id==n.id){console.log(a,n,s);var l="http://47.102.214.37:8080/user/"+n.id;console.log(l),v.a.delete(l).then((function(){console.log(s),e.$message({message:"删除成功",type:"success"}),t.tableData.splice(s,1),t.checkedDetail.pop(),t.total--}))}}))}))})).catch((function(){e.$message.info("已取消删除")}))},search:function(){var e=this;console.log(e.username),console.log(e.name),console.log(e.email);var t="http://47.102.214.37:8080/user/query?name==高凡&username==test-o";""!=e.username||""!=e.name||""!=e.email?(""!=e.username?(t="http://47.102.214.37:8080/user/query?username=="+e.username,""!=e.name?(t="http://47.102.214.37:8080/user/query?username=="+e.username+"&name=="+e.name,""!=e.email&&(t="http://47.102.214.37:8080/user/query?username=="+e.username+"&name=="+e.name+"&email=="+e.email)):""==e.name&&""!=e.email&&(t="http://47.102.214.37:8080/user/query?username=="+e.username+"&email=="+e.email)):""==e.username&&(""!=e.name?(t="http://47.102.214.37:8080/user/query?name=="+e.name,""!=e.email&&(t="http://47.102.214.37:8080/user/query?name=="+e.name+"&email=="+e.email)):""==e.name&&""!=e.email&&(t="http://47.102.214.37:8080/user/query?email=="+e.email)),console.log(t),v.a.get(t).then((function(t){console.log(t.data),e.tableData=[],e.total=t.data.content.length;for(var a=0;a<t.data.content.length;a++)e.tableData.unshift({id:t.data.content[a].id,username:t.data.content[a].username,userrole:t.data.content[a].role,name:t.data.content[a].name,email:t.data.content[a].email})}))):e.$message({message:"请输入搜索条件",type:"warning"})}}},g=h,b=(a("1f57"),Object(c["a"])(g,p,f,!1,null,null,null)),T=b.exports,y=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-Authorize"},[a("div",{staticClass:"box register"},[e._m(0),a("div",{staticClass:"input-body"},[["ADMIN"].includes(e.userRole)?a("span",[e._v("可以创建三种普通用户权限")]):e._e(),a("el-input",{staticClass:"userinfoinput",attrs:{placeholder:"姓名",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("el-input",{staticClass:"userinfoinput",attrs:{placeholder:"用户名",clearable:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),a("el-input",{staticClass:"userinfoinput",attrs:{placeholder:"邮箱",clearable:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("el-input",{staticClass:"userinfoinput",attrs:{type:"password","show-password":"",placeholder:"密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("el-input",{staticClass:"userinfoinput",attrs:{type:"password","show-password":"",placeholder:"确认密码"},model:{value:e.confirmpassword,callback:function(t){e.confirmpassword=t},expression:"confirmpassword"}}),a("el-select",{attrs:{placeholder:"权限选择",clearable:""},model:{value:e.value_left,callback:function(t){e.value_left=t},expression:"value_left"}},e._l(e.options_left,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1),a("el-switch",{attrs:{"active-text":"批量注册"},on:{change:e.moreswitch},model:{value:e.more,callback:function(t){e.more=t},expression:"more"}}),e.more?a("el-input",{staticClass:"userinfoinput",attrs:{type:"number",placeholder:"批量注册个数"},model:{value:e.piliang,callback:function(t){e.piliang=t},expression:"piliang"}}):e._e()],1),a("div",{staticClass:"login-btn"},[a("el-button",{on:{click:e.register}},[e._v("注册")])],1)]),a("div",{staticClass:"box"},[e._m(1),a("div",{staticClass:"select-body"},[["ROOT"].includes(e.userRole)?a("span",[e._v("只能创建一个管理员，以及三种普通用户权限")]):e._e(),["ADMIN"].includes(e.userRole)?a("span",[e._v("可以创建三种普通用户权限")]):e._e(),a("el-select",{attrs:{placeholder:"人员选择",clearable:"",filterable:"",multiple:""},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}},e._l(e.options1,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1),a("el-select",{attrs:{placeholder:"权限选择",clearable:""},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.options2,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)],1),a("div",{staticClass:"login-btn"},[a("el-button",{on:{click:e.authorize}},[e._v("确定授权")])],1)])])},k=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head"},[a("div",{staticClass:"head-text"},[e._v("注册")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head"},[a("div",{staticClass:"head-text"},[e._v("授权")])])}],x={created:function(){var e=this,t=this;v.a.get("http://47.102.214.37:8080/user/me").then((function(a){e.userRole=a.data.role,"ADMIN"==e.userRole&&t.options2.shift()})),v.a.get("http://47.102.214.37:8080/user/query?role=!ROOT").then((function(e){console.log(e.data),setTimeout((function(){for(var a=0;a<e.data.content.length;a++)"ADMIN"==e.data.content[a].role&&(t.options1[0].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}),t.options2[0].disabled=!0),"CREATOR"==e.data.content[a].role&&t.options1[1].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}),"OPERATOR"==e.data.content[a].role&&t.options1[2].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}),"SUPERVISOR"==e.data.content[a].role&&t.options1[3].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"})}),200)}))},data:function(){return{userRole:"",name:"",username:"",email:"",password:"",confirmpassword:"",options_left:[{value:"CREATOR",label:"CREATOR"},{value:"OPERATOR",label:"OPERATOR"},{value:"SUPERVISOR",label:"SUPERVISOR"}],value_left:"",options1:[{label:"ADMIN",options:[]},{label:"CREATOR",options:[]},{label:"OPERATOR",options:[]},{label:"SUPERVISOR",options:[]}],options2:[{value:"ADMIN",label:"ADMIN",disabled:!1},{value:"CREATOR",label:"CREATOR"},{value:"OPERATOR",label:"OPERATOR"},{value:"SUPERVISOR",label:"SUPERVISOR"}],value1:[],value2:"",more:!1,piliang:""}},methods:{moreswitch:function(e){this.more=e},register:function(){var e=this;if(""==e.name||""==e.username||""==e.email||""==e.password||""==e.confirmpassword||""==e.value_left)e.$message({message:"请将信息填写完整",type:"warning"});else if(e.password!=e.confirmpassword)e.$message({message:"两次密码输入不一致",type:"error"});else if(1==e.more){console.log(e.piliang);var t=0;for(t=0;t<e.piliang;t++)v.a.post("http://47.102.214.37:8080/user/register",{name:e.name,username:e.username,email:e.email,password:e.confirmpassword,role:e.value_left}).then((function(){e.name="",e.username="",e.email="",e.password="",e.confirmpassword="",e.value_left="",e.piliang=""}));t==e.piliang&&e.$message({message:"批量注册成功",type:"success"})}else v.a.post("http://47.102.214.37:8080/user/register",{name:e.name,username:e.username,email:e.email,password:e.confirmpassword,role:e.value_left}).then((function(t){console.log(t),e.$message({message:"注册成功",type:"success"}),e.name="",e.username="",e.email="",e.password="",e.confirmpassword="",e.value_left=""}))},authorize:function(){var e=this;console.log(e.value1),console.log(e.value2);for(var t=function(t){console.log(e.value1[t]);var a="http://47.102.214.37:8080/user/"+e.value1[t];v.a.get(a).then((function(t){var n={email:t.data.email,id:t.data.id,name:t.data.name,role:e.value2,username:t.data.username,enable:t.data.enable};setTimeout((function(){console.log(n),v.a.put(a,n).then((function(t){console.log(t),e.$message({message:"授权成功",type:"success"}),e.$router.push("/users")})).catch((function(t){console.log(t.response),e.$message({message:"授权失败",type:"error"})}))}),200)}))},a=0;a<e.value1.length;a++)t(a)}}},C=x,_=(a("df4d"),Object(c["a"])(C,y,k,!1,null,null,null)),I=_.exports,D=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-edituser"},[a("div",{staticClass:"Box"},[e._m(0),a("div",{staticClass:"input-body"},[a("span",[e._v("仅能修改姓名、邮箱和密码")]),a("span",[e._v("（注：不需要修改的内容可不用填写）")]),a("el-input",{attrs:{placeholder:"姓名",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("el-input",{attrs:{placeholder:"电子邮件",clearable:""},on:{change:e.Email},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("el-input",{attrs:{placeholder:"密码",clearable:"","show-password":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),""!=e.password?a("el-input",{attrs:{placeholder:"确认密码",clearable:"","show-password":""},model:{value:e.confirmpassword,callback:function(t){e.confirmpassword=t},expression:"confirmpassword"}}):e._e()],1),a("div",{staticClass:"login-btn"},[a("el-button",{on:{click:e.submit}},[e._v("保存修改")])],1)])])},w=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head"},[a("div",{staticClass:"head-text"},[e._v("修改信息")])])}],$=(a("4d63"),a("ac1f"),a("25f0"),{created:function(){var e=this;console.log(this.$route.query),e.userid=this.$route.query.id,e.name=this.$route.query.name,e.email=this.$route.query.email},data:function(){return{name:"",userid:"",email:"",password:"",confirmpassword:""}},methods:{Email:function(){var e=new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$");e.test(this.email)||(this.$message({message:"请输入正确的邮箱地址",type:"error"}),this.email="")},submit:function(){var e=this;if(console.log(e.name),console.log(e.email),console.log(e.userid),console.log(e.password),console.log(e.confirmpassword),e.password===e.confirmpassword){var t="http://47.102.214.37:8080/user/"+e.userid;v.a.get(t).then((function(a){var n={email:e.email,id:a.data.id,name:e.name,role:a.data.role,username:a.data.username,enable:a.data.enable,password:e.confirmpassword};setTimeout((function(){console.log(n),v.a.put(t,n).then((function(t){console.log(t),e.$message({message:"修改成功",type:"success"}),e.$router.push("./users")})).catch((function(t){console.log(t.response),e.$message({message:"修改失败",type:"error"})}))}),200)}))}else this.$message({message:"两次密码输入不一致，请重新输入",type:"warning"}),this.password="",this.confirmpassword=""}}}),z=$,S=(a("22b4"),Object(c["a"])(z,D,w,!1,null,null,null)),E=S.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return["ROOT","ADMIN","CREATOR"].includes(e.userRole)?a("div",{staticClass:"Main"},[a("el-breadcrumb",{staticClass:"Breadcrumb"},[a("el-breadcrumb-item",{staticClass:"left"},[e._v("设备管理")]),a("el-breadcrumb-item",{staticClass:"right"},[e._v("新增设备")])],1),a("div",{staticClass:"AddDeviceInfo"},[a("div",{staticClass:"BaseInfo"},[a("div",{staticClass:"BaseInfoText"},[e._v("基本信息")]),a("div",{staticClass:"BaseInfoTable"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:"设备名称: ","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入设备名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"设备品牌: ","label-width":e.formLabelWidth,prop:"brand"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备品牌"},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}})],1),a("el-form-item",{attrs:{label:"设备型号/规格: ","label-width":e.formLabelWidth,prop:"type"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备型号/规格"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("el-form-item",{attrs:{label:"设备编号: ","label-width":e.formLabelWidth,prop:"deviceNo"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备编号"},model:{value:e.form.deviceNo,callback:function(t){e.$set(e.form,"deviceNo",t)},expression:"form.deviceNo"}})],1),a("el-form-item",{attrs:{label:"是否为关键设备:","label-width":e.formLabelWidth,prop:"crux"}},[a("el-radio-group",{model:{value:e.form.crux,callback:function(t){e.$set(e.form,"crux",t)},expression:"form.crux"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1),a("el-form-item",{attrs:{label:"设备分类: ","label-width":e.formLabelWidth,prop:"clazz"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备分类"},model:{value:e.form.clazz,callback:function(t){e.$set(e.form,"clazz",t)},expression:"form.clazz"}})],1)],1),a("div",{staticClass:"submitbtn"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitNewDevice(e.form)}}},[e._v("保存并提交")])],1)],1)]),a("div",{staticClass:"ExtraInfo"},[a("div",{staticClass:"ExtraInfoText"},[e._v("拓展信息")]),a("div",{staticClass:"Btns"},[a("el-button",{staticClass:"AddBtn",attrs:{icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增字段")]),a("el-button",{staticClass:"DelBtn",attrs:{icon:"el-icon-delete"},on:{click:e.delectExtraInfo}},[e._v("删除字段")])],1),a("el-dialog",{staticClass:"addExtraInfoDialog",attrs:{title:"新增字段",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.ExtraInfoDialog}},[a("el-form-item",{attrs:{label:"字段名称: ","label-width":"100px"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入字段名称"},model:{value:e.ExtraInfoDialog.name,callback:function(t){e.$set(e.ExtraInfoDialog,"name",t)},expression:"ExtraInfoDialog.name"}})],1),a("el-form-item",{attrs:{label:"字段类型: ","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择字段类型"},model:{value:e.ExtraInfoDialog.type,callback:function(t){e.$set(e.ExtraInfoDialog,"type",t)},expression:"ExtraInfoDialog.type"}},[a("el-option",{attrs:{label:"String (字符串型)",value:"String"}}),a("el-option",{attrs:{label:"Date (日期型)",value:"Date"}}),a("el-option",{attrs:{label:"Integer (数字型)",value:"Integer"}}),a("el-option",{attrs:{label:"Bool (布尔型)",value:"Bool"}})],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.SubmitNewExtraInfo(e.ExtraInfoDialog)}}},[e._v("确 定")])],1)],1),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"extraname",label:"字段名"}}),a("el-table-column",{attrs:{label:"字段信息"},scopedSlots:e._u([{key:"default",fn:function(t){return["String"==t.row.type?a("el-input",{attrs:{placeholder:"请输入字段信息"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Integer"==t.row.type?a("el-input",{attrs:{type:"number",placeholder:"请输入字段信息"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Date"==t.row.type?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",size:"large","value-format":"yyyy-MM-dd"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Bool"==t.row.type?a("el-radio-group",{model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1):e._e()]}}],null,!1,3823509501)})],1),a("div",{staticClass:"ExtraInfoTable"})],1)])],1):e._e()},P=[],A=(a("caad"),{data:function(){return{userRole:"",form:{},ExtraInfoDialog:{},formLabelWidth:"150px",dialogFormVisible:!1,checkedDetail:[],tableData:[],extraid:[],extraobj:[],rules:{name:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],brand:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],type:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],deviceNo:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],crux:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],clazz:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}]}}},methods:{handleDetailSelectionChange:function(e){this.checkedDetail=e},SubmitNewExtraInfo:function(e){var t=this;console.log(e),""==e.name||void 0==e.type?this.$alert("请将基本信息填写完整！","提示",{confirmButtonText:"确定"}):v.a.post("http://47.102.214.37:8080/device/info-field",{name:e.name,type:e.type}).then((function(a){201==a.status&&(t.tableData.push({extraname:e.name,extrainfo:""}),v.a.get("http://47.102.214.37:8080/device/info-field").then((function(a){for(var n=0;n<a.data.length;n++)if(a.data[n].name==e.name){t.extraid.push(a.data[n].id);break}})),t.dialogFormVisible=!1)}))},delectExtraInfo:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("现有的设备中属于该字段的所有信息都会被删除, \n是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.checkedDetail.forEach((function(a){t.tableData.forEach((function(n,s){if(a.extraname==n.extraname){console.log(t.tableData[s]),console.log(t.extraid[s]);var l="http://47.102.214.37:8080/device/info-field/"+t.extraid[s];v.a.delete(l).then((function(a){console.log(a),200==a.status?(t.tableData.splice(s,1),e.$message({message:"删除成功",type:"success"})):e.$message.error("删除失败")}))}}))}))})).catch((function(){e.$message.info("已取消删除")}))},submitNewDevice:function(e){var t=this,a=[],n=this;if(void 0==e.name||void 0==e.brand||void 0==e.type||void 0==e.deviceNo||void 0==e.crux||void 0==e.clazz)this.$alert("请将基本信息填写完整！","提示",{confirmButtonText:"确定"});else{var s={};"Y"==e.crux?s.crux=!0:"N"==e.crux&&(s.crux=!1);for(var l=0;l<n.tableData.length;l++)a.push({field:{id:n.extraid[l]},value:n.tableData[l].extrainfo});v.a.post("http://47.102.214.37:8080/device",{name:e.name,brand:e.brand,type:e.type,deviceNo:e.deviceNo,crux:s.crux,clazz:e.clazz,extra:a}).then((function(e){"ok"==e.data.message&&t.$message({message:"添加成功",type:"success"})})).catch((function(e){console.log(e)}))}}},created:function(){var e=this;v.a.get("http://47.102.214.37:8080/user/me").then((function(t){console.log(t.data),e.userRole=t.data.role})),setTimeout((function(){["ROOT","ADMIN","CREATOR"].includes(e.userRole)&&v.a.get("http://47.102.214.37:8080/device/info-field").then((function(t){console.log(t.data);for(var a=0;a<t.data.length;a++)e.extraid.push(t.data[a].id),e.tableData.push({extraname:t.data[a].name,extrainfo:"",type:t.data[a].type})}))}),200)}}),O=A,q=(a("2c6a"),Object(c["a"])(O,R,P,!1,null,null,null)),N=q.exports,B=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Box"},[a("el-breadcrumb",{staticClass:"breadcrumb-top",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备管理")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("设备信息")])],1),a("el-main",{staticClass:"Main-Box"},[a("div",{staticClass:"head-btn"},[a("div",{staticClass:"oper-btns-left"},[a("div",{staticClass:"select"},[a("el-select",{attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.selectchange},model:{value:e.selectvalue,callback:function(t){e.selectvalue=t},expression:"selectvalue"}},e._l(e.selectoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),a("div",e._l(e.dynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1),a("div",{staticClass:"search"},[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1),a("div",{staticClass:"getall refresh"},[a("el-button",{attrs:{icon:"el-icon-document-copy"},on:{click:e.getAllDevice}},[e._v("获取全部设备 ")])],1),a("div",{staticClass:"import refresh"},[a("el-button",{attrs:{icon:"el-icon-upload2"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("导入 ")])],1),a("div",{staticClass:"export refresh"},[a("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.exportExcel}},[e._v("导出 ")])],1)]),a("div",{staticClass:"oper-btns-right"},[a("el-button",{staticClass:"bigdel-btn",attrs:{icon:"el-icon-delete"},on:{click:e.delectAll}},[e._v("批量删除")])],1),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"35%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},[a("el-upload",{ref:"upload",attrs:{drag:"",action:"http://47.102.214.37:8080/device/import",multiple:"","http-request":e.UpLoad,"auto-upload":!1,accept:".xlsx","on-preview":e.handlePreview}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v(" 将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传 xlsx 文件 ")])]),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-button",{staticStyle:{border:"0",background:"#409eff",color:"#fff","font-weight":"bold"},on:{click:e.submitUpload}},[e._v("确认上传")])],1)],1)]),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.selectmodel,callback:function(t){e.selectmodel=t},expression:"selectmodel"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitselect}},[e._v("确 定")])],1)],1)],1),a("el-table",{ref:"multipleTable",staticClass:"tablestyle",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",stripe:"",height:"460",id:"outTable"},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"44"}}),a("el-table-column",{attrs:{prop:"name",label:"设备名称",width:"150"}}),a("el-table-column",{attrs:{prop:"brand",label:"设备品牌",width:"120"}}),a("el-table-column",{attrs:{prop:"type",label:"设备型号/规格",width:"150"}}),a("el-table-column",{attrs:{prop:"deviceNo",label:"设备编号",width:"150"}}),a("el-table-column",{attrs:{prop:"crux",label:"是否为关键设备",width:"150"}}),a("el-table-column",{attrs:{prop:"clazz",label:"设备分类",width:"120"}}),e._l(e.tableHead,(function(e,t){return[a("el-table-column",{key:t,attrs:{prop:e.prop,label:e.label,width:e.width}})]})),a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("修改")]),a("el-button",{on:{click:function(a){return e.handleCode(t.$index,t.row)}}},[e._v("编码")]),a("el-button",{on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],2),a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},L=[],M=(a("c975"),a("3ca3"),a("841c"),a("ddb0"),a("2b3d"),[]),F=[],V=[],U=[],j=[],W=[],Y=[],H=[],J=[],G=[],Z={deviceselectInfo:M,devicedynamicTags:F,taskselectInfo:V,taskdynamicTags:U,fixselectInfo:j,fixdynamicTags:W,taskAnalysisInfo:Y,taskAnalysisdynamicTags:H,fixAnalysisInfo:J,fixAnalysisdynamicTags:G},K={name:"DeviceInformation",components:{},data:function(){return{selectoptions:[{label:"基本字段",options:[{value:"name",label:"设备名称"},{value:"brand",label:"设备品牌"},{value:"type",label:"设备型号/规格"},{value:"deviceNo",label:"设备编号"},{value:"crux",label:"是否为关键设备"},{value:"clazz",label:"设备分类"}]},{label:"附加字段",options:[]}],selectvalue:"",selectmodel:"",dialogSearchVisible:!1,selectInfo:[],dynamicTags:[],dialogVisible:!1,fileList:[],exporturl:"",userRole:"",checkedDetail:[],tableHead:[],tableData:[],multipleSelection:[],currentPage:1,page_size:10,page:1,total:0}},methods:{handleDetailSelectionChange:function(e){this.checkedDetail=e},selectchange:function(){this.dialogSearchVisible=!0},submitselect:function(){this.dialogSearchVisible=!1,this.selectInfo.push({ziduan:this.selectvalue,value:this.selectmodel}),this.dynamicTags.push(this.selectvalue+" / "+this.selectmodel)},handleClose:function(e){var t=this.dynamicTags.indexOf(e);console.log(t),this.dynamicTags.splice(t,1),this.selectInfo.splice(t,1)},search:function(){var e=this,t="http://47.102.214.37:8080/device/query?"+e.selectInfo[0].ziduan+"=L"+e.selectInfo[0].value+"%25",a="http://47.102.214.37:8080/device/export?"+e.selectInfo[0].ziduan+"=L"+e.selectInfo[0].value+"%25";if(1==e.selectInfo.length)e.exporturl=a,v.a.get(t).then((function(t){console.log(t.data),e.tableData=[],e.total=t.data.totalElements,e.currentPage=1;for(var a=0;a<t.data.content.length;a++){var n={};if(n.id=t.data.content[a].id,n.name=t.data.content[a].name,n["brand"]=t.data.content[a].brand,n.type=t.data.content[a].type,n.deviceNo=t.data.content[a].deviceNo,0!=t.data.content[a].extra.length)for(var s=0;s<t.data.content[a].extra.length;s++)n[t.data.content[a].extra[s].field.id]=t.data.content[a].extra[s].value;1==t.data.content[a].crux?n.crux="Y":0==t.data.content[a].crux&&(n.crux="N"),n.clazz=t.data.content[a].clazz,e.tableData.push(n)}e.$message({message:"查询成功",type:"success"}),Z.deviceselectInfo=e.selectInfo,Z.devicedynamicTags=e.dynamicTags}));else{for(var n=1;n<e.selectInfo.length;n++)t=t+"&"+e.selectInfo[n].ziduan+"=L"+e.selectInfo[n].value+"%25",a=a+"&"+e.selectInfo[n].ziduan+"=L"+e.selectInfo[n].value+"%25";e.exporturl=a,v.a.get(t).then((function(t){console.log(t.data),e.tableData=[],e.total=t.data.totalElements,e.currentPage=1;for(var a=0;a<t.data.content.length;a++){var n={};if(n.id=t.data.content[a].id,n.name=t.data.content[a].name,n["brand"]=t.data.content[a].brand,n.type=t.data.content[a].type,n.deviceNo=t.data.content[a].deviceNo,0!=t.data.content[a].extra.length)for(var s=0;s<t.data.content[a].extra.length;s++)n[t.data.content[a].extra[s].field.id]=t.data.content[a].extra[s].value;1==t.data.content[a].crux?n.crux="Y":0==t.data.content[a].crux&&(n.crux="N"),n.clazz=t.data.content[a].clazz,e.tableData.push(n)}e.$message({message:"查询成功",type:"success"}),Z.deviceselectInfo=e.selectInfo,Z.devicedynamicTags=e.dynamicTags}))}},getAllDevice:function(){var e=this,t=this,a="http://47.102.214.37:8080/device?page=0&size="+t.page_size;v()({method:"GET",url:a}).then((function(a){t.tableData=[],t.total=a.data.totalElements,t.currentPage=1;for(var n=0;n<a.data.content.length;n++){var s={};if(s.id=a.data.content[n].id,s.name=a.data.content[n].name,s["brand"]=a.data.content[n].brand,s.type=a.data.content[n].type,s.deviceNo=a.data.content[n].deviceNo,0!=a.data.content[n].extra.length)for(var l=0;l<a.data.content[n].extra.length;l++)s[a.data.content[n].extra[l].field.id]=a.data.content[n].extra[l].value;1==a.data.content[n].crux?s.crux="Y":0==a.data.content[n].crux&&(s.crux="N"),s.clazz=a.data.content[n].clazz,t.tableData.push(s)}e.$message({message:"已获取全部设备",type:"success"}),t.selectInfo=[],t.selectvalue="",t.selectmodel="",t.dynamicTags=[],Z.deviceselectInfo=[],Z.devicedynamicTags=[],t.exporturl="http://47.102.214.37:8080/device/export?name=! "})).catch((function(e){console.log(e)}))},handlePreview:function(e,t){console.log(e,t)},UpLoad:function(e){var t=this;console.log(e.file);var a=new FormData;a.append("file",e.file),console.log(a),v.a.post("http://47.102.214.37:8080/device/import",a).then((function(e){console.log(e),200==e.status&&(t.dialogVisible=!1,t.$message({message:"上传成功",type:"success"}),setTimeout((function(){t.getAllDevice()}),200))}))},submitUpload:function(){this.$refs.upload.submit()},exportExcel:function(){var e=this;console.log(e.exporturl),v.a.get(e.exporturl,{responseType:"blob"}).then((function(e){if(console.log(e),e){var t=new Blob([e.data],{type:"application/vnd.ms-excel;charset=utf-8"}),a=window.URL.createObjectURL(t),n=document.createElement("a");n.style.display="none",n.href=a,n.setAttribute("download","data.xlsx"),document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a)}}))},delectAll:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("删除后无法更改, 是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.checkedDetail.forEach((function(e){t.tableData.forEach((function(a,n){if(e.id==a.id){console.log(t.tableData[n]);var s="http://47.102.214.37:8080/device/"+t.tableData[n].id;v.a.delete(s).then((function(e){console.log(e)}))}}))})),setTimeout((function(){t.getAllDevice()}),200)})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handleEdit:function(e,t){var a=this,n={};n.id=t.id,n.name=t.name,n.brand=t.brand,n.type=t.type,n.deviceNo=t.deviceNo,n.crux=t.crux,n.clazz=t.clazz,v.a.get("http://47.102.214.37:8080/device/info-field").then((function(e){console.log(e.data);for(var s=0;s<e.data.length;s++)n[e.data[s].id]=t[e.data[s].id];a.$router.push({path:"/editDevice",query:n})}))},handleCode:function(e,t){console.log(t),this.$router.push({path:"./code",query:t})},handleDelete:function(e){var t=this,a=this;this.$confirm("删除后无法更改, 是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n="http://47.102.214.37:8080/device/"+a.tableData[e].id;v.a.delete(n).then((function(e){"ok"==e.data.message&&t.getAllDevice()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleSizeChange:function(e){var t=this,a=this;a.tableData=[],console.log(e),a.page_size=e;var n="http://47.102.214.37:8080/device?page=0&size="+a.page_size;console.log(n),v()({method:"GET",url:n}).then((function(e){a.total=e.data.totalElements,a.currentPage=1;for(var n=0;n<e.data.content.length;n++){var s={};if(s.id=e.data.content[n].id,s.name=e.data.content[n].name,s["brand"]=e.data.content[n].brand,s.type=e.data.content[n].type,s.deviceNo=e.data.content[n].deviceNo,0!=e.data.content[n].extra.length)for(var l=0;l<e.data.content[n].extra.length;l++)s[e.data.content[n].extra[l].field.id]=e.data.content[n].extra[l].value;1==e.data.content[n].crux?s.crux="Y":0==e.data.content[n].crux&&(s.crux="N"),s.clazz=e.data.content[n].clazz,a.tableData.push(s)}t.$message({message:"已获取全部设备",type:"success"}),a.selectInfo=[],a.selectvalue="",a.selectmodel="",a.dynamicTags=[],Z.deviceselectInfo=[],Z.devicedynamicTags=[],a.exporturl="http://47.102.214.37:8080/device/export?name=! "})).catch((function(e){console.log(e)}))},handleCurrentChange:function(e){var t=this,a=this;a.page=e,a.currentPage=e,console.log(e);var n="http://47.102.214.37:8080/device?page="+(a.page-1)+"&size="+a.page_size;console.log(n),v()({method:"GET",url:n}).then((function(e){a.tableData=[],a.total=e.data.totalElements;for(var n=0;n<e.data.content.length;n++){var s={};if(s.id=e.data.content[n].id,s.name=e.data.content[n].name,s["brand"]=e.data.content[n].brand,s.type=e.data.content[n].type,s.deviceNo=e.data.content[n].deviceNo,0!=e.data.content[n].extra.length)for(var l=0;l<e.data.content[n].extra.length;l++)s[e.data.content[n].extra[l].field.id]=e.data.content[n].extra[l].value;1==e.data.content[n].crux?s.crux="Y":0==e.data.content[n].crux&&(s.crux="N"),s.clazz=e.data.content[n].clazz,a.tableData.push(s)}t.$message({message:"已获取全部设备",type:"success"}),a.selectInfo=[],a.selectvalue="",a.selectmodel="",a.dynamicTags=[],Z.deviceselectInfo=[],Z.devicedynamicTags=[],a.exporturl="http://47.102.214.37:8080/device/export?name=! "})).catch((function(e){console.log(e)}))}},created:function(){var e=this;v.a.get("http://47.102.214.37:8080/user/me").then((function(t){e.userRole=t.data.role})),0!=Z.deviceselectInfo.length?(console.log(Z.deviceselectInfo),e.selectInfo=Z.deviceselectInfo,e.dynamicTags=Z.devicedynamicTags,e.search()):setTimeout((function(){v.a.get("http://47.102.214.37:8080/device/info-field").then((function(t){for(var a=0;a<t.data.length;a++){var n={};n.label=t.data[a].name,n.width="130",n.prop=t.data[a].id,e.tableHead.push(n)}for(var s=0;s<t.data.length;s++)e.selectoptions[1].options.push({value:t.data[s].id,label:t.data[s].name})})),e.getAllDevice()}),200)}},Q=K,X=(a("c000"),a("ca32"),Object(c["a"])(Q,B,L,!1,null,"b457fb08",null)),ee=X.exports,te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Main"},[a("el-breadcrumb",{staticClass:"BreadCrumb"},[a("el-breadcrumb-item",{staticClass:"left"},[e._v("设备管理")]),a("el-breadcrumb-item",{staticClass:"right"},[e._v("编辑设备")])],1),a("div",{staticClass:"AddDeviceInfo"},[a("div",{staticClass:"BaseInfo"},[a("div",{staticClass:"BaseInfoText"},[e._v("基本信息")]),a("div",{staticClass:"BaseInfoTable"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:"设备名称: ","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入设备名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"设备品牌: ","label-width":e.formLabelWidth,prop:"brand"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备品牌"},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}})],1),a("el-form-item",{attrs:{label:"设备型号/规格: ","label-width":e.formLabelWidth,prop:"type"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备型号/规格"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("el-form-item",{attrs:{label:"设备编号: ","label-width":e.formLabelWidth,prop:"deviceNo"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备编号"},model:{value:e.form.deviceNo,callback:function(t){e.$set(e.form,"deviceNo",t)},expression:"form.deviceNo"}})],1),a("el-form-item",{attrs:{label:"是否为关键设备:","label-width":e.formLabelWidth,prop:"crux"}},[a("el-radio-group",{model:{value:e.form.crux,callback:function(t){e.$set(e.form,"crux",t)},expression:"form.crux"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1),a("el-form-item",{attrs:{label:"设备分类: ","label-width":e.formLabelWidth,prop:"clazz"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备分类"},model:{value:e.form.clazz,callback:function(t){e.$set(e.form,"clazz",t)},expression:"form.clazz"}})],1)],1),a("div",{staticClass:"submitbtn"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitEditDevice(e.form)}}},[e._v("确认修改")])],1)],1)]),a("div",{staticClass:"ExtraInfo"},[a("div",{staticClass:"ExtraInfoText"},[e._v("拓展信息")]),a("div",{staticClass:"Btns"},[a("el-button",{staticClass:"AddBtn",attrs:{icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增字段")]),a("el-button",{staticClass:"DelBtn",attrs:{icon:"el-icon-delete"},on:{click:e.delectExtraInfo}},[e._v("删除字段")])],1),a("el-dialog",{staticClass:"addExtraInfoDialog",attrs:{title:"新增字段",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.ExtraInfoDialog}},[a("el-form-item",{attrs:{label:"字段名称: ","label-width":"100px"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入字段名称"},model:{value:e.ExtraInfoDialog.name,callback:function(t){e.$set(e.ExtraInfoDialog,"name",t)},expression:"ExtraInfoDialog.name"}})],1),a("el-form-item",{attrs:{label:"字段类型: ","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择字段类型"},model:{value:e.ExtraInfoDialog.type,callback:function(t){e.$set(e.ExtraInfoDialog,"type",t)},expression:"ExtraInfoDialog.type"}},[a("el-option",{attrs:{label:"String (字符串型)",value:"String"}}),a("el-option",{attrs:{label:"Date (日期型)",value:"Date"}}),a("el-option",{attrs:{label:"Integer (数字型)",value:"Integer"}}),a("el-option",{attrs:{label:"Bool (布尔型)",value:"Bool"}})],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.SubmitNewExtraInfo(e.ExtraInfoDialog)}}},[e._v("确 定")])],1)],1),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"extraname",label:"字段名"}}),a("el-table-column",{attrs:{label:"字段信息"},scopedSlots:e._u([{key:"default",fn:function(t){return["String"==t.row.type?a("el-input",{attrs:{placeholder:"请输入字段信息"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Integer"==t.row.type?a("el-input",{attrs:{type:"number",placeholder:"请输入字段信息"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Date"==t.row.type?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",size:"large","value-format":"yyyy-MM-dd"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Bool"==t.row.type?a("el-radio-group",{model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1):e._e()]}}])})],1),a("div",{staticClass:"ExtraInfoTable"})],1)])],1)},ae=[],ne={data:function(){return{form:{name:"",brand:"",type:"",deviceNo:"",crux:"",clazz:""},formLabelWidth:"150px",dialogFormVisible:!1,ExtraInfoDialog:{},tableData:[],extraid:[],checkedDetail:[],rules:{name:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],brand:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],type:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],deviceNo:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],crux:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],clazz:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}]}}},methods:{handleDetailSelectionChange:function(e){this.checkedDetail=e},SubmitNewExtraInfo:function(e){var t=this;v.a.post("http://47.102.214.37:8080/device/info-field",{name:e.name,type:e.type}).then((function(a){201==a.status&&(t.tableData.push({extraname:e.name,extrainfo:""}),v.a.get("http://47.102.214.37:8080/device/info-field").then((function(a){for(var n=0;n<a.data.length;n++)if(a.data[n].name==e.name){t.extraid.push(a.data[n].id);break}})),t.dialogFormVisible=!1)}))},delectExtraInfo:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("删除后无法更改, 是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){console.log(t.checkedDetail),t.checkedDetail.forEach((function(a){t.tableData.forEach((function(n,s){if(console.log(a,n),a.extraname==n.extraname){console.log(t.tableData[s]);var l="http://47.102.214.37:8080/device/info-field/"+t.extraid[s];v.a.delete(l).then((function(a){console.log(a),200==a.status?(t.tableData.splice(s,1),e.$message({message:"删除成功",type:"success"})):e.$message.error("删除失败")}))}}))}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},submitEditDevice:function(e){var t=this,a=this;if(console.log(e),void 0==e.name||void 0==e.brand||void 0==e.type||void 0==e.deviceNo||void 0==e.crux||void 0==e.clazz)this.$alert("请将基本信息填写完整！","提示",{confirmButtonText:"确定"});else{var n={};"Y"==e.crux?n.crux=!0:"N"==e.crux&&(n.crux=!1);for(var s=[],l=0;l<a.tableData.length;l++)s.push({field:{id:a.extraid[l]},value:a.tableData[l].extrainfo});v.a.put("http://47.102.214.37:8080/device",{id:this.$route.query.id,name:e.name,brand:e.brand,type:e.type,deviceNo:e.deviceNo,crux:n.crux,clazz:e.clazz,extra:s}).then((function(e){console.log(e),200==e.status&&(t.$message({message:"修改成功",type:"success"}),t.$router.push("/deviceInformation"))})).catch((function(e){console.log(e)}))}}},created:function(){var e=this;console.log(this.$route.query);var t=this;t.form.name=this.$route.query.name,t.form.brand=this.$route.query.brand,t.form.type=this.$route.query.type,t.form.deviceNo=this.$route.query.deviceNo,t.form.crux=this.$route.query.crux,t.form.clazz=this.$route.query.clazz,v.a.get("http://47.102.214.37:8080/device/info-field").then((function(a){console.log(a.data);for(var n=0;n<a.data.length;n++)t.extraid.push(a.data[n].id),t.tableData.push({extraname:a.data[n].name,extrainfo:e.$route.query[a.data[n].id],type:a.data[n].type})}))}},se=ne,le=(a("7ef6"),Object(c["a"])(se,te,ae,!1,null,null,null)),oe=le.exports,ie=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("el-breadcrumb",{staticClass:"breadcrumb-top",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备管理")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("生成编码")])],1),void 0!=e.url?a("div",{staticClass:"codeimage"},[a("img",{attrs:{src:e.url}})]):e._e(),a("div",{staticClass:"download"},[a("el-button",{on:{click:e.Download}},[e._v("下载到本地")])],1)],1)},ce=[],re={data:function(){return{url:void 0}},methods:{downloadIamge:function(e,t){var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height;var n=e.getContext("2d");n.drawImage(a,0,0,a.width,a.height);var s=e.toDataURL("image/png"),l=document.createElement("a"),o=new MouseEvent("click");l.download=t||"photo",l.href=s,l.dispatchEvent(o)},a.src=e},Download:function(){this.downloadIamge(this.url,"image")}},created:function(){console.log(this.$route.query),this.url="http://47.102.214.37:8080/device/barcode/"+this.$route.query.id}},de=re,ue=(a("2779"),Object(c["a"])(de,ie,ce,!1,null,null,null)),pe=ue.exports,fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-AddTask"},[a("el-breadcrumb",{staticClass:"breadcrumb-top",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("新增标准")])],1),a("div",{staticClass:"head-btn"},[a("div",{staticClass:"oper-btns-left"},[a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.addNewTask}},[e._v("新增标准 ")]),a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1)]),["ROOT","ADMIN"].includes(e.userRole)?a("div",{staticClass:"oper-btns-right"},[a("el-button",{staticClass:"bigdel-btn",attrs:{icon:"el-icon-delete"},on:{click:e.delectExtraInfo}},[e._v("批量删除")])],1):e._e()]),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskData,stripe:"",border:""},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"name",label:"标准名称"}}),a("el-table-column",{attrs:{prop:"no",label:"标准编号"}}),["ROOT","ADMIN"].includes(e.userRole)?a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"280"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.showInfo(t.$index)}}},[e._v("以此为模版新增")]),a("el-button",{on:{click:function(a){return e.editTask(t.$index)}}},[e._v("修改")]),a("el-button",{on:{click:function(a){return e.deleteTask(t.$index)}}},[e._v("删除")])]}}],null,!1,3730732489)}):e._e()],1)],1)},me=[],ve={created:function(){var e=this;v.a.get("http://47.102.214.37:8080/user/me").then((function(t){e.userRole=t.data.role})),setTimeout((function(){e.refresh()}),300)},data:function(){return{userRole:"",dialogVisible:!1,devicename:"",deviceclazz:"",taskData:[],checkedDetail:[]}},methods:{addNewTask:function(){this.$router.push({path:"/addTaskInside"})},showInfo:function(e){console.log(e),this.$router.push({path:"/addTaskInside",query:this.taskData[e]})},editTask:function(e){this.$router.push({path:"/alterTaskcontent",query:this.taskData[e]})},handleDetailSelectionChange:function(e){this.checkedDetail=e},handleDelete:function(e){var t=this,a=this;a.$confirm("这个是模版，所有继承它的维护任务也会被删除, \n是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n="http://47.102.214.37:8080/ops/schedule/"+a.taskData[e].taskID;v.a.delete(n).then((function(n){200==n.status&&(a.taskData.splice(e,1),t.$message({message:"删除成功",type:"success"}))}))})).catch((function(){a.$message.info("已取消删除")}))},delectExtraInfo:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("这个是模版，所有继承它的维护任务也会被删除, \n是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.checkedDetail.forEach((function(a){t.taskData.forEach((function(n,s){if(a.taskID==n.taskID){console.log(s);var l="http://47.102.214.37:8080/ops/schedule/"+n.taskID;console.log(l),v.a.delete(l).then((function(){t.taskData.splice(s,1),e.$message({message:"删除成功",type:"success"}),t.tableData.splice(s,1),t.checkedDetail.pop()}))}}))}))})).catch((function(){e.$message.info("已取消删除")}))},deleteTask:function(e){var t=this,a=this;a.$confirm("这个是模版，所有继承它的维护任务也会被删除, \n是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n="http://47.102.214.37:8080/ops/schedule/"+a.taskData[e].taskID;v.a.delete(n).then((function(n){200==n.status&&(a.taskData.splice(e,1),t.$message({message:"删除成功",type:"success"}))}))})).catch((function(){a.$message.info("已取消删除")}))},refresh:function(){var e=this;e.taskData=[],v.a.get("http://47.102.214.37:8080/ops/schedule?page=0&size=100").then((function(t){console.log(t.data);for(var a=0;a<t.data.content.length;a++)e.taskData.push({taskID:t.data.content[a].id,name:t.data.content[a].name,no:t.data.content[a].no});e.$message({message:"刷新成功",type:"success"})}))}}},he=ve,ge=(a("a86b"),Object(c["a"])(he,fe,me,!1,null,null,null)),be=ge.exports,Te=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-AddTaskInside"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("新增标准")])],1),a("div",{staticClass:"Task-container"},[a("div",{staticClass:"Task-box"},[a("el-form",{ref:"form",attrs:{model:e.TaskInfo,"label-position":"left"}},[a("div",{staticClass:"part"},[a("div",{staticClass:"part_left"},[a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task",attrs:{label:"标准名称"}},[a("el-input",{attrs:{placeholder:"请输入标准名称"},model:{value:e.TaskInfo.name,callback:function(t){e.$set(e.TaskInfo,"name",t)},expression:"TaskInfo.name"}})],1),a("el-form-item",{staticClass:"task",attrs:{label:"标准编号"}},[a("el-input",{attrs:{placeholder:"请输入标准编号"},model:{value:e.TaskInfo.no,callback:function(t){e.$set(e.TaskInfo,"no",t)},expression:"TaskInfo.no"}})],1)],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task tasktime",attrs:{label:"保养周期"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择保养周期"},model:{value:e.TaskInfo.scheduleType,callback:function(t){e.$set(e.TaskInfo,"scheduleType",t)},expression:"TaskInfo.scheduleType"}},e._l(e.tasktime,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task tools",attrs:{label:"保养工具及备件"}},[a("el-input",{staticClass:"inputStyle",attrs:{type:"textarea",rows:8},model:{value:e.TaskInfo.tools,callback:function(t){e.$set(e.TaskInfo,"tools",t)},expression:"TaskInfo.tools"}})],1),a("el-form-item",{staticClass:"task remark",attrs:{label:"注意事项"}},[a("el-input",{staticClass:"inputStyle",attrs:{type:"textarea",rows:8},model:{value:e.TaskInfo.remark,callback:function(t){e.$set(e.TaskInfo,"remark",t)},expression:"TaskInfo.remark"}})],1)],1)]),a("div",{staticClass:"part_right"},[a("el-form-item",{attrs:{label:"保养内容"}},[a("i",{staticClass:"el-icon-circle-plus-outline addicon",on:{click:function(t){e.addcontent=!0}}}),a("div",{staticStyle:{"margin-top":"0px"}},e._l(e.TaskInfo.content,(function(t,n){return a("el-collapse",{key:n,on:{change:e.handleChange}},[a("el-collapse-item",{attrs:{title:t.title,name:n}},[a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(t.detail)}})])])],1)})),1)])],1)]),a("div",{staticClass:"Btns"},[a("div",{staticClass:"sub-btn"},[a("el-button",{on:{click:e.submittask}},[e._v("保存并提交")])],1),a("div",{staticClass:"cancel-btn"},[a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)])])],1)]),a("el-dialog",{attrs:{title:"新增保养内容",visible:e.addcontent,width:"670px"},on:{"update:visible":function(t){e.addcontent=t}}},[a("el-form",{attrs:{model:e.TaskInfo}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.TaskInfo.title,callback:function(t){e.$set(e.TaskInfo,"title",t)},expression:"TaskInfo.title"}})],1)],1),a("div",[e._v(" 内容"),a("br"),a("quill-editor",{ref:"myTextEditor",staticStyle:{height:"180px","margin-top":"5px"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.TaskInfo.detail,callback:function(t){e.$set(e.TaskInfo,"detail",t)},expression:"TaskInfo.detail"}})],1),a("div",{staticStyle:{"margin-top":"40px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addcontent=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitcontent}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"修改保养内容",visible:e.fixcontent,width:"670px"},on:{"update:visible":function(t){e.fixcontent=t}}},[a("el-form",{attrs:{model:e.TaskInfo}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.TaskInfo.title,callback:function(t){e.$set(e.TaskInfo,"title",t)},expression:"TaskInfo.title"}})],1)],1),a("div",[e._v(" 内容"),a("br"),a("quill-editor",{ref:"myTextEditor",staticStyle:{height:"180px","margin-top":"5px"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.TaskInfo.detail,callback:function(t){e.$set(e.TaskInfo,"detail",t)},expression:"TaskInfo.detail"}})],1),a("div",{staticStyle:{"margin-top":"40px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.fixcontent=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitfix}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"功能选择",visible:e.confirmfunction,width:"350px",center:""},on:{"update:visible":function(t){e.confirmfunction=t}}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.confirmfunction=!1}}},[e._v("仅查看")]),a("el-button",{attrs:{type:"warning"},on:{click:e.editcontent}},[e._v("修改内容")]),a("el-button",{attrs:{type:"danger"},on:{click:e.deletecontent}},[e._v("删除内容")])],1)],1)},ye=[],ke=a("953d"),xe=(a("a753"),a("8096"),a("14e1"),{name:"AddTaskInside",components:{quillEditor:ke["quillEditor"]},created:function(){var e=this;if(void 0!=this.$route.query.taskID){console.log(this.$route.query);var t="http://47.102.214.37:8080/ops/schedule/detail/"+this.$route.query.taskID;v.a.get(t).then((function(t){console.log(t.data),e.TaskInfo.scheduleType=t.data.scheduleType,e.TaskInfo.name=t.data.name,e.TaskInfo.no=t.data.no,e.TaskInfo.tools=t.data.tools,e.TaskInfo.remark=t.data.remark,e.TaskInfo.content=t.data.content}))}else console.log("bbb")},data:function(){return{TaskInfo:{scheduleType:"",name:"",no:"",tools:"",remark:"",title:"",detail:"",content:[]},tasktime:[{value:"Predictability",label:"未知"},{value:"Yearly",label:"每年"},{value:"Seasonally",label:"每季度"},{value:"Monthly",label:"每月"},{value:"Weekly",label:"每周"},{value:"Daily",label:"每天"}],addcontent:!1,fixcontent:!1,confirmfunction:!1,contentindex:-1,editorOption:{placeholder:"请输入保养内容"}}},methods:{handleChange:function(e){console.log(this.TaskInfo.content[e]),void 0!=this.TaskInfo.content[e]&&(this.confirmfunction=!0),this.contentindex=e},onEditorChange:function(e){var t=e.html;console.log(t),this.TaskInfo.detail=t},editcontent:function(){console.log(this.TaskInfo.content[this.contentindex]),this.TaskInfo.title=this.TaskInfo.content[this.contentindex].title,this.TaskInfo.detail=this.TaskInfo.content[this.contentindex].detail,this.fixcontent=!0},submitfix:function(){this.TaskInfo.content.splice(this.contentindex,1,{title:this.TaskInfo.title,detail:this.TaskInfo.detail}),this.fixcontent=!1,this.confirmfunction=!1,this.$message({message:"修改成功",type:"success"})},deletecontent:function(){var e=this;console.log(this.TaskInfo.content[this.contentindex]),this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.TaskInfo.content.splice(e.contentindex,1),e.confirmfunction=!1})).catch((function(){e.$message.info("已取消删除")}))},submitcontent:function(){this.addcontent=!1,this.TaskInfo.content.push({title:this.TaskInfo.title,detail:this.TaskInfo.detail}),console.log(this.TaskInfo)},submittask:function(){var e=this,t={};""==e.TaskInfo.scheduleType||""==e.TaskInfo.name||""==e.TaskInfo.no||""==e.TaskInfo.tools||""==e.TaskInfo.remark||0==e.TaskInfo.content.length?e.$message({message:"请将信息填写完整",type:"warning"}):(t.scheduleType=e.TaskInfo.scheduleType,t.name=e.TaskInfo.name,t.no=e.TaskInfo.no,t.tools=e.TaskInfo.tools,t.remark=e.TaskInfo.remark,t.content=e.TaskInfo.content,v.a.post("http://47.102.214.37:8080/ops/schedule",t).then((function(t){console.log(t),e.$message({message:"新增成功",type:"success"})})).catch((function(e){console.log(e.response.data.message)}))),console.log(t)},cancel:function(){this.$router.push({path:"/addTask"})}}}),Ce=xe,_e=(a("d590"),Object(c["a"])(Ce,Te,ye,!1,null,null,null)),Ie=_e.exports,De=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-EditTask"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("编辑标准")])],1),a("div",{staticClass:"Task-container"},[a("div",{staticClass:"Task-box"},[a("el-form",{ref:"form",attrs:{model:e.TaskInfo,"label-position":"left"}},[a("div",{staticClass:"part"},[a("div",{staticClass:"part_left"},[a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task",attrs:{label:"任务名称"}},[a("el-input",{attrs:{placeholder:"请输入任务名称"},model:{value:e.TaskInfo.name,callback:function(t){e.$set(e.TaskInfo,"name",t)},expression:"TaskInfo.name"}})],1)],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task",attrs:{label:"保养周期"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择保养周期"},model:{value:e.TaskInfo.scheduleType,callback:function(t){e.$set(e.TaskInfo,"scheduleType",t)},expression:"TaskInfo.scheduleType"}},e._l(e.tasktime,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task",attrs:{label:"开始时间"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.TaskInfo.startDate,callback:function(t){e.$set(e.TaskInfo,"startDate",t)},expression:"TaskInfo.startDate"}})],1)],1)]),a("div",{staticClass:"part_right"},[a("el-form-item",{staticClass:"task",attrs:{label:"设备选择"}},[a("el-select",{attrs:{clearable:"",filterable:"",multiple:"","collapse-tags":"",placeholder:"请选择设备"},model:{value:e.TaskInfo.device,callback:function(t){e.$set(e.TaskInfo,"device",t)},expression:"TaskInfo.device"}},e._l(e.Devices,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{staticClass:"task",attrs:{label:"人员选择"}},[a("el-select",{attrs:{clearable:"",filterable:"",multiple:"","collapse-tags":"",placeholder:"请选择保养人员"},model:{value:e.TaskInfo.ops,callback:function(t){e.$set(e.TaskInfo,"ops",t)},expression:"TaskInfo.ops"}},e._l(e.OpUsers,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)]),a("div",{staticClass:"Btns"},[a("div",{staticClass:"sub-btn"},[a("el-button",{on:{click:e.submittask}},[e._v("保存并提交")])],1),a("div",{staticClass:"cancel-btn"},[a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)])])],1)])],1)},we=[],$e={components:{},created:function(){var e=this;if(console.log(this.$route.query),void 0!=this.$route.query.taskID){var t="http://47.102.214.37:8080/ops/schedule/detail/"+this.$route.query.taskID;v.a.get(t).then((function(t){console.log(t.data),e.TaskInfo.scheduleType=t.data.scheduleType,e.TaskInfo.name=t.data.name,e.TaskInfo.startDate=t.data.startDate;for(var a=0;a<t.data.device.length;a++)e.TaskInfo.device.push(t.data.device[a].id);for(var n=0;n<t.data.device.length;n++)e.TaskInfo.ops.push(t.data.ops[n].id)}))}else console.log("bbb");setTimeout((function(){v.a.get("http://47.102.214.37:8080/device/query?name=!").then((function(t){for(var a=0;a<t.data.content.length;a++){var n={};n.value=t.data.content[a].id,n.label=t.data.content[a].name+"（"+t.data.content[a].deviceNo+"）",e.Devices.push(n)}})),v.a.get("http://47.102.214.37:8080/user/query?role==OPERATOR").then((function(t){for(var a=0;a<t.data.content.length;a++){var n={};n.value=t.data.content[a].id,n.label=t.data.content[a].username,e.OpUsers.push(n)}}))}),300)},data:function(){return{TaskInfo:{scheduleType:"",name:"",startDate:"",device:[],ops:[]},collapseinfo:[],tasktime:[{value:"Predictability",label:"未知"},{value:"Yearly",label:"每年"},{value:"Seasonally",label:"每季度"},{value:"Monthly",label:"每月"},{value:"Weekly",label:"每周"},{value:"Daily",label:"每天"}],Devices:[],OpUsers:[]}},methods:{deletecontent:function(){var e=this;console.log(this.TaskInfo.content[this.contentindex]),this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.TaskInfo.content.splice(e.contentindex,1),e.confirmfunction=!1})).catch((function(){e.$message.info("已取消删除")}))},submittask:function(){var e=this;if(console.log(e.TaskInfo),""==e.TaskInfo.scheduleType||""==e.TaskInfo.name||""==e.TaskInfo.startDate||0==e.TaskInfo.device.length||0==e.TaskInfo.ops.length)e.$message({message:"请将信息填写完整",type:"warning"});else{for(var t=[],a=[],n=0;n<e.TaskInfo.ops.length;n++)t.push({id:e.TaskInfo.ops[n]});for(var s=0;s<e.TaskInfo.device.length;s++)a.push({id:e.TaskInfo.device[s]});var l="http://47.102.214.37:8080/ops/schedule/detail/"+e.$route.query.taskID;v.a.get(l).then((function(n){console.log(n.data);var s={};s.acceptedStandard=n.data.acceptedStandard,s.content=n.data.content,s.id=n.data.id,s.name=e.TaskInfo.name,s.remark=n.data.remark,s.startDate=e.TaskInfo.startDate,s.scheduleType=e.TaskInfo.scheduleType,s.side=n.data.side,s.tools=n.data.tools,s.device=a,s.ops=t,console.log(s),setTimeout((function(){v.a.put(l,s).then((function(t){console.log(t),e.$message({message:"编辑成功",type:"success"})}))}),200)}))}},cancel:function(){this.$router.push({path:"/addTask"})}}},ze=$e,Se=(a("2f03"),Object(c["a"])(ze,De,we,!1,null,null,null)),Ee=Se.exports,Re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-AddTaskContent"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("修改标准")])],1),a("div",{staticClass:"Task-container"},[a("div",{staticClass:"Task-box"},[a("el-form",{ref:"form",attrs:{model:e.TaskInfo,"label-position":"left"}},[a("div",{staticClass:"part"},[a("div",{staticClass:"part_left"},[a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task",attrs:{label:"标准名称"}},[a("el-input",{attrs:{placeholder:"请输入标准名称"},model:{value:e.TaskInfo.name,callback:function(t){e.$set(e.TaskInfo,"name",t)},expression:"TaskInfo.name"}})],1),a("el-form-item",{staticClass:"task",attrs:{label:"标准编号"}},[a("el-input",{attrs:{placeholder:"请输入标准编号"},model:{value:e.TaskInfo.no,callback:function(t){e.$set(e.TaskInfo,"no",t)},expression:"TaskInfo.no"}})],1)],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task",attrs:{label:"保养周期"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择保养周期"},model:{value:e.TaskInfo.scheduleType,callback:function(t){e.$set(e.TaskInfo,"scheduleType",t)},expression:"TaskInfo.scheduleType"}},e._l(e.tasktime,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task tools",attrs:{label:"保养工具及备件"}},[a("el-input",{staticClass:"inputStyle",attrs:{type:"textarea",rows:8},model:{value:e.TaskInfo.tools,callback:function(t){e.$set(e.TaskInfo,"tools",t)},expression:"TaskInfo.tools"}})],1),a("el-form-item",{staticClass:"task remark",attrs:{label:"注意事项"}},[a("el-input",{staticClass:"inputStyle",attrs:{type:"textarea",rows:8},model:{value:e.TaskInfo.remark,callback:function(t){e.$set(e.TaskInfo,"remark",t)},expression:"TaskInfo.remark"}})],1)],1)]),a("div",{staticClass:"part_right"},[a("el-form-item",{attrs:{label:"保养内容"}},[a("i",{staticClass:"el-icon-circle-plus-outline addicon",on:{click:function(t){e.addcontent=!0}}}),a("div",{staticStyle:{"margin-top":"0px"}},e._l(e.TaskInfo.content,(function(t,n){return a("el-collapse",{key:n,on:{change:e.handleChange}},[a("el-collapse-item",{attrs:{title:t.title,name:n}},[a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(t.detail)}})])])],1)})),1)])],1)]),a("div",{staticClass:"Btns"},[a("div",{staticClass:"sub-btn"},[a("el-button",{on:{click:e.submittask}},[e._v("保存并提交")])],1),a("div",{staticClass:"cancel-btn"},[a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)])])],1)]),a("el-dialog",{attrs:{title:"新增保养内容",visible:e.addcontent,width:"670px"},on:{"update:visible":function(t){e.addcontent=t}}},[a("el-form",{attrs:{model:e.TaskInfo}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.TaskInfo.title,callback:function(t){e.$set(e.TaskInfo,"title",t)},expression:"TaskInfo.title"}})],1)],1),a("div",[e._v(" 内容"),a("br"),a("quill-editor",{ref:"myTextEditor",staticStyle:{height:"180px","margin-top":"5px"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.TaskInfo.detail,callback:function(t){e.$set(e.TaskInfo,"detail",t)},expression:"TaskInfo.detail"}})],1),a("div",{staticStyle:{"margin-top":"40px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addcontent=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitcontent}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"修改保养内容",visible:e.fixcontent,width:"670px"},on:{"update:visible":function(t){e.fixcontent=t}}},[a("el-form",{attrs:{model:e.TaskInfo}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.TaskInfo.title,callback:function(t){e.$set(e.TaskInfo,"title",t)},expression:"TaskInfo.title"}})],1)],1),a("div",[e._v(" 内容"),a("br"),a("quill-editor",{ref:"myTextEditor",staticStyle:{height:"180px","margin-top":"5px"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.TaskInfo.detail,callback:function(t){e.$set(e.TaskInfo,"detail",t)},expression:"TaskInfo.detail"}})],1),a("div",{staticStyle:{"margin-top":"40px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.fixcontent=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitfix}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"功能选择",visible:e.confirmfunction,width:"350px",center:""},on:{"update:visible":function(t){e.confirmfunction=t}}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.confirmfunction=!1}}},[e._v("仅查看")]),a("el-button",{attrs:{type:"warning"},on:{click:e.editcontent}},[e._v("修改内容")]),a("el-button",{attrs:{type:"danger"},on:{click:e.deletecontent}},[e._v("删除内容")])],1)],1)},Pe=[],Ae={name:"AddTaskInside",components:{quillEditor:ke["quillEditor"]},created:function(){var e=this;if(void 0!=this.$route.query.taskID){console.log(this.$route.query);var t="http://47.102.214.37:8080/ops/schedule/detail/"+this.$route.query.taskID;v.a.get(t).then((function(t){console.log(t.data),e.TaskInfo.scheduleType=t.data.scheduleType,e.TaskInfo.name=t.data.name,e.TaskInfo.no=t.data.no,e.TaskInfo.tools=t.data.tools,e.TaskInfo.remark=t.data.remark,e.TaskInfo.content=t.data.content}))}else console.log("bbb")},data:function(){return{TaskInfo:{scheduleType:"",name:"",no:"",tools:"",remark:"",title:"",detail:"",content:[]},tasktime:[{value:"Predictability",label:"未知"},{value:"Yearly",label:"每年"},{value:"Seasonally",label:"每季度"},{value:"Monthly",label:"每月"},{value:"Weekly",label:"每周"},{value:"Daily",label:"每天"}],addcontent:!1,fixcontent:!1,confirmfunction:!1,contentindex:-1,editorOption:{placeholder:"请输入保养内容"}}},methods:{handleChange:function(e){console.log(this.TaskInfo.content[e]),void 0!=this.TaskInfo.content[e]&&(this.confirmfunction=!0),this.contentindex=e},onEditorChange:function(e){var t=e.html;console.log(t),this.TaskInfo.detail=t},editcontent:function(){console.log(this.TaskInfo.content[this.contentindex]),this.TaskInfo.title=this.TaskInfo.content[this.contentindex].title,this.TaskInfo.detail=this.TaskInfo.content[this.contentindex].detail,this.fixcontent=!0},submitfix:function(){this.TaskInfo.content.splice(this.contentindex,1,{title:this.TaskInfo.title,detail:this.TaskInfo.detail}),this.fixcontent=!1,this.confirmfunction=!1,this.$message({message:"修改成功",type:"success"})},deletecontent:function(){var e=this;console.log(this.TaskInfo.content[this.contentindex]),this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.TaskInfo.content.splice(e.contentindex,1),e.confirmfunction=!1})).catch((function(){e.$message.info("已取消删除")}))},submitcontent:function(){this.addcontent=!1,this.TaskInfo.content.push({title:this.TaskInfo.title,detail:this.TaskInfo.detail}),console.log(this.TaskInfo)},submittask:function(){var e=this;if(""==e.TaskInfo.scheduleType||""==e.TaskInfo.name||""==e.TaskInfo.no||""==e.TaskInfo.tools||""==e.TaskInfo.remark||0==e.TaskInfo.content.length)e.$message({message:"请将信息填写完整",type:"warning"});else{var t="http://47.102.214.37:8080/ops/schedule/detail/"+e.$route.query.taskID;v.a.get(t).then((function(a){var n={};n.content=e.TaskInfo.content,n.id=a.data.id,n.name=e.TaskInfo.name,n.remark=e.TaskInfo.remark,n.startDate=e.TaskInfo.startDate,n.scheduleType=e.TaskInfo.scheduleType,n.no=e.TaskInfo.no,n.tools=e.TaskInfo.tools,n.device=a.data.device,n.ops=a.data.ops,v.a.put(t,n).then((function(t){console.log(t),e.$message({message:"修改成功",type:"success"})})).catch((function(e){console.log(e.response.data.message)}))}))}},cancel:function(){this.$router.push({path:"/addTask"})}}},Oe=Ae,qe=(a("cb334"),Object(c["a"])(Oe,Re,Pe,!1,null,null,null)),Ne=qe.exports,Be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-TaskDetailInfo"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("任务名称："+e._s(e.name)+" ")])],1),a("div",{staticClass:"Tabs"},[a("el-tabs",{attrs:{"tab-position":"top"},model:{value:e.tabsActiveName,callback:function(t){e.tabsActiveName=t},expression:"tabsActiveName"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"first"}},[a("div",{staticClass:"BaseInfo_1"},[a("div",{staticClass:"Info_part2"},[a("div",{staticStyle:{width:"50%"}},[a("div",{staticClass:"Title"},[e._v("开始时间")]),a("div",{staticClass:"Info"},[e._v(e._s(e.startDate))]),a("div")]),a("div",[a("div",{staticClass:"Title"},[e._v("保养周期")]),a("div",{staticClass:"Info"},[e._v(e._s(e.scheduleType_info))])])])]),a("div",{staticClass:"BaseInfo_1 BaseInfo_2"},[a("div",{staticClass:"Info_part1"},[a("div",{staticStyle:{width:"50%"}},[a("div",{staticClass:"Title"},[e._v("维护人员信息")]),e._l(e.users,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"20px"},attrs:{name:e.name,username:e.username,useremail:e.useremail}})}))],2),a("div",[a("div",{staticClass:"Title"},[e._v("设备信息")]),a("el-table",{staticClass:"extraTable",staticStyle:{"margin-top":"10px",width:"100%"},attrs:{data:e.devicetableData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"设备ID"}}),a("el-table-column",{attrs:{prop:"name",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"brand",label:"设备品牌"}}),a("el-table-column",{attrs:{prop:"deviceNo",label:"设备编号"}}),a("el-table-column",{attrs:{prop:"clazz",label:"设备分类"}})],1)],1)])])]),a("el-tab-pane",{attrs:{label:"保养内容",name:"second"}},e._l(e.content,(function(t,n){return a("div",{key:n,staticClass:"content"},[a("div",{staticClass:"title"},[a("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.contentinfotitle))])]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(t.contentinfodetail)}})])])})),0),a("el-tab-pane",{attrs:{label:"工具及备件",name:"third"}},[a("div",[e._v(e._s(e.tools))])]),a("el-tab-pane",{attrs:{label:"注意事项",name:"fourth"}},[a("div",[e._v(e._s(e.remark))])]),a("el-tab-pane",{attrs:{label:"保养记录",name:"fifth"}},[a("div",{staticClass:"addrecord"},[a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.addrecord}},[e._v("新增保养记录 ")])],1),a("div",[a("el-table",{staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskrecordtableData,stripe:"",border:""}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"「自我修复」的异常修复过程"}},[a("span",[e._v(e._s(t.row.fix))])]),a("el-form-item",{attrs:{label:"完成记录"}},[a("span",[e._v(e._s(t.row.record))])]),a("el-form-item",{attrs:{label:"异常报告"}},[a("span",[e._v(e._s(t.row.report))])]),a("el-form-item",{attrs:{label:"图片记录"}},[t.row.ifpicexist?a("img",{attrs:{src:t.row.pic}}):e._e(),t.row.ifpicexist?e._e():a("span",[e._v("暂无")])])],1)]}}])}),a("el-table-column",{attrs:{prop:"id",label:"记录ID",width:"70"}}),a("el-table-column",{attrs:{prop:"date",label:"计划保养时间"}}),a("el-table-column",{attrs:{prop:"realDate",label:"实际保养时间"}}),a("el-table-column",{attrs:{prop:"hasException",label:"是否存在「不能自我修复」的异常"}}),a("el-table-column",{attrs:{prop:"opUser",label:"保养人员"}})],1),a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])],1)],1),a("el-dialog",{attrs:{title:"新增保养记录",visible:e.dialogAddRecord},on:{"update:visible":function(t){e.dialogAddRecord=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-position":"left"}},[a("el-form-item",{attrs:{label:"「自我修复」过程: ","label-width":e.formLabelWidth,prop:"fix"}},[a("el-input",{attrs:{placeholder:"简述「自我修复」过程"},model:{value:e.form.fix,callback:function(t){e.$set(e.form,"fix",t)},expression:"form.fix"}})],1),a("el-form-item",{attrs:{label:"完成记录: ","label-width":e.formLabelWidth,prop:"record"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"完成记录（概括）"},model:{value:e.form.record,callback:function(t){e.$set(e.form,"record",t)},expression:"form.record"}})],1),a("el-form-item",{attrs:{label:"异常报告: ","label-width":e.formLabelWidth,prop:"report"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"报告「不能自我修复」的异常详情"},model:{value:e.form.report,callback:function(t){e.$set(e.form,"report",t)},expression:"form.report"}})],1),a("el-form-item",{attrs:{label:"是否「不能自我修复」:","label-width":"180px",prop:"hasException"}},[a("el-radio-group",{model:{value:e.form.hasException,callback:function(t){e.$set(e.form,"hasException",t)},expression:"form.hasException"}},[a("el-radio",{attrs:{label:"true"}},[e._v("是")]),a("el-radio",{attrs:{label:"false"}},[e._v("否")])],1)],1),a("el-form-item",{attrs:{label:"记录图片:","label-width":e.formLabelWidth,prop:"pic"}},[a("el-upload",{attrs:{"list-type":"picture",action:"",accept:".jpg, .png",limit:1,"auto-upload":!1,"file-list":e.fileList,"on-change":e.getFile}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("选择图片上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传一张jpg/png文件")])],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogAddRecord=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitrecord}},[e._v("确 定")])],1)],1)],1)},Le=[],Me=(a("1276"),a("79e2")),Fe={created:function(){var e=this;e.taskid=e.$route.query.id;var t="http://47.102.214.37:8080/ops/schedule/detail/"+e.$route.query.id;v.a.get(t).then((function(t){switch(console.log(t.data),e.name=t.data.name,t.data.scheduleType){case"Yearly":e.scheduleType="年保养";break;case"Seasonally":e.scheduleType="季度保养";break;case"Monthly":e.scheduleType="月保养";break;case"Weekly":e.scheduleType="周保养";break;case"Daily":e.scheduleType="日保养";break;case"Predictability":e.scheduleType="未知";break;default:break}if(e.startDate=null==t.data.startDate?"未分配":t.data.startDate,"日保养"==e.scheduleType&&(e.scheduleType_info="日保养（每天）"),"周保养"==e.scheduleType)switch(console.log(e.startDate),e.startDate){case 1:e.scheduleType_info="周保养（周一）";break;case 2:e.scheduleType_info="周保养（周二）";break;case 3:e.scheduleType_info="周保养（周三）";break;case 4:e.scheduleType_info="周保养（周四）";break;case 5:e.scheduleType_info="周保养（周五）";break;case 6:e.scheduleType_info="周保养（周六）";break;case 7:e.scheduleType_info="周保养（周日）";break;default:e.scheduleType_info="周保养（未分配）";break}else"月保养"==e.scheduleType?e.scheduleType_info="月保养（每月 "+e.startDate.split("-")[2]+" 号）":"季度保养"==e.scheduleType?e.scheduleType_info="季度保养（每季度 "+e.startDate.split("-")[2]+" 号）":"年保养"==e.scheduleType?e.scheduleType_info="年度保养":"未知"==e.scheduleType&&(e.scheduleType_info="未知");if(""!=t.data.content)for(var a=0;a<t.data.content.length;a++)e.content.push({contentinfotitle:t.data.content[a].title,contentinfodetail:t.data.content[a].detail});e.tools=t.data.tools,e.remark=t.data.remark;for(var n=0;n<t.data.device.length;n++){var s="http://47.102.214.37:8080/device/"+t.data.device[n].id;v.a.get(s).then((function(t){var a={};a.id=t.data.id,a.name=t.data.name,a.brand=t.data.brand,a.deviceNo=t.data.deviceNo,a.clazz=t.data.clazz,e.devicetableData.push(a)}))}for(var l=0;l<t.data.ops.length;l++){var o="http://47.102.214.37:8080/user/"+t.data.ops[l].id;v.a.get(o).then((function(t){e.users.push({name:t.data.name,username:t.data.username,useremail:t.data.email})}))}})),setTimeout((function(){var t="http://47.102.214.37:8080/ops/record/schedule/"+e.$route.query.id+"?page=0&size="+e.page_size;v.a.get(t).then((function(t){console.log(t.data),e.total=t.data.totalElements;for(var a=function(a){var n={};n.id=t.data.content[a].id,null==t.data.content[a].date?n.date="暂无":n.date=t.data.content[a].date,null==t.data.content[a].realDate?n.realDate="暂无":n.realDate=t.data.content[a].realDate,null==t.data.content[a].fix?n.fix="暂无":n.fix=t.data.content[a].fix,0==t.data.content[a].hasException?n.hasException="否":n.hasException="是",null==t.data.content[a].record?n.record="暂无":n.record=t.data.content[a].record,null==t.data.content[a].report?n.report="暂无":n.report=t.data.content[a].report,n.ifpicexist=!0,null==t.data.content[a].pic?n.ifpicexist=!1:n.pic="http://47.102.214.37:8080/pic/"+t.data.content[a].pic,setTimeout((function(){if(null==t.data.content[a].opUser)n.opUser="暂无";else{var e="http://47.102.214.37:8080/user/"+t.data.content[a].opUser.id;v.a.get(e).then((function(e){n.opUser=e.data.name})).catch((function(){n.opUser="获取失败，请刷新重试"}))}}),300),e.taskrecordtableData.unshift(n)},n=0;n<t.data.content.length;n++)a(n)}))}),300)},data:function(){return{taskid:"",name:null,opUserid:"",tabsActiveName:"first",users:[],scheduleType:null,startDate:null,scheduleType_info:null,devicetableData:[],content:[],tools:null,remark:null,taskrecordtableData:[],dialogAddRecord:!1,form:{fix:"",record:"",report:"",hasException:"",pic:""},formLabelWidth:"150px",fileList:[],dialogVisible:!1,dialogImageUrl:"",currentPage:1,page_size:5,page:1,total:0}},methods:{getFile:function(e){var t=this;this.getBase64(e.raw).then((function(e){var a=e.split(",");console.log(a,"params"),a.length>0&&(t.form.pic=a[1])}))},getBase64:function(e){return new Promise((function(t,a){var n=new FileReader,s="";n.readAsDataURL(e),n.onload=function(){s=n.result},n.onerror=function(e){a(e)},n.onloadend=function(){t(s)}}))},addrecord:function(){this.dialogAddRecord=!0},submitrecord:function(){var e=this;v.a.get("http://47.102.214.37:8080/user/me").then((function(t){console.log(t.data),e.opUserid=t.data.id})),setTimeout((function(){if(""==e.form.fix||""==e.form.record||""==e.form.report||""==e.form.hasException||""==e.form.pic)e.$message({message:"请将信息填写完整",type:"warning"});else{var t={},a="http://47.102.214.37:8080/pic";t.fix=e.form.fix,t.record=e.form.record,t.report=e.form.report,"false"==e.form.hasException?t.hasException=!1:t.hasException=!0,t.schedule={id:1*e.$route.query.id},t.opUser={id:e.opUserid},setTimeout((function(){v()({url:a,method:"post",data:e.form.pic,headers:{"Content-Type":"text/plain"}}).then((function(e){console.log(e),t.pic=e.data})),setTimeout((function(){console.log(t),v.a.post("http://47.102.214.37:8080/ops/record",t).then((function(t){console.log(t),e.$message({message:"新增成功",type:"success"}),e.dialogAddRecord=!1})).catch((function(e){console.log(e.response)}))}),300)}),300)}}),300)},handleSizeChange:function(e){var t=this;t.currentPage=1,t.page_size=e,t.taskrecordtableData=[],console.log(e);var a="http://47.102.214.37:8080/ops/record/schedule/"+t.$route.query.id+"?page=0&size="+t.page_size;console.log(a),v.a.get(a).then((function(e){console.log(e.data),t.total=e.data.totalElements;for(var a=0;a<e.data.content.length;a++){var n={};n.id=e.data.content[a].id,null==e.data.content[a].date?n.date="暂无":n.date=e.data.content[a].date,null==e.data.content[a].realDate?n.realDate="暂无":n.realDate=e.data.content[a].realDate,null==e.data.content[a].fix?n.fix="暂无":n.fix=e.data.content[a].fix,0==e.data.content[a].hasException?n.hasException="否":n.hasException="是",null==e.data.content[a].record?n.record="暂无":n.record=e.data.content[a].record,null==e.data.content[a].report?n.report="暂无":n.report=e.data.content[a].report,n.ifpicexist=!0,null==e.data.content[a].pic?n.ifpicexist=!1:n.pic="http://47.102.214.37:8080/pic/"+e.data.content[a].pic,t.taskrecordtableData.unshift(n)}setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),300)}))},handleCurrentChange:function(e){var t=this;t.page=e,t.currentPage=e,console.log(e);var a="http://47.102.214.37:8080/ops/record/schedule/"+t.$route.query.id+"?page="+(t.page-1)+"&size="+t.page_size;console.log(a),v.a.get(a).then((function(e){console.log(e.data),t.taskrecordtableData=[],t.total=e.data.totalElements;for(var a=0;a<e.data.content.length;a++){var n={};n.id=e.data.content[a].id,null==e.data.content[a].date?n.date="暂无":n.date=e.data.content[a].date,null==e.data.content[a].realDate?n.realDate="暂无":n.realDate=e.data.content[a].realDate,null==e.data.content[a].fix?n.fix="暂无":n.fix=e.data.content[a].fix,0==e.data.content[a].hasException?n.hasException="否":n.hasException="是",null==e.data.content[a].record?n.record="暂无":n.record=e.data.content[a].record,null==e.data.content[a].report?n.report="暂无":n.report=e.data.content[a].report,n.ifpicexist=!0,null==e.data.content[a].pic?n.ifpicexist=!1:n.pic="http://47.102.214.37:8080/pic/"+e.data.content[a].pic,t.taskrecordtableData.unshift(n)}setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),300)}))}},components:{User:Me["a"]}},Ve=Fe,Ue=(a("a88f"),Object(c["a"])(Ve,Be,Le,!1,null,null,null)),je=Ue.exports,We=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-TotalTaskList"},[a("div",{staticClass:"head-btn"},[a("div",{staticClass:"oper-btns-left"},[a("div",{staticClass:"select"},[a("el-select",{staticStyle:{"margin-left":"5px"},attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.selectchange},model:{value:e.selectvalue,callback:function(t){e.selectvalue=t},expression:"selectvalue"}},e._l(e.selectoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),a("div",e._l(e.dynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1),a("div",{staticClass:"search"},[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1)]),["ROOT","ADMIN"].includes(e.userRole)?a("div",{staticClass:"oper-btns-right"},[a("el-button",{staticClass:"bigdel-btn",attrs:{icon:"el-icon-delete"},on:{click:e.delectExtraInfo}},[e._v("批量删除")])],1):e._e()]),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"index",label:"序号",width:"50"}}),a("el-table-column",{attrs:{prop:"devicename",label:"设备名称",width:"200"}}),a("el-table-column",{attrs:{prop:"deviceNo",label:"设备编号",width:200}}),a("el-table-column",{attrs:{prop:"taskname",label:"保养标准",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"taskno",label:"保养编号",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"nextDate",label:"下次保养时间",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"opuser",label:"人员",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"deadline",label:"剩余天数",width:e.tablewidth}}),["ROOT","ADMIN","CREATOR","SUPERVISOR"].includes(e.userRole)?a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.handleDetail(t.$index,t.row)}}},[e._v("详情")]),a("el-button",{on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("修改")]),a("el-button",{on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}],null,!1,3581015138)}):a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.handleDetail(t.$index,t.row)}}},[e._v("查看任务详情")])]}}])})],1),a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},["name"==e.selectvalue?a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.selectmodel,callback:function(t){e.selectmodel=t},expression:"selectmodel"}}):e._e(),"scheduleType"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择保养周期",filterable:"",clearable:""},model:{value:e.scheduleTypevalue,callback:function(t){e.scheduleTypevalue=t},expression:"scheduleTypevalue"}},e._l(e.scheduleTypeoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"device"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择设备",filterable:"",clearable:"",multiple:""},model:{value:e.devicevalue,callback:function(t){e.devicevalue=t},expression:"devicevalue"}},e._l(e.deviceoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"ops"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择保养人员",filterable:"",clearable:"",multiple:""},model:{value:e.opsvalue,callback:function(t){e.opsvalue=t},expression:"opsvalue"}},e._l(e.opsoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"startDate"==e.selectvalue?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.datevalue,callback:function(t){e.datevalue=t},expression:"datevalue"}}):e._e(),"timeChoose"==e.selectvalue?a("el-date-picker",{attrs:{type:"date",placeholder:"选择开始日期","value-format":"yyyy-MM-dd"},model:{value:e.start,callback:function(t){e.start=t},expression:"start"}}):e._e(),"timeChoose"==e.selectvalue?a("el-date-picker",{staticStyle:{"margin-top":"20px"},attrs:{type:"date",placeholder:"选择结束日期","value-format":"yyyy-MM-dd"},model:{value:e.end,callback:function(t){e.end=t},expression:"end"}}):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitselect}},[e._v("确 定")])],1)],1)],1)},Ye=[],He={created:function(){var e=this;v.a.get("http://47.102.214.37:8080/user/me").then((function(t){console.log(t.data),e.userRole=t.data.role})),0!=Z.taskselectInfo.length?(e.selectInfo=Z.taskselectInfo,e.dynamicTags=Z.taskdynamicTags,e.search()):setTimeout((function(){e.refresh()}),300),v()({method:"GET",url:"http://47.102.214.37:8080/device/query?name=!"}).then((function(t){for(var a=0;a<t.data.content.length;a++){var n={};n.value=t.data.content[a].id,n.label=t.data.content[a].name+" ("+t.data.content[a].deviceNo+")",e.deviceoptions[0].options.push(n)}})).catch((function(e){console.log(e)})),v.a.get("http://47.102.214.37:8080/user/query?role==OPERATOR").then((function(t){console.log(t.data);for(var a=0;a<t.data.content.length;a++)e.opsoptions[0].options.push({value:t.data.content[a].id,label:t.data.content[a].name+" (用户名："+t.data.content[a].username+")"})}))},data:function(){return{userRole:"",tableData:[],tablewidth:"150",checkedDetail:[],selectoptions:[{label:"字段",options:[{value:"name",label:"任务名称"},{value:"scheduleType",label:"保养周期"},{value:"device",label:"设备"},{value:"ops",label:"人员"},{value:"startDate",label:"开始时间"},{value:"timeChoose",label:"时间范围"}]}],selectvalue:"",selectmodel:"",dialogSearchVisible:!1,selectInfo:[],dynamicTags:[],scheduleTypevalue:"",scheduleTypeoptions:[{label:"保养周期",options:[{value:"Monthly",label:"月保养"},{value:"Yearly",label:"年保养"},{value:"Seasonly",label:"季度保养"},{value:"Daily",label:"日保养"},{value:"Weeklt",label:"周保养"}]}],devicevalue:"",deviceoptions:[{label:"设备列表",options:[]}],opsvalue:"",opsoptions:[{label:"人员列表",options:[]}],datevalue:"",start:"",end:"",currentPage:1,page_size:5,page:1,total:0}},methods:{handleDetailSelectionChange:function(e){this.checkedDetail=e,console.log(this.checkedDetail)},selectchange:function(){this.dialogSearchVisible=!0},submitselect:function(){this.dialogSearchVisible=!1,"scheduleType"==this.selectvalue?(this.selectInfo.push({ziduan:this.selectvalue,value:this.scheduleTypevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.scheduleTypevalue)):"device"==this.selectvalue?(this.selectInfo.push({ziduan:this.selectvalue,value:this.devicevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.devicevalue)):"ops"==this.selectvalue?(console.log(this.opsvalue),this.selectInfo.push({ziduan:this.selectvalue,value:this.opsvalue}),this.dynamicTags.push(this.selectvalue+" / "+this.opsvalue)):"startDate"==this.selectvalue?(console.log(this.opsvalue),this.selectInfo.push({ziduan:this.selectvalue,value:this.datevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.datevalue)):(this.selectInfo.push({ziduan:this.selectvalue,value:this.selectmodel}),this.dynamicTags.push(this.selectvalue+" / "+this.selectmodel))},handleClose:function(e){var t=this.dynamicTags.indexOf(e);console.log(t),this.dynamicTags.splice(t,1),this.selectInfo.splice(t,1)},search:function(){var e=this,t="";if(e.tableData=[],e.currentPage=1,0==e.selectInfo.length)e.$message({message:"请输入搜索字段",type:"warning"});else{if("name"==e.selectInfo[0].ziduan)t="http://47.102.214.37:8080/ops/query?"+e.selectInfo[0].ziduan+"=L"+e.selectInfo[0].value+"%25";else if(console.log(e.selectInfo[0]),"device"==e.selectInfo[0].ziduan||"ops"==e.selectInfo[0].ziduan)if(e.selectInfo[0].value.length>1){t="http://47.102.214.37:8080/ops/query?"+e.selectInfo[0].ziduan+"=I"+e.selectInfo[0].value[0];for(var a=1;a<e.selectInfo[0].value.length;a++)t=t+","+e.selectInfo[0].value[a]}else t="http://47.102.214.37:8080/ops/query?"+e.selectInfo[0].ziduan+"=="+e.selectInfo[0].value;else t="http://47.102.214.37:8080/ops/query?"+e.selectInfo[0].ziduan+"=="+e.selectInfo[0].value;if(1==e.selectInfo.length)v.a.get(t).then((function(t){if(console.log(t.data),e.total=t.data.totalElements,0==t.data.content.length)e.$message({message:"无结果",type:"warning"});else{for(var a=function(a){var n={};n.id=t.data.content[a].id,n.name=t.data.content[a].name,setTimeout((function(){var s="http://47.102.214.37:8080/ops/schedule/status/"+t.data.content[a].id;v.a.get(s).then((function(e){null==e.data.nextDate?n.nextDate="暂无":n.nextDate=e.data.nextDate,null==e.data.nextDateDay?n.deadline="暂无":n.deadline=e.data.nextDateDay})),setTimeout((function(){e.tableData.push(n)}),400)}),300)},n=0;n<t.data.content.length;n++)a(n);Z.taskselectInfo=e.selectInfo,Z.taskdynamicTags=e.dynamicTags,setTimeout((function(){e.$message({message:"查询成功",type:"success"})}),300)}}));else{console.log(e.selectInfo);for(var n=1;n<e.selectInfo.length;n++)if("name"==e.selectInfo[n].ziduan)t=t+"&"+e.selectInfo[n].ziduan+"=L"+e.selectInfo[n].value+"%25";else if("device"==e.selectInfo[n].ziduan||"ops"==e.selectInfo[n].ziduan)if(e.selectInfo[n].value.length>1){t=t+"&"+e.selectInfo[n].ziduan+"=I"+e.selectInfo[n].value[0];for(var s=1;s<e.selectInfo[n].value.length;s++)t=t+","+e.selectInfo[n].value[s]}else t=t+"&"+e.selectInfo[n].ziduan+"=="+e.selectInfo[n].value;else t=t+"&"+e.selectInfo[n].ziduan+"=="+e.selectInfo[n].value;v.a.get(t).then((function(t){console.log(t.data),e.tableData=[],e.total=t.data.totalElements,e.currentPage=1;for(var a=function(a){var n={};n.id=t.data.content[a].id,n.name=t.data.content[a].name,setTimeout((function(){var s="http://47.102.214.37:8080/ops/schedule/status/"+t.data.content[a].id;v.a.get(s).then((function(e){null==e.data.nextDate?n.nextDate="暂无":n.nextDate=e.data.nextDate,null==e.data.nextDateDay?n.deadline="暂无":n.deadline=e.data.nextDateDay})),setTimeout((function(){e.tableData.push(n)}),400)}),300)},n=0;n<t.data.content.length;n++)a(n);Z.taskselectInfo=e.selectInfo,Z.taskdynamicTags=e.dynamicTags,setTimeout((function(){e.$message({message:"查询成功",type:"success"})}),300)}))}}},refresh:function(){var e=this;e.tableData=[],e.currentPage=1;var t=1;if(["ROOT","ADMIN","CREATOR","SUPERVISOR"].includes(e.userRole)){var a="http://47.102.214.37:8080/ops/schedule?page=0&size="+e.page_size;v.a.get(a).then((function(a){console.log(a.data),e.total=a.data.totalElements;for(var n=function(n){var s={opuser:"",devicename:"",deviceNo:""};s.index=t++,s.id=a.data.content[n].id,s.taskname=null==a.data.content[n].name?"未分配":a.data.content[n].name,s.taskno=null==a.data.content[n].no?"未分配":a.data.content[n].no;var l="http://47.102.214.37:8080/ops/schedule/status/"+a.data.content[n].id;v.a.get(l).then((function(e){null==e.data.nextDate?s.nextDate="暂无":s.nextDate=e.data.nextDate,null==e.data.nextDateDay?s.deadline="暂无":s.deadline=e.data.nextDateDay})),setTimeout((function(){if(0==a.data.content[n].device.length)s.devicename="暂未分配",s.deviceNo="暂未分配";else for(var t=0;t<a.data.content[n].device.length;t++){var l="http://47.102.214.37:8080/device/"+a.data.content[n].device[t].id;v.a.get(l).then((function(e){s.devicename+=e.data.name+" / ",s.deviceNo+=e.data.deviceNo+" / "})).catch((function(){s.device="获取失败"}))}setTimeout((function(){if(0==a.data.content[n].ops.length)s.opuser="暂未分配";else for(var t=0;t<a.data.content[n].ops.length;t++){var l="http://47.102.214.37:8080/user/"+a.data.content[n].ops[t].id;v.a.get(l).then((function(e){s.opuser+=e.data.name+" / "})).catch((function(){s.opuser="获取失败"}))}setTimeout((function(){e.tableData.push(s)}),600)}),300)}),300)},s=0;s<a.data.content.length;s++)n(s);setTimeout((function(){e.$message({message:"刷新成功",type:"success"})}),600)}))}else{var n="http://47.102.214.37:8080/my/schedule";v.a.get(n).then((function(a){console.log(a.data),e.total=a.data.totalElements;for(var n=function(n){var s={opuser:"",devicename:"",deviceNo:""};s.index=t++,s.name=a.data.content[n].name;var l="http://47.102.214.37:8080/ops/schedule/status/"+a.data.content[n].id;v.a.get(l).then((function(e){null==e.data.nextDate?s.nextDate="暂无":s.nextDate=e.data.nextDate,null==e.data.nextDateDay?s.deadline="暂无":s.deadline=e.data.nextDateDay})),setTimeout((function(){if(0==a.data.content[n].device.length)s.devicename="暂未分配",s.deviceNo="暂未分配";else for(var t=0;t<a.data.content[n].device.length;t++){var l="http://47.102.214.37:8080/device/"+a.data.content[n].device[t].id;v.a.get(l).then((function(e){console.log(e.data),s.devicename+=e.data.name+" / ",s.deviceNo+=e.data.deviceNo+" / "})).catch((function(){s.device="获取失败"}))}setTimeout((function(){if(0==a.data.content[n].ops.length)s.opuser="暂未分配";else for(var t=0;t<a.data.content[n].ops.length;t++){var l="http://47.102.214.37:8080/user/"+a.data.content[n].ops[t].id;v.a.get(l).then((function(e){console.log(e.data),s.opuser+=e.data.name+" / "})).catch((function(){s.opuser="获取失败"}))}setTimeout((function(){e.tableData.push(s)}),300)}),300)}),300)},s=0;s<a.data.content.length;s++)n(s);setTimeout((function(){e.$message({message:"刷新成功",type:"success"})}),600)}))}e.selectInfo=[],e.selectvalue="",e.selectmodel="",e.dynamicTags=[],Z.taskselectInfo=[],Z.taskdynamicTags=[]},handleDetail:function(e){console.log(this.tableData[e]),this.$router.push({path:"/taskDetailInfo",query:this.tableData[e]})},handleEdit:function(e){console.log(this.tableData[e]);var t={};t.taskID=this.tableData[e].id,this.$router.push({path:"/editTask",query:t})},handleDelete:function(e){var t=this,a=this;this.$confirm("删除后无法更改, 是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var n="http://47.102.214.37:8080/ops/schedule/"+a.taskData[e].id;v.a.delete(n).then((function(n){200==n.status&&(a.taskData.splice(e,1),t.$message({message:"删除成功",type:"success"}))}))})).catch((function(){a.$message.info("已取消删除")}))},delectExtraInfo:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("此用户将被永久删除, \n是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.checkedDetail.forEach((function(a){t.tableData.forEach((function(n,s){if(a.id==n.id){console.log(a,n,s);var l="http://47.102.214.37:8080/ops/schedule/"+n.id;v.a.delete(l).then((function(){e.$message({message:"删除成功",type:"success"}),t.tableData.splice(s,1),t.checkedDetail.pop(),t.total--}))}}))}))})).catch((function(){e.$message.info("已取消删除")}))},handleSizeChange:function(e){var t=this,a=1;t.tableData=[],t.currentPage=1,console.log(e),t.page_size=e;var n="http://47.102.214.37:8080/ops/schedule?page=0&size="+t.page_size;console.log(n),v.a.get(n).then((function(e){console.log(e.data),t.total=e.data.totalElements;for(var n=function(n){var s={opuser:"",devicename:"",deviceNo:""};s.index=a++,s.taskname=null==e.data.content[n].name?"未分配":e.data.content[n].name;var l="http://47.102.214.37:8080/ops/schedule/status/"+e.data.content[n].id;v.a.get(l).then((function(e){null==e.data.nextDate?s.nextDate="暂无":s.nextDate=e.data.nextDate,null==e.data.nextDateDay?s.deadline="暂无":s.deadline=e.data.nextDateDay})),setTimeout((function(){if(0==e.data.content[n].device.length)s.devicename="暂未分配",s.deviceNo="暂未分配";else for(var a=0;a<e.data.content[n].device.length;a++){var l="http://47.102.214.37:8080/device/"+e.data.content[n].device[a].id;v.a.get(l).then((function(e){console.log(e.data),s.devicename+=e.data.name+" / ",s.deviceNo+=e.data.deviceNo+" / "})).catch((function(){s.device="获取失败"}))}setTimeout((function(){if(0==e.data.content[n].ops.length)s.opuser="暂未分配";else for(var a=0;a<e.data.content[n].ops.length;a++){var l="http://47.102.214.37:8080/user/"+e.data.content[n].ops[a].id;v.a.get(l).then((function(e){console.log(e.data),s.opuser+=e.data.name+" / "})).catch((function(){s.opuser="获取失败"}))}setTimeout((function(){t.tableData.push(s)}),300)}),300)}),300)},s=0;s<e.data.content.length;s++)n(s);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),600)}))},handleCurrentChange:function(e){var t=this,a=1;t.tableData=[],t.page=e,t.currentPage=e,console.log(e);var n="http://47.102.214.37:8080/ops/schedule?page="+(t.page-1)+"&size="+t.page_size;v.a.get(n).then((function(e){console.log(e.data),t.total=e.data.totalElements;for(var n=function(n){var s={opuser:"",devicename:"",deviceNo:""};s.index=a++,s.taskname=null==e.data.content[n].name?"未分配":e.data.content[n].name;var l="http://47.102.214.37:8080/ops/schedule/status/"+e.data.content[n].id;v.a.get(l).then((function(e){null==e.data.nextDate?s.nextDate="暂无":s.nextDate=e.data.nextDate,null==e.data.nextDateDay?s.deadline="暂无":s.deadline=e.data.nextDateDay})),setTimeout((function(){if(0==e.data.content[n].device.length)s.devicename="暂未分配",s.deviceNo="暂未分配";else for(var a=0;a<e.data.content[n].device.length;a++){var l="http://47.102.214.37:8080/device/"+e.data.content[n].device[a].id;v.a.get(l).then((function(e){console.log(e.data),s.devicename+=e.data.name+" / ",s.deviceNo+=e.data.deviceNo+" / "})).catch((function(){s.device="获取失败"}))}setTimeout((function(){if(0==e.data.content[n].ops.length)s.opuser="暂未分配";else for(var a=0;a<e.data.content[n].ops.length;a++){var l="http://47.102.214.37:8080/user/"+e.data.content[n].ops[a].id;v.a.get(l).then((function(e){console.log(e.data),s.opuser+=e.data.name+" / "})).catch((function(){s.opuser="获取失败"}))}setTimeout((function(){t.tableData.push(s)}),300)}),300)}),300)},s=0;s<e.data.content.length;s++)n(s);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),600)}))}}},Je=He,Ge=(a("c6f3"),Object(c["a"])(Je,We,Ye,!1,null,null,null)),Ze=Ge.exports,Ke=function(){var e=this,t=e.$createElement,a=e._self._c||t;return["ROOT","ADMIN","CREATOR"].includes(e.userRole)?a("div",{staticClass:"Container-TssignTask"},[a("div",{staticStyle:{"padding-bottom":"20px",width:"100%"}},[a("el-breadcrumb",{staticClass:"Breadcrumb"},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("任务标准分配")])],1)],1),a("div",{staticClass:"chuansuo"},[a("div",{staticClass:"kuang"},[a("el-transfer",{attrs:{filterable:"",data:e.data1,titles:e.titles1},on:{change:e.change1},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}})],1),a("div",{staticClass:"kuang kuang3"},[a("el-transfer",{attrs:{filterable:"",data:e.data3,titles:e.titles3},on:{change:e.change3},model:{value:e.value3,callback:function(t){e.value3=t},expression:"value3"}})],1),a("div",{staticClass:"Btns"},[a("div",{staticClass:"sub-btn"},[a("el-button",{on:{click:e.Next}},[e._v("下一步")])],1)])])]):e._e()},Qe=[],Xe={name:"AddTaskInside",created:function(){var e=this;v.a.get("http://47.102.214.37:8080/user/me").then((function(t){console.log(t.data),e.userRole=t.data.role,e.userID=t.data.id})),setTimeout((function(){["ROOT","ADMIN","CREATOR"].includes(e.userRole)&&(v.a.get("http://47.102.214.37:8080/ops/schedule?page=0&size=100").then((function(t){for(var a=0;a<t.data.content.length;a++){var n={};n.key=t.data.content[a].id,n.label=t.data.content[a].name,e.data1.unshift(n)}})),v.a.get("http://47.102.214.37:8080/device/query?name=!").then((function(t){console.log(t.data);for(var a=0;a<t.data.content.length;a++){var n={};n.key=t.data.content[a].id,n.label=t.data.content[a].name+"（"+t.data.content[a].deviceNo+"）",e.data3.push(n)}})))}),200)},data:function(){return{userRole:"",data1:[],value1:[],titles1:["标准名称","已选择标准"],data3:[],value3:[],titles3:["设备列表","已选择设备"],selectedTaskid:[],selectedDeviceid:[]}},methods:{change1:function(e){var t=this;t.selectedTaskid=[],console.log(e);for(var a=0;a<e.length;a++)t.selectedTaskid.push({id:e[a]})},change3:function(e){var t=this;t.selectedDeviceid=[],console.log(e);for(var a=0;a<e.length;a++)t.selectedDeviceid.push({id:e[a]})},Next:function(){var e=this;if(0==e.selectedTaskid.length||0==e.selectedDeviceid.length)e.$message({message:"请将信息填写完整",type:"warning"});else{console.log(e.selectedTaskid),console.log(e.selectedDeviceid);for(var t={taskid:[],deviceid:[]},a=0;a<e.selectedTaskid.length;a++)t.taskid.push({id:e.selectedTaskid[a].id});for(var n=0;n<e.selectedDeviceid.length;n++)t.deviceid.push({id:e.selectedDeviceid[n].id});console.log(t),this.$router.push({path:"./tssignTask2",query:t})}}}},et=Xe,tt=(a("ba9b"),a("75bb"),Object(c["a"])(et,Ke,Qe,!1,null,"9722ccc0",null)),at=tt.exports,nt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-TssignTask2"},[a("div",{staticStyle:{"padding-bottom":"20px",width:"100%"}},[a("el-breadcrumb",{staticClass:"Breadcrumb"},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("任务分配")])],1)],1),a("div",{staticStyle:{"text-align":"center"}},[e._v(" 保养开始日期： "),a("el-date-picker",{staticStyle:{"margin-left":"30px"},attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.datevalue,callback:function(t){e.datevalue=t},expression:"datevalue"}})],1),a("div",{staticClass:"chuansuo"},[a("div",{staticClass:"kuang kuang2"},[a("el-transfer",{attrs:{filterable:"",data:e.data2,titles:e.titles2},on:{change:e.change2},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}})],1),a("div",{staticClass:"Btns"},[a("div",{staticClass:"back-btn"},[a("el-button",{on:{click:e.Back}},[e._v("返回")])],1),a("div",{staticClass:"sub-btn"},[a("el-button",{on:{click:e.SubTssign}},[e._v("保存并提交")])],1)])])])},st=[],lt={created:function(){var e=this;console.log(e.$route.query),e.selectedTaskid=e.$route.query.taskid,e.selectedDeviceid=e.$route.query.deviceid,v.a.get("http://47.102.214.37:8080/user/me").then((function(t){e.userid=t.data.id})),v.a.get("http://47.102.214.37:8080/user/query?role==OPERATOR").then((function(t){for(var a=0;a<t.data.content.length;a++){var n={};n.key=t.data.content[a].id,n.label=t.data.content[a].username,e.data2.unshift(n)}}))},data:function(){return{userid:"",datevalue:"",data2:[],value2:[],titles2:["人员列表","已选择人员"],selectedTaskid:[],selectedUserid:[],selectedDeviceid:[]}},methods:{change2:function(e){var t=this;console.log(e);for(var a=0;a<e.length;a++)t.selectedUserid.push({id:e[a]})},Back:function(){this.$router.push({path:"./tssignTask"})},SubTssign:function(){var e=this;if(0==e.selectedUserid.length||""==e.datevalue)e.$message({message:"请将信息填写完整",type:"warning"});else for(var t=function(){var t="http://47.102.214.37:8080/ops/schedule/detail/"+e.selectedTaskid[a].id;console.log(t),v.a.get(t).then((function(a){console.log(a.data);for(var n={},s=[],l=[],o=0;o<e.selectedDeviceid.length;o++)l.push({id:e.selectedDeviceid[o].id});console.log(e.selectedUserid);for(var i=0;i<e.selectedUserid.length;i++)s.push({id:e.selectedUserid[i].id});n.acceptedStandard=a.data.acceptedStandard,n.content=a.data.content,n.id=a.data.id,n.name=a.data.name,n.remark=a.data.remark,n.scheduleType=a.data.scheduleType,n.startDate=e.datevalue,n.side=a.data.side,n.tools=a.data.tools,n.device=l,n.ops=s,n.manager={id:e.userid},console.log(n),setTimeout((function(){v.a.put(t,n).then((function(t){console.log(t),e.$message({message:"分配成功",type:"success"})}))}),200)}))},a=0;a<e.selectedTaskid.length;a++)t()}}},ot=lt,it=(a("f92a"),a("603c"),Object(c["a"])(ot,nt,st,!1,null,"bfe2d5a6",null)),ct=it.exports,rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ErrorTask-container"},[a("div",{staticClass:"Task-info"},[a("div",{staticClass:"title"},[e._v("报修申请单")]),a("div",{staticClass:"Users-Name"},[a("div",{staticClass:"part0",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报告人员")]),a("user",{staticStyle:{"margin-top":"5px"},attrs:{name:e.reporter.name,username:e.reporter.username,useremail:e.reporter.useremail}})],1),a("div",{staticClass:"part0",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("设备名称")]),a("el-select",{attrs:{filterable:"",clearable:"",multiple:"","collapse-tags":"",placeholder:"请选择"},model:{value:e.device,callback:function(t){e.device=t},expression:"device"}},e._l(e.options1,(function(t){return a("el-option",{key:t.value,attrs:{label:t.devicename,value:t.value}},[a("span",{staticStyle:{float:"left","font-size":"13px"}},[e._v(e._s(t.devicename))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px","margin-right":"15px"}},[e._v(e._s(t.devicenumber))])])})),1)],1)]),a("div",{staticClass:"Content"},[a("div",{staticClass:"part2",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("异常描述和异常处理请求")]),a("quill-editor",{staticStyle:{height:"70%","margin-top":"5px",width:"100%"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)]),a("div",{staticClass:"SelectOpreator "},[a("div",{staticClass:"part3"},[a("div",{staticClass:"Text"},[e._v("选择报告接受人")]),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.assignee,callback:function(t){e.assignee=t},expression:"assignee"}},e._l(e.options2,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1)]),a("div",{staticClass:"submitbtn"},[a("el-button",{on:{click:e.submit}},[e._v("提交")])],1)])])},dt=[],ut={components:{quillEditor:ke["quillEditor"],User:Me["a"]},created:function(){var e=this,t="";console.log(),v.a.get("http://47.102.214.37:8080/user/me").then((function(a){t=a.data.role,console.log(a.data),e.reporter.id=a.data.id,e.reporter.name=a.data.name,e.reporter.username=a.data.username,e.reporter.useremail=a.data.email})),setTimeout((function(){""!=t&&"OPERATOR"!=t?(v.a.get("http://47.102.214.37:8080/device/query?name=!").then((function(t){for(var a=0;a<t.data.content.length;a++){var n={};n.value=t.data.content[a].id,n.devicename=t.data.content[a].name,n.devicenumber=t.data.content[a].deviceNo,e.options1.push(n)}})),v.a.get("http://47.102.214.37:8080/user/query").then((function(t){setTimeout((function(){for(var a=0;a<t.data.content.length;a++)"SUPERVISOR"==t.data.content[a].role&&e.options2[0].options.push({value:t.data.content[a].id,label:t.data.content[a].name+" (用户名："+t.data.content[a].username+")"})}),300)}))):""!=t&&"OPERATOR"==t&&(v.a.get("http://47.102.214.37:8080/my/device").then((function(t){console.log(t.data);for(var a=0;a<t.data.length;a++){var n={};n.value=t.data[a].id,n.devicename=t.data[a].name,n.devicenumber=t.data[a].deviceNo,e.options1.push(n)}})),v.a.get("http://47.102.214.37:8080/user/query").then((function(t){for(var a=0;a<t.data.content.length;a++)"SUPERVISOR"==t.data.content[a].role&&e.options2[0].options.push({value:t.data.content[a].id,label:t.data.content[a].name+" (用户名："+t.data.content[a].username+")"})})))}),300)},data:function(){return{reporter:{},device:[],options1:[],content:"",assignee:"",options2:[{label:"SUPERVISOR",options:[]}],editorOption:{placeholder:"请输入异常描述和异常处理请求"}}},methods:{onEditorChange:function(e){var t=e.html;this.content=t},submit:function(){var e=this,t=this;console.log(t.descriptionPic);var a=[],n=[];if(t.assignee==[]||t.device==[]||""==t.descriptionPic||""==t.content)t.$message({message:"请将信息填写完整",type:"warning"});else{for(var s=0;s<t.device.length;s++)n.push({id:t.device[s]});a.push({id:t.assignee});var l={assignee:a,closed:!1,content:t.content,descriptionPic:t.descriptionPic,device:n,reporter:{id:t.reporter.id}};console.log(l),v.a.post("http://47.102.214.37:8080/issue",l).then((function(e){console.log(e),t.$message({message:"申请成功",type:"success"})})).catch((function(t){console.log(t.response),e.$message({message:"申请失败",type:"error"})}))}}}},pt=ut,ft=(a("409f"),Object(c["a"])(pt,rt,dt,!1,null,null,null)),mt=ft.exports,vt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-AllError"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("全部异常")])],1),a("div",{staticClass:"head-btn"},[a("div",{staticClass:"oper-btns-left"},[a("div",{staticClass:"select"},[a("el-select",{staticStyle:{"margin-left":"5px"},attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.selectchange},model:{value:e.selectvalue,callback:function(t){e.selectvalue=t},expression:"selectvalue"}},e._l(e.selectoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),a("div",e._l(e.dynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1),a("div",{staticClass:"search"},[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1)])]),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"errorid",label:"报修流水号",width:"200"}}),a("el-table-column",{attrs:{prop:"errordevicename",label:"故障设备名称",width:"200"}}),a("el-table-column",{attrs:{prop:"errordeviceNo",label:"故障设备编号",width:"200"}}),a("el-table-column",{attrs:{prop:"reportername",label:"报修人员",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"reportertime",label:"报修时间",width:"180"}}),a("el-table-column",{attrs:{prop:"assigneename",label:"维修人员",width:"180"}}),a("el-table-column",{attrs:{prop:"assigneestatus",label:"维修状态",width:e.tablewidth}}),["ROOT","ADMIN"].includes(e.userRole)?a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.errordetail(t.$index)}}},[e._v("查看详情")])]}}],null,!1,2463460010)}):e._e()],1),a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},["device"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择设备",filterable:"",clearable:"",multiple:""},model:{value:e.devicevalue,callback:function(t){e.devicevalue=t},expression:"devicevalue"}},e._l(e.deviceoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"reporter"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择报修人员",filterable:"",clearable:"",multiple:""},model:{value:e.reportervalue,callback:function(t){e.reportervalue=t},expression:"reportervalue"}},e._l(e.reporteroptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"assignee"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择维修人员",filterable:"",clearable:"",multiple:""},model:{value:e.assigneevalue,callback:function(t){e.assigneevalue=t},expression:"assigneevalue"}},e._l(e.assigneeoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitselect}},[e._v("确 定")])],1)],1)],1)},ht=[],gt=(a("5319"),a("bf19"),{created:function(){var e=this;v.a.get("http://47.102.214.37:8080/user/me").then((function(t){console.log(t.data),e.userRole=t.data.role})),0!=Z.fixselectInfo.length?(e.selectInfo=Z.fixselectInfo,e.dynamicTags=Z.fixdynamicTags,e.search()):setTimeout((function(){e.refresh()}),200),v()({method:"GET",url:"http://47.102.214.37:8080/device/query?name=!"}).then((function(t){for(var a=0;a<t.data.content.length;a++){var n={};n.value=t.data.content[a].id,n.label=t.data.content[a].name+" ("+t.data.content[a].deviceNo+")",e.deviceoptions[0].options.push(n)}})).catch((function(e){console.log(e)})),setTimeout((function(){v.a.get("http://47.102.214.37:8080/user/query").then((function(t){for(var a=0;a<t.data.content.length;a++)if("ROOT"==t.data.content[a].role){var n={};n.value=t.data.content[a].id,n.label=t.data.content[a].name+" (用户名："+t.data.content[a].username+")",e.reporteroptions[0].options.push(n)}else if("ADMIN"==t.data.content[a].role){var s={};s.value=t.data.content[a].id,s.label=t.data.content[a].name+" (用户名："+t.data.content[a].username+")",e.reporteroptions[1].options.push(s)}else if("CREATER"==t.data.content[a].role){var l={};l.value=t.data.content[a].id,l.label=t.data.content[a].name+" (用户名："+t.data.content[a].username+")",e.reporteroptions[2].options.push(l)}else if("SUPERVISOR"==t.data.content[a].role){var o={};o.value=t.data.content[a].id,o.label=t.data.content[a].name+" (用户名："+t.data.content[a].username+")",e.reporteroptions[3].options.push(o)}else if("OPERATOR"==t.data.content[a].role){var i={};i.value=t.data.content[a].id,i.label=t.data.content[a].name+" (用户名："+t.data.content[a].username+")",e.reporteroptions[4].options.push(i),e.assigneeoptions[0].options.push(i)}}))}),300)},data:function(){return{userRole:"",taskData:[],tablewidth:"150",selectoptions:[{label:"字段",options:[{value:"device",label:"设备"},{value:"reporter",label:"报修人员"},{value:"assignee",label:"维修人员"}]}],dynamicTags:[],devicevalue:"",deviceoptions:[{label:"设备列表",options:[]}],assigneevalue:"",assigneeoptions:[{label:"OPERATOR",options:[]}],reportervalue:"",reporteroptions:[{label:"ROOT",options:[]},{label:"ADMIN",options:[]},{label:"CREATER",options:[]},{label:"SUPERVISOR",options:[]},{label:"OPERATOR",options:[]}],selectvalue:"",selectInfo:[],dialogSearchVisible:!1,currentPage:1,page_size:5,page:1,total:0}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return this.active++,new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},selectchange:function(){this.dialogSearchVisible=!0},submitselect:function(){this.dialogSearchVisible=!1,"device"==this.selectvalue?(this.selectInfo.push({ziduan:this.selectvalue,value:this.devicevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.devicevalue)):"assignee"==this.selectvalue?(this.selectInfo.push({ziduan:this.selectvalue,value:this.assigneevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.assigneevalue)):"reporter"==this.selectvalue&&(this.selectInfo.push({ziduan:this.selectvalue,value:this.reportervalue}),this.dynamicTags.push(this.selectvalue+" / "+this.reportervalue))},handleClose:function(e){var t=this.dynamicTags.indexOf(e);console.log(t),this.dynamicTags.splice(t,1),this.selectInfo.splice(t,1)},refresh:function(){var e=this;e.taskData=[];var t="http://47.102.214.37:8080/issue?page=0&size="+e.page_size;v.a.get(t).then((function(t){console.log(t.data),e.total=t.data.totalElements;for(var a=function(a){var n={};n.errorid=t.data.content[a].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=e.renderTime(t.data.content[a].createdAt),n.assigneestatus=t.data.content[a].closed?"已处理":"未处理",setTimeout((function(){for(var s=0;s<t.data.content[a].device.length;s++){var l="http://47.102.214.37:8080/device/"+t.data.content[a].device[s].id;v.a.get(l).then((function(e){n.errordevicename+=e.data.name+" / ",n.errordeviceNo+=e.data.deviceNo+" / "}))}setTimeout((function(){var s="http://47.102.214.37:8080/user/"+t.data.content[a].assignee[0].id;v.a.get(s).then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})),setTimeout((function(){if(1==t.data.content[a].assignee.length)n.assigneename="未分配";else for(var s=1;s<t.data.content[a].assignee.length;s++){var l="http://47.102.214.37:8080/user/"+t.data.content[a].assignee[s].id;v.a.get(l).then((function(e){console.log(e.data),n.assigneename+=e.data.name+" / "}))}setTimeout((function(){e.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<t.data.content.length;n++)a(n);setTimeout((function(){e.$message({message:"刷新成功",type:"success"})}),1e3)})),e.selectInfo=[],e.selectvalue="",e.selectmodel="",e.dynamicTags=[],Z.fixselectInfo=[],Z.fixdynamicTags=[]},errordetail:function(e){var t=this;console.log(t.taskData[e]),t.$router.push({path:"./errorDetail",query:t.taskData[e]})},search:function(){var e=this,t="";if(e.taskData=[],e.currentPage=1,"device"==e.selectInfo[0].ziduan||"reporter"==e.selectInfo[0].ziduan||"assignee"==e.selectInfo[0].ziduan)if(e.selectInfo[0].value.length>1){t="http://47.102.214.37:8080/issue/query?"+e.selectInfo[0].ziduan+"=I"+e.selectInfo[0].value[0];for(var a=1;a<e.selectInfo[0].value.length;a++)t=t+","+e.selectInfo[0].value[a]}else t="http://47.102.214.37:8080/issue/query?"+e.selectInfo[0].ziduan+"=="+e.selectInfo[0].value;else t="http://47.102.214.37:8080/issue/query?"+e.selectInfo[0].ziduan+"=="+e.selectInfo[0].value;if(1==e.selectInfo.length)v.a.get(t).then((function(t){if(console.log(t.data),e.total=t.data.totalElements,0==t.data.content.length)e.$message({message:"无结果",type:"warning"});else{for(var a=0;a<t.data.content.length;a++){for(var n="",s=1;s<t.data.content[a].assignee.length;s++)n=n+"id："+t.data.content[a].assignee[s].id+" / ";e.taskData.unshift({errorid:t.data.content[a].id,assigneeid:n,reporterid:"id："+t.data.content[a].reporter.id})}Z.taskselectInfo=e.selectInfo,Z.taskdynamicTags=e.dynamicTags,setTimeout((function(){e.$message({message:"查询成功",type:"success"})}),300)}}));else{console.log(e.selectInfo);for(var n=1;n<e.selectInfo.length;n++)if("name"==e.selectInfo[n].ziduan)t=t+"&"+e.selectInfo[n].ziduan+"=L"+e.selectInfo[n].value+"%25";else if("device"==e.selectInfo[n].ziduan||"ops"==e.selectInfo[n].ziduan)if(e.selectInfo[n].value.length>1){t=t+"&"+e.selectInfo[n].ziduan+"=I"+e.selectInfo[n].value[0];for(var s=1;s<e.selectInfo[n].value.length;s++)t=t+","+e.selectInfo[n].value[s]}else t=t+"&"+e.selectInfo[n].ziduan+"=="+e.selectInfo[n].value;else t=t+"&"+e.selectInfo[n].ziduan+"=="+e.selectInfo[n].value;v.a.get(t).then((function(t){console.log(t.data),e.total=t.data.totalElements,e.currentPage=1;for(var a=0;a<t.data.content.length;a++){for(var n="",s=1;s<t.data.content[a].assignee.length;s++)n=n+"id："+t.data.content[a].assignee[s].id+" / ";e.taskData.unshift({errorid:t.data.content[a].id,assigneeid:n,reporterid:"id："+t.data.content[a].reporter.id})}Z.fixselectInfo=e.selectInfo,Z.fixdynamicTags=e.dynamicTags,setTimeout((function(){e.$message({message:"查询成功",type:"success"})}),300)}))}},handleSizeChange:function(e){var t=this;t.taskData=[],console.log(e),t.page_size=e,t.currentPage=1;var a="http://47.102.214.37:8080/issue?page=0&size="+t.page_size;console.log(a),v.a.get(a).then((function(e){console.log(e.data);for(var a=0;a<e.data.content.length;a++){for(var n="",s=1;s<e.data.content[a].assignee.length;s++)n=n+"id："+e.data.content[a].assignee[s].id+" / ";t.taskData.unshift({errorid:e.data.content[a].id,assigneeid:n,reporterid:"id："+e.data.content[a].reporter.id})}setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),300)}))},handleCurrentChange:function(e){var t=this;t.page=e,t.currentPage=e,console.log(e);var a="http://47.102.214.37:8080/issue?page="+(t.page-1)+"&size="+t.page_size;console.log(a),v.a.get(a).then((function(e){console.log(e.data),t.taskData=[];for(var a=0;a<e.data.content.length;a++){for(var n="",s=1;s<e.data.content[a].assignee.length;s++)n=n+"id："+e.data.content[a].assignee[s].id+" / ";t.taskData.unshift({errorid:e.data.content[a].id,assigneeid:n,reporterid:"id："+e.data.content[a].reporter.id})}setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),300)}))}}}),bt=gt,Tt=(a("c2e6"),Object(c["a"])(bt,vt,ht,!1,null,null,null)),yt=Tt.exports,kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-ErrorDetail"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("报修流水号："+e._s(e.errorid)+" ")])],1),a("div",{staticClass:"Task-container"},[a("div",{staticClass:"Step"},[a("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"申请",description:e.applytime}}),a("el-step",{attrs:{title:"分配",description:e.assigntime}}),a("el-step",{attrs:{title:"修复",description:e.fixtime}}),a("el-step",{attrs:{title:"完成",description:e.completetime}})],1)],1),a("div",{staticClass:"Task-info"},[e._m(0),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报修流水号")]),a("div",{staticClass:"Info"},[e._v(e._s(e.errorid))])]),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报修人员")]),e._l(e.applyusers,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail}})}))],2)]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("异常描述和异常处理请求")]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.errorcontent)}})])])])]),a("div",{staticClass:"Task-info"},[e._m(1),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("维修人员-Supervisor")]),e._l(e.supervisor,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail}})}))],2),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("维修人员-Operator")]),e._l(e.operator,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail}})}))],2)]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("报修设备")]),a("el-table",{staticClass:"extraTable",staticStyle:{"margin-top":"10px",width:"100%"},attrs:{data:e.devicetableData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"设备ID"}}),a("el-table-column",{attrs:{prop:"name",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"brand",label:"设备品牌"}}),a("el-table-column",{attrs:{prop:"deviceNo",label:"设备编号"}}),a("el-table-column",{attrs:{prop:"clazz",label:"设备分类"}})],1)],1)]),"SUPERVISOR"==e.userRole&&0==e.assigned?a("div",{staticClass:"Part lastpart TssignFixBtn"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("分配申请")]),a("el-button",{on:{click:e.TssignFix}},[e._v("分配此申请")])],1)]):e._e()]),e.assigned&&e.opstofix&&!e.closed?a("div",{staticClass:"Task-info Last"},[e._m(2),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("异常类型")]),a("el-input",{attrs:{type:"text",placeholder:"异常类型"},model:{value:e.exceptionType,callback:function(t){e.exceptionType=t},expression:"exceptionType"}})],1),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("发生原因")]),a("el-input",{attrs:{type:"text",placeholder:"发生原因"},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}})],1)]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part result",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text "},[e._v("异常解决措施和处理结果")]),a("quill-editor",{ref:"myTextEditor",staticStyle:{height:"70%","margin-top":"5px",width:"100%"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.solution,callback:function(t){e.solution=t},expression:"solution"}})],1)]),"OPERATOR"!=e.userRole||e.closed?e._e():a("div",{staticClass:"Part lastpart TssignFixBtn"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("提交诊断")]),a("el-button",{on:{click:e.submitbtn}},[e._v("提交诊断")])],1)])]):e._e(),e.assigned&&!e.opstofix||e.assigned&&e.closed?a("div",{staticClass:"Task-info Last"},[e._m(3),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("异常类型")]),a("div",{staticClass:"Info"},[e._v(e._s(e.exceptionType))])]),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("发生原因")]),a("div",{staticClass:"Info"},[e._v(e._s(e.reason))])])]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text "},[e._v("异常解决措施和处理结果")]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.solution)}})])])])]):e._e()]),a("el-dialog",{attrs:{title:"选择维修人",visible:e.dialogFixVisible},on:{"update:visible":function(t){e.dialogFixVisible=t}}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.assigneeOp,callback:function(t){e.assigneeOp=t},expression:"assigneeOp"}},e._l(e.options,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)})),1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFixVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitTssign}},[e._v("确 定")])],1)],1)],1)},xt=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 申请 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 分配 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 修复 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 修复 ")])])])}],Ct={created:function(){var e=this,t=this;t.active=0,console.log(t.$route.query),t.errorid=t.$route.query.errorid,v.a.get("http://47.102.214.37:8080/user/me").then((function(t){console.log(t.data),e.userid=t.data.id,e.userRole=t.data.role}));var a="http://47.102.214.37:8080/issue/"+t.$route.query.errorid;v.a.get(a).then((function(a){console.log(a.data),t.reporterid=a.data.reporter.id,t.errorcontent=a.data.content,t.reason=a.data.reason,t.solution=a.data.solution,t.exceptionType=a.data.exceptionType,t.closed=a.data.closed,t.applytime=t.renderTime(a.data.createdAt),t.assigntime=t.renderTime(a.data.assignedAt),t.fixtime=t.renderTime(a.data.fixedAt),t.completetime=t.renderTime(a.data.closedAt);for(var n={fixusersid:[]},s=0;s<a.data.assignee.length;s++)n.fixusersid.push({assigneeid:a.data.assignee[s].id});n.applyusersid=a.data.reporter.id,setTimeout((function(){var a="http://47.102.214.37:8080/user/query?id=="+n.applyusersid;if(v.a.get(a).then((function(e){t.applyusers.push({name:e.data.content[0].name,username:e.data.content[0].username,useremail:e.data.content[0].email})})),void 0!=n.fixusersid){var s="http://47.102.214.37:8080/user/query?id=="+n.fixusersid[0].assigneeid;if(v.a.get(s).then((function(e){console.log(e.data),t.supervisor.push({name:e.data.content[0].name,username:e.data.content[0].username,useremail:e.data.content[0].email})})),1==n.fixusersid.length)t.operator.push({name:"暂未分配",username:"暂未分配",useremail:"暂未分配"});else{t.assigned=!0;for(var l=1;l<n.fixusersid.length;l++){n.fixusersid[l].assigneeid==e.userid&&(t.opstofix=!0);var o="http://47.102.214.37:8080/user/query?id=="+n.fixusersid[l].assigneeid;v.a.get(o).then((function(e){t.operator.push({name:e.data.content[0].name,username:e.data.content[0].username,useremail:e.data.content[0].email})}))}}}}),200);for(var l=0;l<a.data.device.length;l++){var o="http://47.102.214.37:8080/device/"+a.data.device[l].id;v.a.get(o).then((function(e){var a={};a.id=e.data.id,a.name=e.data.name,a.brand=e.data.brand,a.deviceNo=e.data.deviceNo,a.clazz=e.data.clazz,t.devicetableData.push(a)}))}})),setTimeout((function(){v.a.get("http://47.102.214.37:8080/user/query").then((function(e){for(var a=0;a<e.data.content.length;a++)"OPERATOR"==e.data.content[a].role&&t.options[0].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"})}))}),300)},data:function(){return{userid:"",userRole:"",reporterid:"",assigned:!1,opstofix:!1,active:0,closed:!1,errorid:"",applyusers:[],errorcontent:"",fixusers:[],assigneeid:"",supervisor:[],operator:[],devicetableData:[],deviceinfo:[],dialogFixVisible:!1,assigneeOp:"",options:[{label:"OPERATOR",options:[]}],reason:"",solution:"",exceptionType:"",editorOption:{placeholder:"请输入保养内容"},applytime:"",assigntime:"",fixtime:"",completetime:""}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return this.active++,new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},TssignFix:function(){this.dialogFixVisible=!0},onEditorChange:function(e){var t=e.html;console.log(t),this.result=t},submitTssign:function(){console.log(this.assigneeOp);var e=this,t="http://47.102.214.37:8080/issue/"+e.errorid;v.a.get(t).then((function(a){console.log(a.data);var n={};n.assignee=a.data.assignee,n.closed=a.data.closed,n.content=a.data.content,n.descriptionPic=a.data.descriptionPic,n.device=a.data.device,n.exceptionType=a.data.exceptionType,n.id=a.data.id,n.reason=a.data.reason,n.record=a.data.record,n.reporter=a.data.reporter,n.solution=a.data.solution,n.assignee.push({id:e.assigneeOp}),v.a.put(t,n).then((function(t){console.log(t),e.$message({message:"分配成功",type:"success"}),e.dialogFixVisible=!1,setTimeout((function(){location.reload()}),300)})).catch((function(){e.$message({message:"分配失败",type:"error"})}))}))},submitbtn:function(){var e=this,t={},a="http://47.102.214.37:8080/issue/"+e.errorid;v.a.get(a).then((function(a){console.log(a.data),t.assignee=a.data.assignee,t.closed=a.data.closed,t.content=a.data.content,t.descriptionPic=a.data.descriptionPic,t.device=a.data.device,t.exceptionType=e.exceptionType,t.id=a.data.id,t.reason=e.reason,t.record=a.data.record,t.reporter=a.data.reporter,t.solution=e.solution})),setTimeout((function(){console.log(t),v.a.put(a,t).then((function(t){console.log(t),e.$message({message:"提交成功",type:"success"}),setTimeout((function(){location.reload()}),300)}))}),200)}},components:{User:Me["a"],quillEditor:ke["quillEditor"]}},_t=Ct,It=(a("0c15"),Object(c["a"])(_t,kt,xt,!1,null,null,null)),Dt=It.exports,wt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-FixDiagnosis"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("分配到我的")])],1),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"errorid",label:"报修流水号",width:"200"}}),a("el-table-column",{attrs:{prop:"assigneeid",label:"维修人员"}}),a("el-table-column",{attrs:{prop:"reporterid",label:"报修人员"}}),a("el-table-column",{attrs:{prop:"setting",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.errordetail(t.$index)}}},[e._v("查看详情")])]}}])})],1)],1)},$t=[],zt={created:function(){this.refresh()},data:function(){return{taskData:[]}},methods:{refresh:function(){var e=this;e.taskData=[],v.a.get("http://47.102.214.37:8080/issue/assignee?page=0&size=10").then((function(t){console.log(t.data);for(var a=0;a<t.data.content.length;a++){for(var n="",s=1;s<t.data.content[a].assignee.length;s++)n=n+"id："+t.data.content[a].assignee[s].id+" / ";e.taskData.unshift({errorid:t.data.content[a].id,assigneeid:n,reporterid:"id："+t.data.content[a].reporter.id})}e.$message({message:"刷新成功",type:"success"})}))},errordetail:function(e){var t=this;console.log(t.taskData[e]),t.$router.push({path:"./errorDetail",query:t.taskData[e]})}}},St=zt,Et=(a("99ae"),Object(c["a"])(St,wt,$t,!1,null,null,null)),Rt=Et.exports,Pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-FixDiagnosis"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("分配到我的")])],1),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"errorid",label:"报修流水号",width:"200"}}),a("el-table-column",{attrs:{prop:"assigneeid",label:"维修人员"}}),a("el-table-column",{attrs:{prop:"reporterid",label:"报修人员"}}),a("el-table-column",{attrs:{prop:"setting",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.errordetail(t.$index)}}},[e._v("查看详情")])]}}])})],1)],1)},At=[],Ot={created:function(){this.refresh()},data:function(){return{taskData:[]}},methods:{refresh:function(){var e=this;e.taskData=[],v.a.get("http://47.102.214.37:8080/issue/assignee?page=0&size=10").then((function(t){console.log(t.data);for(var a=0;a<t.data.content.length;a++){for(var n="",s=1;s<t.data.content[a].assignee.length;s++)n=n+"id："+t.data.content[a].assignee[s].id+" / ";e.taskData.unshift({errorid:t.data.content[a].id,assigneeid:n,reporterid:"id："+t.data.content[a].reporter.id})}e.$message({message:"刷新成功",type:"success"})}))},errordetail:function(e){var t=this;console.log(t.taskData[e]),t.$router.push({path:"./errorDetail",query:t.taskData[e]})}}},qt=Ot,Nt=(a("9b48"),Object(c["a"])(qt,Pt,At,!1,null,null,null)),Bt=Nt.exports,Lt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-FixDiagnosis"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("我发布的")])],1),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"errorid",label:"报修流水号",width:"200"}}),a("el-table-column",{attrs:{prop:"errordevicename",label:"故障设备名称",width:"200"}}),a("el-table-column",{attrs:{prop:"errordeviceNo",label:"故障设备编号",width:"200"}}),a("el-table-column",{attrs:{prop:"reportername",label:"报修人员",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"reportertime",label:"报修时间",width:"180"}}),a("el-table-column",{attrs:{prop:"assigneename",label:"维修人员",width:"180"}}),a("el-table-column",{attrs:{prop:"assigneestatus",label:"维修状态",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.errordetail(t.$index)}}},[e._v("查看详情")]),a("el-button",{on:{click:function(a){return e.reverterror(t.$index)}}},[e._v("撤销")])]}}])})],1),a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},Mt=[],Ft={created:function(){this.refresh()},data:function(){return{taskData:[],tablewidth:"150",currentPage:1,page_size:5,page:1,size:5,total:0}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return this.active++,new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},refresh:function(){var e=this;e.taskData=[];var t="http://47.102.214.37:8080/issue/reporter?page=0&size="+e.page_size;v.a.get(t).then((function(t){console.log(t.data),e.total=t.data.totalElements;for(var a=function(a){var n={};n.errorid=t.data.content[a].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=e.renderTime(t.data.content[a].createdAt),n.assigneestatus=t.data.content[a].closed?"已处理":"未处理",setTimeout((function(){for(var s=0;s<t.data.content[a].device.length;s++){var l="http://47.102.214.37:8080/device/"+t.data.content[a].device[s].id;v.a.get(l).then((function(e){n.errordevicename+=e.data.name+" / ",n.errordeviceNo+=e.data.deviceNo+" / "}))}setTimeout((function(){var s="http://47.102.214.37:8080/user/"+t.data.content[a].assignee[0].id;v.a.get(s).then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})),setTimeout((function(){if(1==t.data.content[a].assignee.length)n.assigneename="未分配";else for(var s=1;s<t.data.content[a].assignee.length;s++){var l="http://47.102.214.37:8080/user/"+t.data.content[a].assignee[s].id;v.a.get(l).then((function(e){console.log(e.data),n.assigneename+=e.data.name+" / "}))}setTimeout((function(){e.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<t.data.content.length;n++)a(n);setTimeout((function(){e.$message({message:"刷新成功",type:"success"})}),1e3)}))},errordetail:function(e){var t=this;console.log(t.taskData[e]),t.$router.push({path:"./mySubmitDetail",query:t.taskData[e]})},reverterror:function(e){var t=this;console.log(t.taskData[e]),this.$confirm("确定撤销此报修申请吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a="http://47.102.214.37:8080/issue/revert/"+t.taskData[e].errorid;v.a.post(a).then((function(){t.$message({message:"撤销成功",type:"success"}),t.refresh()})).catch((function(){t.$message({message:"撤销失败",type:"error"})}))}))},handleSizeChange:function(e){var t=this;t.taskData=[],console.log(e),t.size=e,t.page_size=e;var a="http://47.102.214.37:8080/issue/reporter?page=0&size="+t.size;console.log(a),v.a.get(a).then((function(e){console.log(e.data),t.total=e.data.totalElements;for(var a=function(a){var n={};n.errorid=e.data.content[a].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=t.renderTime(e.data.content[a].createdAt),n.assigneestatus=e.data.content[a].closed?"已处理":"未处理",setTimeout((function(){for(var s=0;s<e.data.content[a].device.length;s++){var l="http://47.102.214.37:8080/device/"+e.data.content[a].device[s].id;v.a.get(l).then((function(e){n.errordevicename+=e.data.name+" / ",n.errordeviceNo+=e.data.deviceNo+" / "}))}setTimeout((function(){var s="http://47.102.214.37:8080/user/"+e.data.content[a].assignee[0].id;v.a.get(s).then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})),setTimeout((function(){if(1==e.data.content[a].assignee.length)n.assigneename="未分配";else for(var s=1;s<e.data.content[a].assignee.length;s++){var l="http://47.102.214.37:8080/user/"+e.data.content[a].assignee[s].id;v.a.get(l).then((function(e){console.log(e.data),n.assigneename+=e.data.name+" / "}))}setTimeout((function(){t.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<e.data.content.length;n++)a(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),1e3)}))},handleCurrentChange:function(e){var t=this;t.page=e,t.currentPage=e,console.log(e);var a="http://47.102.214.37:8080/issue/reporter?page="+(t.page-1)+"&size="+t.size;console.log(a),v.a.get(a).then((function(e){console.log(e.data),t.total=e.data.totalElements;for(var a=function(a){var n={};n.errorid=e.data.content[a].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=t.renderTime(e.data.content[a].createdAt),n.assigneestatus=e.data.content[a].closed?"已处理":"未处理",setTimeout((function(){for(var s=0;s<e.data.content[a].device.length;s++){var l="http://47.102.214.37:8080/device/"+e.data.content[a].device[s].id;v.a.get(l).then((function(e){n.errordevicename+=e.data.name+" / ",n.errordeviceNo+=e.data.deviceNo+" / "}))}setTimeout((function(){var s="http://47.102.214.37:8080/user/"+e.data.content[a].assignee[0].id;v.a.get(s).then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})),setTimeout((function(){if(1==e.data.content[a].assignee.length)n.assigneename="未分配";else for(var s=1;s<e.data.content[a].assignee.length;s++){var l="http://47.102.214.37:8080/user/"+e.data.content[a].assignee[s].id;v.a.get(l).then((function(e){console.log(e.data),n.assigneename+=e.data.name+" / "}))}setTimeout((function(){t.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<e.data.content.length;n++)a(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),1e3)}))}}},Vt=Ft,Ut=(a("945e"),Object(c["a"])(Vt,Lt,Mt,!1,null,null,null)),jt=Ut.exports,Wt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-MySubmitDetail"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("报修流水号："+e._s(e.errorid)+" ")])],1),a("div",{staticClass:"Task-container"},[a("div",{staticClass:"Step"},[a("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"申请",description:e.applytime}}),a("el-step",{attrs:{title:"分配",description:e.assigntime}}),a("el-step",{attrs:{title:"修复",description:e.fixtime}}),a("el-step",{attrs:{title:"完成",description:e.completetime}})],1)],1),a("div",{staticClass:"Task-info"},[e._m(0),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报修流水号")]),a("div",{staticClass:"Info"},[e._v(e._s(e.errorid))])]),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报修人员")]),e._l(e.applyusers,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail}})}))],2)]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("异常描述和异常处理请求")]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.errorcontent)}})])])])]),a("div",{staticClass:"Task-info"},[e._m(1),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("维修人员-Supervisor")]),e._l(e.supervisor,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail}})}))],2),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("维修人员-Operator")]),e._l(e.operator,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail}})}))],2)]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("报修设备")]),a("el-table",{staticClass:"extraTable",staticStyle:{"margin-top":"10px",width:"100%"},attrs:{data:e.devicetableData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"设备ID"}}),a("el-table-column",{attrs:{prop:"name",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"brand",label:"设备品牌"}}),a("el-table-column",{attrs:{prop:"deviceNo",label:"设备编号"}}),a("el-table-column",{attrs:{prop:"clazz",label:"设备分类"}})],1)],1)])]),a("div",{staticClass:"Task-info Last"},[e._m(2),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("异常类型")]),a("div",{staticClass:"Info"},[e._v(e._s(e.exceptionType))])]),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("发生原因")]),a("div",{staticClass:"Info"},[e._v(e._s(e.reason))])])]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("异常解决措施和处理结果")]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.solution)}})])])])]),e.reporterid!=e.userid||e.closed?e._e():a("div",{staticClass:"Task-info Last"},[e._m(3),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text "},[e._v("接受维修处理")]),a("div",{staticClass:"backbtn_right"},[a("el-button",{staticClass:"confirm",on:{click:e.confirm}},[e._v("确认")]),a("el-button",{staticClass:"refuse",on:{click:e.refuse}},[e._v("拒绝")])],1)])])])])],1)},Yt=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 申请 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 分配 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 修复 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 完成 ")])])])}],Ht={created:function(){var e=this,t=this;t.active=0,console.log(t.$route.query),t.errorid=t.$route.query.errorid,v.a.get("http://47.102.214.37:8080/user/me").then((function(t){console.log(t.data),e.userid=t.data.id}));var a="http://47.102.214.37:8080/issue/"+t.$route.query.errorid;v.a.get(a).then((function(e){console.log(e.data),t.reporterid=e.data.reporter.id,t.errorcontent=e.data.content,t.errordescription=e.data.descriptionPic,t.reason=e.data.reason,t.solution=e.data.solution,t.exceptionType=e.data.exceptionType,t.closed=e.data.closed,t.applytime=t.renderTime(e.data.createdAt),t.assigntime=t.renderTime(e.data.assignedAt),t.fixtime=t.renderTime(e.data.fixedAt),t.completetime=t.renderTime(e.data.closedAt);for(var a={fixusersid:[]},n=0;n<e.data.assignee.length;n++)a.fixusersid.push({assigneeid:e.data.assignee[n].id});a.applyusersid=e.data.reporter.id,setTimeout((function(){var e="http://47.102.214.37:8080/user/query?id=="+a.applyusersid;if(v.a.get(e).then((function(e){t.applyusers.push({name:e.data.content[0].name,username:e.data.content[0].username,useremail:e.data.content[0].email})})),void 0!=a.fixusersid){var n="http://47.102.214.37:8080/user/query?id=="+a.fixusersid[0].assigneeid;if(v.a.get(n).then((function(e){console.log(e.data),t.supervisor.push({name:e.data.content[0].name,username:e.data.content[0].username,useremail:e.data.content[0].email})})),1==a.fixusersid.length)t.operator.push({name:"暂未分配",username:"暂未分配",useremail:"暂未分配"});else for(var s=1;s<a.fixusersid.length;s++){var l="http://47.102.214.37:8080/user/query?id=="+a.fixusersid[s].assigneeid;v.a.get(l).then((function(e){t.operator.push({name:e.data.content[0].name,username:e.data.content[0].username,useremail:e.data.content[0].email})}))}}}),200);for(var s=0;s<e.data.device.length;s++){var l="http://47.102.214.37:8080/device/"+e.data.device[s].id;v.a.get(l).then((function(e){var a={};a.id=e.data.id,a.name=e.data.name,a.brand=e.data.brand,a.deviceNo=e.data.deviceNo,a.clazz=e.data.clazz,t.devicetableData.push(a)}))}}))},data:function(){return{userid:"",reporterid:"",active:0,closed:!1,errorid:"",applyusers:[],errorcontent:"",fixusers:[],assigneeid:"",supervisor:[],operator:[],devicetableData:[],deviceinfo:[],reason:"",solution:"",exceptionType:"",applytime:"",assigntime:"",fixtime:"",completetime:""}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return this.active++,new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},confirm:function(){var e=this,t=this;t.$confirm("确定接受处理吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e="http://47.102.214.37:8080/issue/close/"+t.$route.query.errorid+"?closed=true";v.a.post(e).then((function(e){console.log(e.data),t.$message({message:"接受处理成功",type:"success"}),setTimeout((function(){location.reload()}),300)}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},refuse:function(){var e=this,t=this;t.$confirm("确定拒绝处理吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e="http://47.102.214.37:8080/issue/close/"+t.$route.query.errorid+"?closed=false";v.a.post(e).then((function(e){console.log(e.data),t.$message({message:"拒绝处理成功",type:"success"}),setTimeout((function(){location.reload()}),300)}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},imgurl:function(e){this.dialogImageUrl=e,this.dialogVisible=!0}},components:{User:Me["a"]}},Jt=Ht,Gt=(a("a5c0"),Object(c["a"])(Jt,Wt,Yt,!1,null,null,null)),Zt=Gt.exports,Kt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-DailyRecord"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("数据分析")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("使用日志")])],1),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表")])],1),a("div",{staticClass:"Result"},[a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.LogData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"logid",label:"日志编号",width:"200"}}),a("el-table-column",{attrs:{prop:"logtime",label:"操作时间"}}),a("el-table-column",{attrs:{prop:"logcontent",label:"操作内容"}}),a("el-table-column",{attrs:{prop:"loguser",label:"操作人员"}})],1),a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[5,10,15],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},Qt=[],Xt={components:{},created:function(){var e=this;e.refresh()},data:function(){return{LogData:[],currentPage:1,page_size:5,page:1,total:0}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return this.active++,new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},refresh:function(){var e=this;e.LogData=[],e.currentPage=1;var t="http://47.102.214.37:8080/logging?page=0&size="+e.page_size;v.a.get(t).then((function(t){console.log(t.data),e.total=t.data.totalElements;for(var a=function(a){var n={};n.logid=t.data.content[a].id,n.logcontent=t.data.content[a].opName,n.logtime=e.renderTime(t.data.content[a].createdAt),setTimeout((function(){var s="http://47.102.214.37:8080/user/"+t.data.content[a].operator.id;v.a.get(s).then((function(e){console.log(e.data),n.loguser=e.data.name})).catch((function(){n.loguser="获取失败"})),setTimeout((function(){e.LogData.unshift(n)}),300)}),300)},n=0;n<t.data.content.length;n++)a(n);setTimeout((function(){e.$message({message:"刷新成功",type:"success"})}),300)}))},handleSizeChange:function(e){var t=this;t.LogData=[],t.currentPage=1,console.log(e),t.page_size=e;var a="http://47.102.214.37:8080/logging?page=0&size="+t.page_size;console.log(a),v.a.get(a).then((function(e){console.log(e.data),t.total=e.data.totalElements;for(var a=function(a){var n={};n.logid=e.data.content[a].id,n.logcontent=e.data.content[a].opName,n.logtime=t.renderTime(e.data.content[a].createdAt),setTimeout((function(){var s="http://47.102.214.37:8080/user/"+e.data.content[a].operator.id;v.a.get(s).then((function(e){console.log(e.data),n.loguser=e.data.name})).catch((function(){n.loguser="获取失败"})),setTimeout((function(){t.LogData.unshift(n)}),300)}),300)},n=0;n<e.data.content.length;n++)a(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),300)}))},handleCurrentChange:function(e){var t=this;t.LogData=[],t.page=e,t.currentPage=e;var a="http://47.102.214.37:8080/logging?page="+(t.page-1)+"&size="+t.page_size;console.log(a),v.a.get(a).then((function(e){console.log(e.data),t.total=e.data.totalElements;for(var a=function(a){var n={};n.logid=e.data.content[a].id,n.logcontent=e.data.content[a].opName,n.logtime=t.renderTime(e.data.content[a].createdAt),setTimeout((function(){var s="http://47.102.214.37:8080/user/"+e.data.content[a].operator.id;v.a.get(s).then((function(e){console.log(e.data),n.loguser=e.data.name})).catch((function(){n.loguser="获取失败"})),setTimeout((function(){t.LogData.unshift(n)}),300)}),300)},n=0;n<e.data.content.length;n++)a(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),300)}))}}},ea=Xt,ta=(a("8ed7"),Object(c["a"])(ea,Kt,Qt,!1,null,null,null)),aa=ta.exports,na=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-FixAnalysis"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("数据分析")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("维修分析")])],1),a("div",{staticClass:"Search"},[a("div",{staticClass:"searchtask"},[a("el-select",{attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.selectchange},model:{value:e.selectvalue,callback:function(t){e.selectvalue=t},expression:"selectvalue"}},e._l(e.selectoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1),a("div",e._l(e.dynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("div",{staticClass:"searchpart"},[a("div",[a("el-date-picker",{attrs:{type:"date",placeholder:"开始日期","value-format":"yyyy-MM-dd"},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-button",{on:{click:e.search}},[e._v("查询")])],1)])]),a("div",{staticClass:"Result"},[a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.deviceAnalysisData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"deviceid",label:"设备编号",width:"100"}}),a("el-table-column",{attrs:{prop:"unhealthyTime",label:"设备故障总时间（分钟）"}}),a("el-table-column",{attrs:{prop:"issueCount",label:"设备故障数"}}),a("el-table-column",{attrs:{prop:"avgFixPeriod",label:"设备平均维修耗时（分钟）"}}),a("el-table-column",{attrs:{prop:"avgIssuePeriod",label:"设备平均故障周期（分钟）"}})],1)],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.selectmodel,callback:function(t){e.selectmodel=t},expression:"selectmodel"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitselect}},[e._v("确 定")])],1)],1)],1)},sa=[],la={components:{},created:function(){var e=this;0!=Z.fixAnalysisInfo.length&&(e.selectInfo=Z.fixAnalysisInfo,e.dynamicTags=Z.fixAnalysisdynamicTags),v.a.get("http://47.102.214.37:8080/device/info-field").then((function(t){for(var a=0;a<t.data.length;a++)e.selectoptions[1].options.push({value:t.data[a].id,label:t.data[a].name})}))},data:function(){return{selectoptions:[{label:"基本字段",options:[{value:"name",label:"设备名称"},{value:"brand",label:"设备品牌"},{value:"type",label:"设备型号/规格"},{value:"deviceNo",label:"设备编号"},{value:"crux",label:"是否为关键设备"},{value:"clazz",label:"设备分类"}]},{label:"附加字段",options:[]},{label:"全部维修",options:[{value:"all",label:"全部维修设备分析"}]}],ifall:!1,selectvalue:"",selectmodel:"",dialogSearchVisible:!1,selectInfo:[],dynamicTags:[],device:[],startDate:"",endDate:"",deviceAnalysisData:[],avgFixPeriodTotal:0,avgIssuePeriodTotal:0,unhealthyTimeTotal:0,issueCountTotal:0}},methods:{selectchange:function(e){var t=this;t.ifall=!1,"all"==e?(t.ifall=!0,t.device=[],v.a.get("http://47.102.214.37:8080/device/query?name=! ").then((function(e){var a=0;for(console.log(e.data),a=0;a<e.data.content.length;a++)t.device.push(e.data.content[a].id);a==e.data.content.length&&(console.log(t.device),t.selectInfo=[],t.dynamicTags=[],Z.fixAnalysisInfo=[],Z.fixAnalysisdynamicTags=[])}))):this.dialogSearchVisible=!0},submitselect:function(){this.dialogSearchVisible=!1,this.selectInfo.push({ziduan:this.selectvalue,value:this.selectmodel}),this.dynamicTags.push(this.selectvalue+" / "+this.selectmodel)},handleClose:function(e){var t=this.dynamicTags.indexOf(e);console.log(t),this.dynamicTags.splice(t,1),this.selectInfo.splice(t,1)},search:function(){var e=this;if(e.avgFixPeriodTotal=0,e.avgIssuePeriodTotal=0,e.unhealthyTimeTotal=0,e.issueCountTotal=0,e.deviceAnalysisData=[],e.ifall)if(""==e.startDate||""==e.endDate||null==e.startDate||null==e.endDate)e.$message({message:"请输入将查询信息填写完整",type:"warning"});else if(new Date(this.startDate).getTime()>=new Date(this.endDate).getTime())e.$message({message:"结束时间必须大于开始时间",type:"warning"});else if(new Date(this.endDate).getTime()>(new Date).getTime())e.$message({message:"结束时间必须小于今天",type:"warning"});else{var t=0,a="http://47.102.214.37:8080/analysis/device?did="+e.device[0];for(t=1;t<e.device.length;t++)a=a+","+e.device[t];t==e.device.length&&(console.log(t),a=a+"&start="+e.startDate+"&end="+e.endDate,console.log(a)),v.a.get(a).then((function(t){console.log(t);var a=0;for(a=0;a<e.device.length;a++){var n={};n.deviceid=e.device[a],n.avgFixPeriod=t.data[e.device[a]].avgFixPeriod,e.avgFixPeriodTotal+=t.data[e.device[a]].avgFixPeriod,n.avgIssuePeriod=t.data[e.device[a]].avgIssuePeriod,e.avgIssuePeriodTotal+=t.data[e.device[a]].avgIssuePeriod,n.unhealthyTime=t.data[e.device[a]].unhealthyTime,e.unhealthyTimeTotal+=t.data[e.device[a]].unhealthyTime,n.issueCount=t.data[e.device[a]].issueCount,e.issueCountTotal+=t.data[e.device[a]].issueCount,console.log(n),e.deviceAnalysisData.push(n)}if(a==e.device.length){console.log(e.avgFixPeriodTotal);var s={deviceid:"总计"};s.avgFixPeriod=e.avgFixPeriodTotal,s.avgIssuePeriod=e.avgIssuePeriodTotal,s.unhealthyTime=e.unhealthyTimeTotal,s.issueCount=e.issueCountTotal,console.log(s),e.deviceAnalysisData.unshift(s)}})),setTimeout((function(){e.$message({message:"查询成功",type:"success"})}),300)}else if(0==e.selectInfo.length||""==e.startDate||""==e.endDate||null==e.startDate||null==e.endDate)e.$message({message:"请输入将查询信息填写完整",type:"warning"});else if(new Date(this.startDate).getTime()>=new Date(this.endDate).getTime())e.$message({message:"结束时间必须大于开始时间",type:"warning"});else if(new Date(this.endDate).getTime()>(new Date).getTime())e.$message({message:"结束时间必须小于今天",type:"warning"});else{e.device=[];var n="http://47.102.214.37:8080/device/query?"+e.selectInfo[0].ziduan+"=L"+e.selectInfo[0].value+"%25",s="http://47.102.214.37:8080/device/export?"+e.selectInfo[0].ziduan+"=L"+e.selectInfo[0].value+"%25";if(1==e.selectInfo.length)console.log(n),v.a.get(n).then((function(t){if(0==t.data.content.length)e.$message({message:"无结果",type:"warning"});else{console.log(t.data);for(var a=0;a<t.data.content.length;a++)e.device.push(t.data.content[a].id);if(e.device.length<=1){var n="http://47.102.214.37:8080/analysis/device?did="+e.device[0]+"&start="+e.startDate+"&end="+e.endDate;v.a.get(n).then((function(t){console.log(t.data);var a={};a.deviceid=e.device[0],a.avgFixPeriod=t.data[e.device[0]].avgFixPeriod,a.avgIssuePeriod=t.data[e.device[0]].avgIssuePeriod,a.unhealthyTime=t.data[e.device[0]].unhealthyTime,a.issueCount=t.data[e.device[0]].issueCount,console.log(a),e.deviceAnalysisData.push(a)}))}else{var s=0,l="http://47.102.214.37:8080/analysis/device?did="+e.device[0];for(s=1;s<e.device.length;s++)l=l+","+e.device[s];s==e.device.length&&(console.log(s),l=l+"&start="+e.startDate+"&end="+e.endDate,console.log(l)),v.a.get(l).then((function(t){console.log(t);var a=0;for(a=0;a<e.device.length;a++){var n={};n.deviceid=e.device[a],n.avgFixPeriod=t.data[e.device[a]].avgFixPeriod,e.avgFixPeriodTotal+=t.data[e.device[a]].avgFixPeriod,n.avgIssuePeriod=t.data[e.device[a]].avgIssuePeriod,e.avgIssuePeriodTotal+=t.data[e.device[a]].avgIssuePeriod,n.unhealthyTime=t.data[e.device[a]].unhealthyTime,e.unhealthyTimeTotal+=t.data[e.device[a]].unhealthyTime,n.issueCount=t.data[e.device[a]].issueCount,e.issueCountTotal+=t.data[e.device[a]].issueCount,console.log(n),e.deviceAnalysisData.push(n)}if(a==e.device.length){console.log(e.avgFixPeriodTotal);var s={deviceid:"总计"};s.avgFixPeriod=e.avgFixPeriodTotal,s.avgIssuePeriod=e.avgIssuePeriodTotal,s.unhealthyTime=e.unhealthyTimeTotal,s.issueCount=e.issueCountTotal,console.log(s),e.deviceAnalysisData.unshift(s)}}))}Z.fixAnalysisInfo=e.selectInfo,Z.fixAnalysisdynamicTags=e.dynamicTags,setTimeout((function(){e.$message({message:"查询成功",type:"success"})}),300)}}));else{for(var l=1;l<e.selectInfo.length;l++)n=n+"&"+e.selectInfo[l].ziduan+"=L"+e.selectInfo[l].value+"%25",s=s+"&"+e.selectInfo[l].ziduan+"=L"+e.selectInfo[l].value+"%25";console.log(n),v.a.get(n).then((function(t){if(0==t.data.content.length)e.$message({message:"无结果",type:"warning"});else{console.log(t.data);for(var a=0;a<t.data.content.length;a++)e.device.push(t.data.content[a].id);if(e.device.length<=1){var n="http://47.102.214.37:8080/analysis/device?did="+e.device[0]+"&start="+e.startDate+"&end="+e.endDate;v.a.get(n).then((function(t){console.log(t.data);var a={};a.deviceid=e.device[0],a.avgFixPeriod=t.data[e.device[0]].avgFixPeriod,a.avgIssuePeriod=t.data[e.device[0]].avgIssuePeriod,a.unhealthyTime=t.data[e.device[0]].unhealthyTime,a.issueCount=t.data[e.device[0]].issueCount,console.log(a),e.deviceAnalysisData.push(a)}))}else{var s=0,l="http://47.102.214.37:8080/analysis/device?did="+e.device[0];for(s=1;s<e.device.length;s++)l=l+","+e.device[s];s==e.device.length&&(console.log(s),l=l+"&start="+e.startDate+"&end="+e.endDate,console.log(l)),v.a.get(l).then((function(t){console.log(t);var a=0;for(a=0;a<e.device.length;a++){var n={};n.deviceid=e.device[a],n.avgFixPeriod=t.data[e.device[a]].avgFixPeriod,e.avgFixPeriodTotal+=t.data[e.device[a]].avgFixPeriod,n.avgIssuePeriod=t.data[e.device[a]].avgIssuePeriod,e.avgIssuePeriodTotal+=t.data[e.device[a]].avgIssuePeriod,n.unhealthyTime=t.data[e.device[a]].unhealthyTime,e.unhealthyTimeTotal+=t.data[e.device[a]].unhealthyTime,n.issueCount=t.data[e.device[a]].issueCount,e.issueCountTotal+=t.data[e.device[a]].issueCount,console.log(n),e.deviceAnalysisData.push(n)}if(a==e.device.length){console.log(e.avgFixPeriodTotal);var s={deviceid:"总计"};s.avgFixPeriod=e.avgFixPeriodTotal,s.avgIssuePeriod=e.avgIssuePeriodTotal,s.unhealthyTime=e.unhealthyTimeTotal,s.issueCount=e.issueCountTotal,console.log(s),e.deviceAnalysisData.unshift(s)}}))}Z.fixAnalysisInfo=e.selectInfo,Z.fixAnalysisdynamicTags=e.dynamicTags,setTimeout((function(){e.$message({message:"查询成功",type:"success"})}),300)}}))}}},Search:function(){var e=this;if(e.deviceAnalysisData=[],0==e.device.length||""==e.startDate||""==e.endDate||null==e.startDate||null==e.endDate)e.$message({message:"请将搜索信息填写完整",typeo:"warning"});else if(new Date(this.startDate).getTime()>=new Date(this.endDate).getTime())e.$message({message:"结束时间必须大于开始时间",type:"warning"});else if(new Date(this.endDate).getTime()>(new Date).getTime())e.$message({message:"结束时间必须小于今天",type:"warning"});else if(e.device.length<=1){var t="http://47.102.214.37:8080/analysis/device?did="+e.device[0]+"&start="+e.startDate+"&end="+e.endDate;v.a.get(t).then((function(t){console.log(t.data);var a={};a.deviceid=e.device[0],a.avgFixPeriod=t.data[e.device[0]].avgFixPeriod,a.avgIssuePeriod=t.data[e.device[0]].avgIssuePeriod,a.unhealthyTime=t.data[e.device[0]].unhealthyTime,a.issueCount=t.data[e.device[0]].issueCount,console.log(a),e.deviceAnalysisData.push(a)}))}else{var a=0,n="http://47.102.214.37:8080/analysis/device?did="+e.device[0];for(a=1;a<e.device.length;a++)n=n+","+e.device[a];a==e.device.length&&(console.log(a),n=n+"&start="+e.startDate+"&end="+e.endDate,console.log(n)),v.a.get(n).then((function(t){console.log(t);var a=0;for(a=0;a<e.device.length;a++){var n={};n.deviceid=e.device[a],n.avgFixPeriod=t.data[e.device[a]].avgFixPeriod,e.avgFixPeriodTotal+=t.data[e.device[a]].avgFixPeriod,n.avgIssuePeriod=t.data[e.device[a]].avgIssuePeriod,e.avgIssuePeriodTotal+=t.data[e.device[a]].avgIssuePeriod,n.unhealthyTime=t.data[e.device[a]].unhealthyTime,e.unhealthyTimeTotal+=t.data[e.device[a]].unhealthyTime,n.issueCount=t.data[e.device[a]].issueCount,e.issueCountTotal+=t.data[e.device[a]].issueCount,console.log(n),e.deviceAnalysisData.push(n)}if(a==e.device.length){console.log(e.avgFixPeriodTotal);var s={deviceid:"总计"};s.avgFixPeriod=e.avgFixPeriodTotal,s.avgIssuePeriod=e.avgIssuePeriodTotal,s.unhealthyTime=e.unhealthyTimeTotal,s.issueCount=e.issueCountTotal,console.log(s),e.deviceAnalysisData.unshift(s)}}))}}}},oa=la,ia=(a("c789"),Object(c["a"])(oa,na,sa,!1,null,null,null)),ca=ia.exports,ra=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-TaskAnalysis"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("数据分析")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("保养分析")])],1),a("div",{staticClass:"Search"},[a("div",{staticClass:"searchtask"},[a("el-select",{attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.selectchange},model:{value:e.selectvalue,callback:function(t){e.selectvalue=t},expression:"selectvalue"}},e._l(e.selectoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1),a("div",e._l(e.dynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("div",{staticClass:"searchpart"},[a("div",[a("el-date-picker",{attrs:{type:"date",placeholder:"开始日期","value-format":"yyyy-MM-dd"},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-button",{on:{click:e.search}},[e._v("查询")])],1)])]),a("div",{staticClass:"Result"},[a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskAnalysisData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"taskid",label:"任务编号",width:"100"}}),a("el-table-column",{attrs:{prop:"times",label:"保养总数"}}),a("el-table-column",{attrs:{prop:"overdueTimes",label:"未按时保养次数"}}),a("el-table-column",{attrs:{prop:"recordTimes",label:"记录次数"}}),a("el-table-column",{attrs:{prop:"incompleteTimes",label:"保养准点率"}}),a("el-table-column",{attrs:{prop:"completeRate",label:"保养完成率"}})],1)],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},["name"==e.selectvalue?a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.namevalue,callback:function(t){e.namevalue=t},expression:"namevalue"}}):e._e(),"scheduleType"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择保养周期",filterable:"",clearable:""},model:{value:e.scheduleTypevalue,callback:function(t){e.scheduleTypevalue=t},expression:"scheduleTypevalue"}},e._l(e.scheduleTypeoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"device"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择设备",filterable:"",clearable:"",multiple:""},model:{value:e.devicevalue,callback:function(t){e.devicevalue=t},expression:"devicevalue"}},e._l(e.deviceoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"ops"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择保养人员",filterable:"",clearable:"",multiple:""},model:{value:e.opsvalue,callback:function(t){e.opsvalue=t},expression:"opsvalue"}},e._l(e.opsoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"startDate"==e.selectvalue?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.datevalue,callback:function(t){e.datevalue=t},expression:"datevalue"}}):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitselect}},[e._v("确 定")])],1)],1)],1)},da=[],ua={components:{},created:function(){var e=this;0!=Z.taskAnalysisInfo.length&&(e.selectInfo=Z.taskAnalysisInfo,e.dynamicTags=Z.taskAnalysisdynamicTags),v()({method:"GET",url:"http://47.102.214.37:8080/device/query?name=!"}).then((function(t){for(var a=0;a<t.data.content.length;a++){var n={};n.value=t.data.content[a].id,n.label=t.data.content[a].name+" ("+t.data.content[a].deviceNo+")",e.deviceoptions[0].options.push(n)}})).catch((function(e){console.log(e)})),v.a.get("http://47.102.214.37:8080/user/query?role==OPERATOR").then((function(t){console.log(t.data);for(var a=0;a<t.data.content.length;a++)e.opsoptions[0].options.push({value:t.data.content[a].id,label:t.data.content[a].name+" (用户名："+t.data.content[a].username+")"})}))},data:function(){return{selectoptions:[{label:"字段",options:[{value:"name",label:"标准名称"},{value:"scheduleType",label:"保养周期"},{value:"device",label:"设备"},{value:"ops",label:"人员"},{value:"startDate",label:"开始时间"}]},{label:"全部保养",options:[{value:"all",label:"全部保养分析"}]}],ifall:!1,selectvalue:"",namevalue:"",dialogSearchVisible:!1,selectInfo:[],dynamicTags:[],scheduleTypevalue:"",scheduleTypeoptions:[{label:"保养周期",options:[{value:"Monthly",label:"月保养"},{value:"Yearly",label:"年保养"},{value:"Seasonly",label:"季度保养"},{value:"Daily",label:"日保养"},{value:"Weeklt",label:"周保养"}]}],devicevalue:"",deviceoptions:[{label:"设备列表",options:[]}],opsvalue:"",opsoptions:[{label:"人员列表",options:[]}],datevalue:"",task:[],startDate:"",endDate:"",taskAnalysisData:[],timesTotal:0,overdueTimesTotal:0,recordTimesTotal:0,incompleteTimesTotal:0,completeRateTotal:0}},methods:{selectchange:function(e){var t=this;t.ifall=!1,"all"==e?(t.ifall=!0,t.task=[],v.a.get("http://47.102.214.37:8080/ops/query?name=! ").then((function(e){var a=0;for(console.log(e.data),a=0;a<e.data.content.length;a++)t.task.push(e.data.content[a].id);a==e.data.content.length&&(t.selectInfo=[],t.dynamicTags=[],Z.taskAnalysisInfo=[],Z.taskAnalysisdynamicTags=[])}))):this.dialogSearchVisible=!0},submitselect:function(){this.dialogSearchVisible=!1,"scheduleType"==this.selectvalue?(this.selectInfo.push({ziduan:this.selectvalue,value:this.scheduleTypevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.scheduleTypevalue)):"device"==this.selectvalue?(this.selectInfo.push({ziduan:this.selectvalue,value:this.devicevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.devicevalue)):"ops"==this.selectvalue?(console.log(this.opsvalue),this.selectInfo.push({ziduan:this.selectvalue,value:this.opsvalue}),this.dynamicTags.push(this.selectvalue+" / "+this.opsvalue)):"startDate"==this.selectvalue?(console.log(this.opsvalue),this.selectInfo.push({ziduan:this.selectvalue,value:this.datevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.datevalue)):(this.selectInfo.push({ziduan:this.selectvalue,value:this.namevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.namevalue))},handleClose:function(e){var t=this.dynamicTags.indexOf(e);console.log(t),this.dynamicTags.splice(t,1),this.selectInfo.splice(t,1)},search:function(){var e=this;if(e.timesTotal=0,e.overdueTimesTotal=0,e.recordTimesTotal=0,e.incompleteTimesTotal=0,e.completeRateTotal=0,e.taskAnalysisData=[],e.ifall)if(""==e.startDate||""==e.endDate||null==e.startDate||null==e.endDate)e.$message({message:"请输入将查询信息填写完整",type:"warning"});else if(new Date(this.startDate).getTime()>=new Date(this.endDate).getTime())e.$message({message:"结束时间必须大于开始时间",type:"warning"});else if(new Date(this.endDate).getTime()>(new Date).getTime())e.$message({message:"结束时间必须小于今天",type:"warning"});else{var t=0;console.log(e.task);var a="http://47.102.214.37:8080/analysis/schedule?sid="+e.task[0];for(console.log(a),t=1;t<e.task.length;t++)a=a+","+e.task[t];t==e.task.length&&(console.log(t),a=a+"&start="+e.startDate+"&end="+e.endDate,console.log(a)),v.a.get(a).then((function(a){console.log(a);for(var n=0;n<e.task.length;n++){var s={};s.taskid=e.task[n],s.times=a.data[e.task[n]].times,e.timesTotal+=a.data[e.task[n]].times,s.incompleteTimes=a.data[e.task[n]].incompleteTimes,e.incompleteTimesTotal=a.data[e.task[n]].incompleteTimes,s.completeRate=a.data[e.task[n]].completeRate,e.completeRateTotal+=a.data[e.task[n]].completeRate,s.overdueTimes=a.data[e.task[n]].overdueTimes,e.overdueTimesTotal+=a.data[e.task[n]].overdueTimes,s.recordTimes=a.data[e.task[n]].recordTimes,e.recordTimesTotal+=a.data[e.task[n]].recordTimes,console.log(s),e.taskAnalysisData.push(s)}if(console.log(e.incompleteTimesTotal),console.log(e.completeRateTotal),t==e.task.length){var l={taskid:"总计"};l.times=e.timesTotal,l.recordTimes=e.recordTimesTotal,l.overdueTimes=e.overdueTimesTotal,l.incompleteTimes=e.incompleteTimesTotal/e.task.length,l.completeRate=e.completeRateTotal/e.task.length,console.log(l),e.taskAnalysisData.unshift(l)}setTimeout((function(){e.$message({message:"查询成功",type:"success"})}),300)}))}else if(0==e.selectInfo.length||""==e.startDate||""==e.endDate||null==e.startDate||null==e.endDate)e.$message({message:"请输入将查询信息填写完整",type:"warning"});else if(new Date(this.startDate).getTime()>=new Date(this.endDate).getTime())e.$message({message:"结束时间必须大于开始时间",type:"warning"});else if(new Date(this.endDate).getTime()>(new Date).getTime())e.$message({message:"结束时间必须小于今天",type:"warning"});else{var n="";if(e.task=[],"name"==e.selectInfo[0].ziduan)n="http://47.102.214.37:8080/ops/query?"+e.selectInfo[0].ziduan+"=L"+e.selectInfo[0].value+"%25";else if(console.log(e.selectInfo[0]),"device"==e.selectInfo[0].ziduan||"ops"==e.selectInfo[0].ziduan)if(e.selectInfo[0].value.length>1){n="http://47.102.214.37:8080/ops/query?"+e.selectInfo[0].ziduan+"=I"+e.selectInfo[0].value[0];for(var s=1;s<e.selectInfo[0].value.length;s++)n=n+","+e.selectInfo[0].value[s]}else n="http://47.102.214.37:8080/ops/query?"+e.selectInfo[0].ziduan+"=="+e.selectInfo[0].value;else n="http://47.102.214.37:8080/ops/query?"+e.selectInfo[0].ziduan+"=="+e.selectInfo[0].value;if(1==e.selectInfo.length)console.log(n),v.a.get(n).then((function(t){if(0==t.data.content.length)e.$message({message:"无结果",type:"warning"});else{console.log(t.data);for(var a=0;a<t.data.content.length;a++)e.task.push(t.data.content[a].id);if(e.task.length<=1){var n="http://47.102.214.37:8080/analysis/schedule?sid="+e.task[0]+"&start="+e.startDate+"&end="+e.endDate;v.a.get(n).then((function(t){var a={};a.taskid=e.task[0],a.times=t.data[e.task[0]].times,e.timesTotal=t.data[e.task[0]].times,a.incompleteTimes=t.data[e.task[0]].incompleteTimes,e.incompleteTimesTotal=t.data[e.task[0]].incompleteTimes,a.completeRate=t.data[e.task[0]].completeRate,e.completeRateTotal=t.data[e.task[0]].completeRate,a.overdueTimes=t.data[e.task[0]].overdueTimes,e.overdueTimesTotal=t.data[e.task[0]].overdueTimes,a.recordTimes=t.data[e.task[0]].recordTimes,e.recordTimesTotal=t.data[e.task[0]].recordTimes,console.log(a),e.taskAnalysisData.push(a)}))}else{var s=0,l="http://47.102.214.37:8080/analysis/schedule?sid="+e.task[0];for(s=1;s<e.task.length;s++)l=l+","+e.task[s];s==e.task.length&&(console.log(s),l=l+"&start="+e.startDate+"&end="+e.endDate,console.log(l)),v.a.get(l).then((function(t){console.log(t);for(var a=0;a<e.task.length;a++){var n={};n.taskid=e.task[a],n.times=t.data[e.task[a]].times,e.timesTotal+=t.data[e.task[a]].times,n.incompleteTimes=t.data[e.task[a]].incompleteTimes,e.incompleteTimesTotal=t.data[e.task[a]].incompleteTimes,n.completeRate=t.data[e.task[a]].completeRate,e.completeRateTotal+=t.data[e.task[a]].completeRate,n.overdueTimes=t.data[e.task[a]].overdueTimes,e.overdueTimesTotal+=t.data[e.task[a]].overdueTimes,n.recordTimes=t.data[e.task[a]].recordTimes,e.recordTimesTotal+=t.data[e.task[a]].recordTimes,console.log(n),e.taskAnalysisData.push(n)}if(console.log(e.incompleteTimesTotal),console.log(e.completeRateTotal),s==e.task.length){var l={taskid:"总计"};l.times=e.timesTotal,l.recordTimes=e.recordTimesTotal,l.overdueTimes=e.overdueTimesTotal,l.incompleteTimes=e.incompleteTimesTotal/e.task.length,l.completeRate=e.completeRateTotal/e.task.length,console.log(l),e.taskAnalysisData.unshift(l)}}))}Z.taskAnalysisInfo=e.selectInfo,Z.taskAnalysisdynamicTags=e.dynamicTags,setTimeout((function(){e.$message({message:"查询成功",type:"success"})}),300)}}));else{console.log(e.selectInfo);for(var l=1;l<e.selectInfo.length;l++)if("name"==e.selectInfo[l].ziduan)n=n+"&"+e.selectInfo[l].ziduan+"=L"+e.selectInfo[l].value+"%25";else if("device"==e.selectInfo[l].ziduan||"ops"==e.selectInfo[l].ziduan)if(e.selectInfo[l].value.length>1){n=n+"&"+e.selectInfo[l].ziduan+"=I"+e.selectInfo[l].value[0];for(var o=1;o<e.selectInfo[l].value.length;o++)n=n+","+e.selectInfo[l].value[o]}else n=n+"&"+e.selectInfo[l].ziduan+"=="+e.selectInfo[l].value;else n=n+"&"+e.selectInfo[l].ziduan+"=="+e.selectInfo[l].value;console.log(n),v.a.get(n).then((function(t){if(0==t.data.content.length)e.$message({message:"无结果",type:"warning"});else{console.log(t.data);for(var a=0;a<t.data.content.length;a++)e.task.push(t.data.content[a].id);if(e.task.length<=1){var n="http://47.102.214.37:8080/analysis/schedule?sid="+e.task[0]+"&start="+e.startDate+"&end="+e.endDate;v.a.get(n).then((function(t){var a={};a.taskid=e.task[0],a.times=t.data[e.task[0]].times,e.timesTotal=t.data[e.task[0]].times,a.incompleteTimes=t.data[e.task[0]].incompleteTimes,e.incompleteTimesTotal=t.data[e.task[0]].incompleteTimes,a.completeRate=t.data[e.task[0]].completeRate,e.completeRateTotal=t.data[e.task[0]].completeRate,a.overdueTimes=t.data[e.task[0]].overdueTimes,e.overdueTimesTotal=t.data[e.task[0]].overdueTimes,a.recordTimes=t.data[e.task[0]].recordTimes,e.recordTimesTotal=t.data[e.task[0]].recordTimes,console.log(a),e.taskAnalysisData.push(a)}))}else{var s=0,l="http://47.102.214.37:8080/analysis/schedule?sid="+e.task[0];for(s=1;s<e.task.length;s++)l=l+","+e.task[s];s==e.task.length&&(console.log(s),l=l+"&start="+e.startDate+"&end="+e.endDate,console.log(l)),v.a.get(l).then((function(t){console.log(t);for(var a=0;a<e.task.length;a++){var n={};n.taskid=e.task[a],n.times=t.data[e.task[a]].times,e.timesTotal+=t.data[e.task[a]].times,n.incompleteTimes=t.data[e.task[a]].incompleteTimes,e.incompleteTimesTotal=t.data[e.task[a]].incompleteTimes,n.completeRate=t.data[e.task[a]].completeRate,e.completeRateTotal+=t.data[e.task[a]].completeRate,n.overdueTimes=t.data[e.task[a]].overdueTimes,e.overdueTimesTotal+=t.data[e.task[a]].overdueTimes,n.recordTimes=t.data[e.task[a]].recordTimes,e.recordTimesTotal+=t.data[e.task[a]].recordTimes,console.log(n),e.taskAnalysisData.push(n)}if(console.log(e.incompleteTimesTotal),console.log(e.completeRateTotal),s==e.task.length){var l={taskid:"总计"};l.times=e.timesTotal,l.recordTimes=e.recordTimesTotal,l.overdueTimes=e.overdueTimesTotal,l.incompleteTimes=e.incompleteTimesTotal/e.task.length,l.completeRate=e.completeRateTotal/e.task.length,console.log(l),e.taskAnalysisData.unshift(l)}}))}Z.taskAnalysisInfo=e.selectInfo,Z.taskAnalysisdynamicTags=e.dynamicTags,setTimeout((function(){e.$message({message:"查询成功",type:"success"})}),300)}}))}}}}},pa=ua,fa=(a("8b19"),Object(c["a"])(pa,ra,da,!1,null,null,null)),ma=fa.exports,va=function(){return a.e("chunk-28f0112b").then(a.bind(null,"f398"))},ha=function(){return a.e("chunk-072d4340").then(a.bind(null,"57da"))};n["default"].use(u["a"]);var ga=[{path:"/",name:"Login",component:va},{path:"/",component:ha,redirect:"/userList",children:[{path:"/userList",component:T},{path:"/authorize",component:I},{path:"/edituser",component:E},{path:"/addDevice",component:N},{path:"/deviceInformation",component:ee},{path:"/editDevice",component:oe},{path:"/code",component:pe},{path:"/addTask",component:be},{path:"/addTaskInside",component:Ie},{path:"/editTask",component:Ee},{path:"/alterTaskContent",component:Ne},{path:"/taskDetailInfo",component:je},{path:"/totalTaskList",component:Ze},{path:"/tssignTask",component:at},{path:"/tssignTask2",component:ct},{path:"/allError",component:yt},{path:"/errorDetail",component:Dt},{path:"/fixApply",component:mt},{path:"/alreadyFixOp",component:Rt},{path:"/alreadyFixSu",component:Bt},{path:"/mySubmit",component:jt},{path:"/mySubmitDetail",component:Zt},{path:"/dailyRecord",component:aa},{path:"/fixAnalysis",component:ca},{path:"/taskAnalysis",component:ma}]}],ba=new u["a"]({routes:ga}),Ta=ba,ya=a("5c96"),ka=a.n(ya);a("0fae"),a("34c4"),a("82da");n["default"].prototype.$http=v.a,n["default"].config.productionTip=!1,n["default"].use(ka.a),n["default"].use(ke["quillEditor"]),new n["default"]({el:"#app",router:Ta,render:function(e){return e(d)}}).$mount("#app")},"603c":function(e,t,a){"use strict";a("9882")},"6aa7":function(e,t,a){},"6f7d":function(e,t,a){},"75bb":function(e,t,a){"use strict";a("5075")},"79e2":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"User_info"},[e._m(0),a("div",{staticClass:"user_info_detail"},[a("div",{staticClass:"info"},[a("span",[e._v("姓名：")]),e._v(e._s(e.name))]),a("div",{staticClass:"info"},[a("span",[e._v("用户名：")]),e._v(e._s(e.username))]),a("div",{staticClass:"info"},[a("span",[e._v("用户邮箱：")]),e._v(e._s(e.useremail))])])])},s=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"user_info_icon"},[n("img",{attrs:{src:a("da3e")}})])}],l={data:function(){return{}},props:{name:String,username:String,useremail:String},mounted:function(){this.data=this.searchList},methods:{}},o=l,i=(a("8dd7"),a("2877")),c=Object(i["a"])(o,n,s,!1,null,null,null);t["a"]=c.exports},"7ef6":function(e,t,a){"use strict";a("eae6")},"82da":function(e,t,a){},"85ec":function(e,t,a){},"88d9":function(e,t,a){},"8b19":function(e,t,a){"use strict";a("3b09")},"8dd7":function(e,t,a){"use strict";a("c439")},"8ed7":function(e,t,a){"use strict";a("b118")},9338:function(e,t,a){},"945e":function(e,t,a){"use strict";a("056a")},9847:function(e,t,a){},9882:function(e,t,a){},"99ae":function(e,t,a){"use strict";a("3e49")},"9b3f":function(e,t,a){},"9b48":function(e,t,a){"use strict";a("9338")},a5c0:function(e,t,a){"use strict";a("edee")},a86b:function(e,t,a){"use strict";a("5051")},a88f:function(e,t,a){"use strict";a("02ea")},a9e7:function(e,t,a){},b118:function(e,t,a){},ba9b:function(e,t,a){"use strict";a("9847")},c000:function(e,t,a){"use strict";a("f5ed")},c2e6:function(e,t,a){"use strict";a("181c")},c439:function(e,t,a){},c6f3:function(e,t,a){"use strict";a("406b")},c789:function(e,t,a){"use strict";a("4e39")},ca32:function(e,t,a){"use strict";a("cb33")},cb33:function(e,t,a){},cb334:function(e,t,a){"use strict";a("a9e7")},d590:function(e,t,a){"use strict";a("11e3")},da3e:function(e,t,a){e.exports=a.p+"img/login-success.5d7a1016.png"},db90:function(e,t,a){},df4d:function(e,t,a){"use strict";a("00ea")},eae6:function(e,t,a){},edee:function(e,t,a){},f2ba:function(e,t,a){},f5ed:function(e,t,a){},f92a:function(e,t,a){"use strict";a("6f7d")}});
//# sourceMappingURL=app.f6675cb3.js.map