(function(e){function t(t){for(var s,n,i=t[0],r=t[1],c=t[2],d=0,u=[];d<i.length;d++)n=i[d],Object.prototype.hasOwnProperty.call(o,n)&&o[n]&&u.push(o[n][0]),o[n]=0;for(s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s]);p&&p(t);while(u.length)u.shift()();return l.push.apply(l,c||[]),a()}function a(){for(var e,t=0;t<l.length;t++){for(var a=l[t],s=!0,n=1;n<a.length;n++){var i=a[n];0!==o[i]&&(s=!1)}s&&(l.splice(t--,1),e=r(r.s=a[0]))}return e}var s={},n={app:0},o={app:0},l=[];function i(e){return r.p+"js/"+({}[e]||e)+"."+{"chunk-072d4340":"c5b531d1","chunk-28f0112b":"e909ee1d"}[e]+".js"}function r(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.e=function(e){var t=[],a={"chunk-072d4340":1,"chunk-28f0112b":1};n[e]?t.push(n[e]):0!==n[e]&&a[e]&&t.push(n[e]=new Promise((function(t,a){for(var s="css/"+({}[e]||e)+"."+{"chunk-072d4340":"b1c2b76b","chunk-28f0112b":"0c961811"}[e]+".css",o=r.p+s,l=document.getElementsByTagName("link"),i=0;i<l.length;i++){var c=l[i],d=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(d===s||d===o))return t()}var u=document.getElementsByTagName("style");for(i=0;i<u.length;i++){c=u[i],d=c.getAttribute("data-href");if(d===s||d===o)return t()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=t,p.onerror=function(t){var s=t&&t.target&&t.target.src||o,l=new Error("Loading CSS chunk "+e+" failed.\n("+s+")");l.code="CSS_CHUNK_LOAD_FAILED",l.request=s,delete n[e],p.parentNode.removeChild(p),a(l)},p.href=o;var v=document.getElementsByTagName("head")[0];v.appendChild(p)})).then((function(){n[e]=0})));var s=o[e];if(0!==s)if(s)t.push(s[2]);else{var l=new Promise((function(t,a){s=o[e]=[t,a]}));t.push(s[2]=l);var c,d=document.createElement("script");d.charset="utf-8",d.timeout=120,r.nc&&d.setAttribute("nonce",r.nc),d.src=i(e);var u=new Error;c=function(t){d.onerror=d.onload=null,clearTimeout(p);var a=o[e];if(0!==a){if(a){var s=t&&("load"===t.type?"missing":t.type),n=t&&t.target&&t.target.src;u.message="Loading chunk "+e+" failed.\n("+s+": "+n+")",u.name="ChunkLoadError",u.type=s,u.request=n,a[1](u)}o[e]=void 0}};var p=setTimeout((function(){c({type:"timeout",target:d})}),12e4);d.onerror=d.onload=c,document.head.appendChild(d)}return Promise.all(t)},r.m=e,r.c=s,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(a,s,function(t){return e[t]}.bind(null,s));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var p=d;l.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"00ea":function(e,t,a){},"02ea":function(e,t,a){},"034f":function(e,t,a){"use strict";a("85ec")},"051e":function(e,t,a){},"056a":function(e,t,a){},"0c15":function(e,t,a){"use strict";a("f2ba")},"11e3":function(e,t,a){},1652:function(e,t,a){},"181c":function(e,t,a){},"1f57":function(e,t,a){"use strict";a("051e")},"22b4":function(e,t,a){"use strict";a("3b30")},2779:function(e,t,a){"use strict";a("9b3f")},"2c6a":function(e,t,a){"use strict";a("db90")},"2f03":function(e,t,a){"use strict";a("88d9")},"34c4":function(e,t,a){},"3b09":function(e,t,a){},"3b30":function(e,t,a){},"406b":function(e,t,a){},"409f":function(e,t,a){"use strict";a("6aa7")},4643:function(e,t,a){e.exports=a.p+"img/beginuseinfo1.500b5a88.png"},"4e39":function(e,t,a){},5051:function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var s=a("2b0e"),n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},o=[],l={data:function(){return{}}},i=l,r=(a("034f"),a("2877")),c=Object(r["a"])(i,n,o,!1,null,null,null),d=c.exports,u=(a("d3b7"),a("8c4f")),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-Register"},[a("div",{staticClass:"head-btn"},[a("div",{staticClass:"oper-btns-left"},[a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1),a("div",{staticClass:"input"},[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),a("div",{staticClass:"input"},[a("el-input",{attrs:{placeholder:"姓名"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),a("div",{staticClass:"input"},[a("el-input",{attrs:{placeholder:"邮箱"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}})],1),a("div",{staticClass:"search"},[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1)]),["ROOT","ADMIN"].includes(e.userRole)?a("div",{staticClass:"oper-btns-right"},[a("el-button",{staticClass:"bigdel-btn",attrs:{icon:"el-icon-delete"},on:{click:e.delectExtraInfo}},[e._v("批量删除")])],1):e._e()]),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"index",label:"序号",width:"60"}}),a("el-table-column",{attrs:{prop:"username",label:"用户名",width:"150"}}),a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"150"}}),a("el-table-column",{attrs:{prop:"email",label:"用户邮箱"}}),a("el-table-column",{attrs:{prop:"userrole",label:"用户权限"}}),["ROOT","ADMIN"].includes(e.userRole)?a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.enable?a("el-button",{on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("修改")]):e._e(),t.row.enable?a("el-button",{on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")]):e._e(),t.row.enable?e._e():a("span",[e._v("已删除")])]}}],null,!1,3003185652)}):e._e()],1),e.ifsearch?e._e():a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[15,30,50,100],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},v=[],m=(a("4160"),a("caad"),a("a434"),a("b0c0"),a("159b"),{created:function(){var e=this;e.userRole=this.globaldata.userRole,setTimeout((function(){e.refresh()}),300)},data:function(){return{userRole:"",tableData:[],checkedDetail:[],currentPage:1,page_size:15,page:1,total:0,ifsearch:!1,username:"",name:"",email:""}},methods:{handleDetailSelectionChange:function(e){this.checkedDetail=e},refresh:function(){var e=this,t=this,a=1;if(t.tableData=[],t.ifsearch=!1,t.username="",t.name="",t.email="",t.currentPage=1,["ROOT","ADMIN"].includes(t.userRole)){var s="user?page=0&size="+t.page_size;this.request(s,{},"GET").then((function(e){console.log(e.data.content),t.total=e.data.totalElements;for(var s=0;s<e.data.content.length;s++)if("ROOT"==e.data.content[s].role){var n={};n.id=e.data.content[s].id,n.index=a++,n.username=e.data.content[s].username,n.userrole=e.data.content[s].role,n.name=e.data.content[s].name,n.email=e.data.content[s].email,n.enable=e.data.content[s].enable,t.tableData.push(n)}else if("ADMIN"==e.data.content[s].role){var o={};o.id=e.data.content[s].id,o.index=a++,o.username=e.data.content[s].username,o.userrole=e.data.content[s].role,o.name=e.data.content[s].name,o.email=e.data.content[s].email,o.enable=e.data.content[s].enable,t.tableData.push(o)}for(var l=0;l<e.data.content.length;l++)if("ROOT"!=e.data.content[l].role&&"ADMIN"!=e.data.content[l].role){var i={};i.id=e.data.content[l].id,i.index=a++,i.username=e.data.content[l].username,i.userrole=e.data.content[l].role,i.name=e.data.content[l].name,i.email=e.data.content[l].email,i.enable=e.data.content[l].enable,t.tableData.push(i)}t.$message({message:"列表已更新",type:"success"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}else this.request("user/query",{},"GET").then((function(e){console.log(e),t.total=e.data.totalElements;for(var s=0;s<e.data.content.length;s++)if("ROOT"==e.data.content[s].role){var n={};n.id=e.data.content[s].id,n.index=a++,n.username=e.data.content[s].username,n.userrole=e.data.content[s].role,n.name=e.data.content[s].name,n.email=e.data.content[s].email,n.enable=e.data.content[s].enable,t.tableData.push(n)}else if("ADMIN"==e.data.content[s].role){var o={};o.id=e.data.content[s].id,o.index=a++,o.username=e.data.content[s].username,o.userrole=e.data.content[s].role,o.name=e.data.content[s].name,o.email=e.data.content[s].email,o.enable=e.data.content[s].enable,t.tableData.push(o)}for(var l=0;l<e.data.content.length;l++)if("ROOT"!=e.data.content[l].role&&"ADMIN"!=e.data.content[l].role){var i={};i.id=e.data.content[l].id,i.index=a++,i.username=e.data.content[l].username,i.userrole=e.data.content[l].role,i.name=e.data.content[l].name,i.email=e.data.content[l].email,i.enable=e.data.content[l].enable,t.tableData.push(i)}t.$message({message:"列表已更新",type:"success"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},handleEdit:function(e){this.$router.push({path:"/edituser",query:this.tableData[e]})},handleDelete:function(e){var t=this,a=this;this.$confirm("删除后无法更改, 是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s="user/"+a.tableData[e].id;console.log(s),t.request(s,{},"DELETE").then((function(){a.tableData.splice(e,1),a.total--,t.$message({message:"删除成功",type:"success"})})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},delectExtraInfo:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("此用户将被永久删除, \n是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.checkedDetail.forEach((function(a){t.tableData.forEach((function(s,n){if(a.id==s.id){console.log(a,s,n);var o="user/"+s.id;e.request(o,{},"DELETE").then((function(){e.$message({message:"删除成功",type:"success"}),t.tableData.splice(n,1),t.checkedDetail.pop(),t.total--})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}))}))})).catch((function(){e.$message.info("已取消删除")}))},handleSizeChange:function(e){var t=this,a=this,s=1;a.tableData=[],a.currentPage=1,console.log(e),a.page_size=e;var n="user?page=0&size="+a.page_size;this.request(n,{},"GET").then((function(e){a.total=e.data.totalElements;for(var t=0;t<e.data.content.length;t++)if("ROOT"==e.data.content[t].role){var n={};n.id=e.data.content[t].id,n.index=s++,n.username=e.data.content[t].username,n.userrole=e.data.content[t].role,n.name=e.data.content[t].name,n.email=e.data.content[t].email,n.enable=e.data.content[t].enable,a.tableData.push(n)}else if("ADMIN"==e.data.content[t].role){var o={};o.id=e.data.content[t].id,o.index=s++,o.username=e.data.content[t].username,o.userrole=e.data.content[t].role,o.name=e.data.content[t].name,o.email=e.data.content[t].email,o.enable=e.data.content[t].enable,a.tableData.push(o)}for(var l=0;l<e.data.content.length;l++)if("ROOT"!=e.data.content[l].role&&"ADMIN"!=e.data.content[l].role){var i={};i.id=e.data.content[l].id,i.index=s++,i.username=e.data.content[l].username,i.userrole=e.data.content[l].role,i.name=e.data.content[l].name,i.email=e.data.content[l].email,i.enable=e.data.content[l].enable,a.tableData.push(i)}a.$message({message:"列表已更新",type:"success"})})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handleCurrentChange:function(e){var t=this,a=this,s=1;a.tableData=[],a.page=e,a.currentPage=e,console.log(e);var n="user?page="+(a.page-1)+"&size="+a.page_size;this.request(n,{},"GET").then((function(e){a.total=e.data.totalElements;for(var t=0;t<e.data.content.length;t++)if("ROOT"==e.data.content[t].role){var n={};n.id=e.data.content[t].id,n.index=s++,n.username=e.data.content[t].username,n.userrole=e.data.content[t].role,n.name=e.data.content[t].name,n.email=e.data.content[t].email,n.enable=e.data.content[t].enable,a.tableData.push(n)}else if("ADMIN"==e.data.content[t].role){var o={};o.id=e.data.content[t].id,o.index=s++,o.username=e.data.content[t].username,o.userrole=e.data.content[t].role,o.name=e.data.content[t].name,o.email=e.data.content[t].email,o.enable=e.data.content[t].enable,a.tableData.push(o)}for(var l=0;l<e.data.content.length;l++)if("ROOT"!=e.data.content[l].role&&"ADMIN"!=e.data.content[l].role){var i={};i.id=e.data.content[l].id,i.index=s++,i.username=e.data.content[l].username,i.userrole=e.data.content[l].role,i.name=e.data.content[l].name,i.email=e.data.content[l].email,i.enable=e.data.content[l].enable,a.tableData.push(i)}a.$message({message:"列表已更新",type:"success"})})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},search:function(){var e=this,t=this,a=1;t.ifsearch=!0;var s="";""!=t.username||""!=t.name||""!=t.email?(""!=t.username?(s="user/query?username=L"+t.username,""!=t.name?(s="user/query?username=L"+t.username+"&name=L"+t.name,""!=t.email&&(s="user/query?username=L"+t.username+"&name=L"+t.name+"&email=="+t.email)):""==t.name&&""!=t.email&&(s="user/query?username=L"+t.username+"&email=="+t.email)):""==t.username&&(""!=t.name?(s="user/query?name=L"+t.name,""!=t.email&&(s="user/query?name=L"+t.name+"&email=="+t.email)):""==t.name&&""!=t.email&&(s="user/query?email=="+t.email)),console.log(s),this.request(s,{},"GET").then((function(s){if(console.log(s.data),t.tableData=[],t.total=s.data.content.length,0==s.data.content.length)e.$message({message:"未找到结果",type:"warning"});else for(var n=0;n<s.data.content.length;n++){var o={};o.id=s.data.content[n].id,o.index=a++,o.username=s.data.content[n].username,o.userrole=s.data.content[n].role,o.name=s.data.content[n].name,o.email=s.data.content[n].email,o.enable=s.data.content[n].enable,t.tableData.push(o)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))):t.$message({message:"请输入搜索条件",type:"warning"})}}}),f=m,g=(a("1f57"),Object(r["a"])(f,p,v,!1,null,null,null)),h=g.exports,b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-Authorize"},[a("div",{staticClass:"box register"},[e._m(0),a("div",{staticClass:"input-body"},[["ADMIN"].includes(e.userRole)?a("span",[e._v("可以创建三种普通用户权限")]):e._e(),a("el-input",{staticClass:"userinfoinput",attrs:{placeholder:"姓名",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("el-input",{staticClass:"userinfoinput",attrs:{placeholder:"用户名",clearable:""},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),a("el-input",{staticClass:"userinfoinput",attrs:{placeholder:"邮箱",clearable:""},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("el-input",{staticClass:"userinfoinput",attrs:{type:"password","show-password":"",placeholder:"密码"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),a("el-input",{staticClass:"userinfoinput",attrs:{type:"password","show-password":"",placeholder:"确认密码"},model:{value:e.confirmpassword,callback:function(t){e.confirmpassword=t},expression:"confirmpassword"}}),a("el-select",{attrs:{placeholder:"权限选择",clearable:""},model:{value:e.value_left,callback:function(t){e.value_left=t},expression:"value_left"}},e._l(e.options_left,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)],1),a("div",{staticClass:"login-btn"},[a("el-button",{on:{click:e.register}},[e._v("注册")])],1)]),a("div",{staticClass:"box"},[e._m(1),a("div",{staticClass:"select-body"},[["ROOT"].includes(e.userRole)?a("span",[e._v("只能创建一个管理员，以及三种普通用户权限")]):e._e(),["ADMIN"].includes(e.userRole)?a("span",[e._v("可以创建三种普通用户权限")]):e._e(),a("el-select",{attrs:{placeholder:"人员选择",clearable:"",filterable:"",multiple:""},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}},e._l(e.options1,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1),a("el-select",{attrs:{placeholder:"权限选择",clearable:""},model:{value:e.value2,callback:function(t){e.value2=t},expression:"value2"}},e._l(e.options2,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)],1),a("div",{staticClass:"login-btn"},[a("el-button",{on:{click:e.authorize}},[e._v("确定授权")])],1)])])},y=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head"},[a("div",{staticClass:"head-text"},[e._v("注册")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head"},[a("div",{staticClass:"head-text"},[e._v("授权")])])}],T={created:function(){var e=this;e.userRole=this.globaldata.userRole,"ADMIN"==this.userRole&&e.options2.shift(),e.getuser()},data:function(){return{userRole:"",name:"",username:"",email:"",password:"",confirmpassword:"",options_left:[{value:"CREATOR",label:"CREATOR"},{value:"OPERATOR",label:"OPERATOR"},{value:"SUPERVISOR",label:"SUPERVISOR"}],value_left:"",options1:[{label:"ADMIN",options:[]},{label:"CREATOR",options:[]},{label:"OPERATOR",options:[]},{label:"SUPERVISOR",options:[]}],options2:[{value:"ADMIN",label:"ADMIN",disabled:!1},{value:"CREATOR",label:"CREATOR"},{value:"OPERATOR",label:"OPERATOR"},{value:"SUPERVISOR",label:"SUPERVISOR"}],value1:[],value2:"",more:!1,piliang:""}},methods:{getuser:function(){var e=this,t=this;t.options1[0].options=[],t.options1[1].options=[],t.options1[2].options=[],t.options1[3].options=[],t.request("user/query?role=!ROOT",{},"GET").then((function(e){console.log(e.data);for(var a=0;a<e.data.content.length;a++)"ADMIN"==e.data.content[a].role&&(t.options1[0].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}),t.options2[0].disabled=!0),"CREATOR"==e.data.content[a].role&&t.options1[1].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}),"OPERATOR"==e.data.content[a].role&&t.options1[2].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}),"SUPERVISOR"==e.data.content[a].role&&t.options1[3].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},register:function(){var e=this,t=this;if(""==t.name||""==t.username||""==t.email||""==t.password||""==t.confirmpassword||""==t.value_left)t.$message({message:"请将信息填写完整",type:"warning"});else if(t.password!=t.confirmpassword)t.$message({message:"两次密码输入不一致",type:"error"});else{var a={};a.name=t.name,a.username=t.username,a.email=t.email,a.password=t.confirmpassword,a.role=t.value_left,this.request("user/register",a,"POST").then((function(e){console.log(e),t.$message({message:"注册成功",type:"success"}),t.getuser()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},authorize:function(){var e=this,t=this;console.log(t.value1),console.log(t.value2);for(var a=function(a){console.log(t.value1[a]);var s="user/"+t.value1[a];e.request(s,{},"GET").then((function(e){var a={email:e.data.email,id:e.data.id,name:e.data.name,role:t.value2,username:e.data.username,enable:e.data.enable};setTimeout((function(){console.log(a),t.request(s,a,"PUT").then((function(e){console.log(e),t.$message({message:"授权成功",type:"success"}),t.$router.push("/userList")})).catch((function(e){console.log(e.response),t.$message({message:"授权失败",type:"error"})}))}),200)}))},s=0;s<t.value1.length;s++)a(s)}}},k=T,x=(a("df4d"),Object(r["a"])(k,b,y,!1,null,null,null)),_=x.exports,I=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-edituser"},[a("div",{staticClass:"Box"},[e._m(0),a("div",{staticClass:"input-body"},[a("span",[e._v("仅能修改姓名、邮箱和密码")]),a("span",[e._v("（注：不需要修改的内容可不用填写）")]),a("el-input",{attrs:{placeholder:"姓名",clearable:""},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),a("el-input",{attrs:{placeholder:"电子邮件",clearable:""},on:{change:e.Email},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),a("el-input",{attrs:{placeholder:"密码",clearable:"","show-password":""},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),""!=e.password?a("el-input",{attrs:{placeholder:"确认密码",clearable:"","show-password":""},model:{value:e.confirmpassword,callback:function(t){e.confirmpassword=t},expression:"confirmpassword"}}):e._e()],1),a("div",{staticClass:"login-btn"},[a("el-button",{on:{click:e.submit}},[e._v("保存修改")])],1)]),a("div",{staticClass:"Box Avatar"},[e._m(1),a("div",{staticClass:"upload"},[a("el-upload",{staticClass:"avatar-uploader",attrs:{"list-type":"picture",action:"","auto-upload":!1,accept:".jpg, .png","show-file-list":!1,"before-upload":e.beforeAvatarUpload,"on-change":e.getFile}},[e.imageUrl?a("img",{staticClass:"avatar",attrs:{src:e.imageUrl}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)])])},C=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head"},[a("div",{staticClass:"head-text"},[e._v("修改信息")])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"head"},[a("div",{staticClass:"head-text"},[e._v("修改头像")])])}],E=(a("4d63"),a("ac1f"),a("25f0"),a("1276"),a("bc3a")),D=a.n(E);D.a.defaults.headers.common["Authorization"]=localStorage.getItem("token");var $={created:function(){var e=this,t=this;if(console.log(t.$route.query),void 0!=t.$route.query.id){var a="user/"+t.$route.query.id;this.request(a,{},"GET").then((function(e){t.userid=e.data.id,t.name=e.data.name,t.email=e.data.email})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}else this.request("user/me",{},"GET").then((function(e){t.userid=e.data.id,t.name=e.data.name,t.email=e.data.email})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},data:function(){return{name:"",userid:"",email:"",password:"",confirmpassword:"",imageUrl:"",picid:""}},methods:{getFile:function(e){var t=this,a=this;this.imageUrl=e.url,this.getBase64(e.raw).then((function(e){var s=e.split(",");console.log(s,"params"),s.length>0&&t.request("pic",s[1],"POST",{"Content-Type":"text/plain"}).then((function(e){console.log(e),a.picid=e.data}))}))},beforeAvatarUpload:function(e){var t=e.size/1024/1024<2;return t||this.$message.error("上传头像图片大小不能超过 2MB!"),t},getBase64:function(e){return new Promise((function(t,a){var s=new FileReader,n="";s.readAsDataURL(e),s.onload=function(){n=s.result},s.onerror=function(e){a(e)},s.onloadend=function(){t(n)}}))},Email:function(){var e=new RegExp("^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$");e.test(this.email)||(this.$message({message:"请输入正确的邮箱地址",type:"error"}),this.email="")},submit:function(){var e=this,t=this;if(console.log(t.name),console.log(t.email),console.log(t.userid),console.log(t.password),console.log(t.confirmpassword),""==t.name||""==t.email)this.$message({message:"请将姓名和邮箱填写完整",type:"warning"});else if(t.password===t.confirmpassword)if(void 0!=t.$route.query.id){var a="user/"+t.userid;this.request(a,{},"GET").then((function(e){var s={email:t.email,id:e.data.id,name:t.name,role:e.data.role,username:e.data.username,enable:e.data.enable,password:t.confirmpassword,avatar:t.picid};setTimeout((function(){t.request(a,s,"PUT").then((function(e){console.log(e),t.$message({message:"修改成功",type:"success"}),location.reload()})).catch((function(e){console.log(e.response),t.$message({message:"修改失败",type:"error"})}))}),300)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}else{var s={email:t.email,name:t.name,password:t.confirmpassword,avatar:t.picid},n="user/me/edit";this.request(n,s,"POST").then((function(e){console.log(e),t.$message({message:"修改成功",type:"success"}),location.reload()})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}else this.$message({message:"两次密码输入不一致，请重新输入",type:"warning"}),this.password="",this.confirmpassword=""}}},w=$,q=(a("22b4"),Object(r["a"])(w,I,C,!1,null,null,null)),S=q.exports,R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return["ROOT","ADMIN","CREATOR"].includes(e.userRole)?a("div",{staticClass:"Main"},[a("el-breadcrumb",{staticClass:"Breadcrumb"},[a("el-breadcrumb-item",{staticClass:"left"},[e._v("设备管理")]),a("el-breadcrumb-item",{staticClass:"right"},[e._v("新增设备")])],1),a("div",{staticClass:"AddDeviceInfo"},[a("div",{staticClass:"BaseInfo"},[a("div",{staticClass:"BaseInfoText"},[e._v("基本信息")]),a("div",{staticClass:"BaseInfoTable"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:"设备名称: ","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入设备名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"设备品牌: ","label-width":e.formLabelWidth,prop:"brand"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备品牌"},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}})],1),a("el-form-item",{attrs:{label:"设备型号: ","label-width":e.formLabelWidth,prop:"type"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备型号"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("el-form-item",{attrs:{label:"设备编号: ","label-width":e.formLabelWidth,prop:"deviceNo"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备编号"},model:{value:e.form.deviceNo,callback:function(t){e.$set(e.form,"deviceNo",t)},expression:"form.deviceNo"}})],1),a("el-form-item",{attrs:{label:"关键设备:","label-width":e.formLabelWidth,prop:"crux"}},[a("el-radio-group",{model:{value:e.form.crux,callback:function(t){e.$set(e.form,"crux",t)},expression:"form.crux"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1),a("el-form-item",{attrs:{label:"设备分类: ","label-width":e.formLabelWidth,prop:"clazz"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备分类"},model:{value:e.form.clazz,callback:function(t){e.$set(e.form,"clazz",t)},expression:"form.clazz"}})],1)],1),a("div",{staticClass:"submitbtn"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitNewDevice(e.form)}}},[e._v("保存并提交")])],1)],1)]),a("div",{staticClass:"ExtraInfo"},[a("div",{staticClass:"ExtraInfoText"},[e._v("拓展信息")]),a("div",{staticClass:"Btns"},[["ROOT","ADMIN","SUPERVISOR","CREATOR"].includes(e.userRole)?a("el-button",{staticClass:"AddBtn",attrs:{icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增字段")]):e._e(),["ROOT","ADMIN","SUPERVISOR","CREATOR"].includes(e.userRole)?a("el-button",{staticClass:"EditBtn",attrs:{icon:"el-icon-edit"},on:{click:function(t){e.EditExtraInfoDialog=!0}}},[e._v("修改字段")]):e._e(),["ROOT","ADMIN","SUPERVISOR","CREATOR"].includes(e.userRole)?a("el-button",{staticClass:"DelBtn",attrs:{icon:"el-icon-delete"},on:{click:e.delectExtraInfo}},[e._v("删除字段")]):e._e()],1),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"extraname",label:"字段名"}}),a("el-table-column",{attrs:{label:"字段信息"},scopedSlots:e._u([{key:"default",fn:function(t){return["String"==t.row.type?a("el-input",{attrs:{placeholder:"请输入字段信息"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Integer"==t.row.type?a("el-input",{attrs:{type:"number",placeholder:"请输入字段信息"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Date"==t.row.type?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",size:"large","value-format":"yyyy-MM-dd"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Bool"==t.row.type?a("el-radio-group",{model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1):e._e()]}}],null,!1,3823509501)})],1),a("div",{staticClass:"ExtraInfoTable"})],1)]),a("el-dialog",{staticClass:"addExtraInfoDialog",attrs:{title:"新增字段",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.ExtraInfoDialog}},[a("el-form-item",{attrs:{label:"字段名称: ","label-width":"100px"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入字段名称"},model:{value:e.ExtraInfoDialog.name,callback:function(t){e.$set(e.ExtraInfoDialog,"name",t)},expression:"ExtraInfoDialog.name"}})],1),a("el-form-item",{attrs:{label:"字段类型: ","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择字段类型"},model:{value:e.ExtraInfoDialog.type,callback:function(t){e.$set(e.ExtraInfoDialog,"type",t)},expression:"ExtraInfoDialog.type"}},[a("el-option",{attrs:{label:"String (字符串型)",value:"String"}}),a("el-option",{attrs:{label:"Date (日期型)",value:"Date"}}),a("el-option",{attrs:{label:"Integer (数字型)",value:"Integer"}}),a("el-option",{attrs:{label:"Bool (布尔型)",value:"Bool"}})],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.SubmitNewExtraInfo(e.ExtraInfoDialog)}}},[e._v("确 定")])],1)],1),a("el-dialog",{staticClass:"EditExtraInfoDialog",attrs:{title:"修改字段",visible:e.EditExtraInfoDialog},on:{"update:visible":function(t){e.EditExtraInfoDialog=t}}},[a("el-form",{attrs:{model:e.EditedExtraInfoDialog}},[a("el-form-item",{attrs:{label:"字段: ","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择需要修改的字段"},model:{value:e.EditedExtraInfoDialog.id,callback:function(t){e.$set(e.EditedExtraInfoDialog,"id",t)},expression:"EditedExtraInfoDialog.id"}},e._l(e.ExtraInfoOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"字段名称: ","label-width":"100px"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"需要修改的字段名称"},model:{value:e.EditedExtraInfoDialog.name,callback:function(t){e.$set(e.EditedExtraInfoDialog,"name",t)},expression:"EditedExtraInfoDialog.name"}})],1),a("el-form-item",{attrs:{label:"字段类型: ","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"需要修改的字段类型",size:"larger"},model:{value:e.EditedExtraInfoDialog.type,callback:function(t){e.$set(e.EditedExtraInfoDialog,"type",t)},expression:"EditedExtraInfoDialog.type"}},[a("el-option",{attrs:{label:"String (字符串型)",value:"String"}}),a("el-option",{attrs:{label:"Date (日期型)",value:"Date"}}),a("el-option",{attrs:{label:"Integer (数字型)",value:"Integer"}}),a("el-option",{attrs:{label:"Bool (布尔型)",value:"Bool"}})],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"editcancel",on:{click:function(t){e.EditExtraInfoDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.SubmitEditedExtraInfo(e.EditedExtraInfoDialog)}}},[e._v("确 定")])],1)],1)],1):e._e()},z=[],O={data:function(){return{userRole:"",form:{},ExtraInfoDialog:{},EditedExtraInfoDialog:{},ExtraInfoOptions:[],formLabelWidth:"150px",dialogFormVisible:!1,EditExtraInfoDialog:!1,checkedDetail:[],tableData:[],extraid:[],rules:{name:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],brand:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],type:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],deviceNo:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],crux:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],clazz:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}]}}},methods:{handleDetailSelectionChange:function(e){this.checkedDetail=e},getExtraInfo:function(){var e=this,t=this;t.tableData=[],t.extraid=[],t.ExtraInfoOptions=[],t.request("device/info-field",{},"GET").then((function(e){console.log(e.data);for(var a=0;a<e.data.length;a++){t.extraid.push(e.data[a].id),"Bool"==e.data[a].type?t.tableData.push({extraname:e.data[a].name,extrainfo:"true"==t.$route.query[e.data[a].id]?"Y":"N",type:e.data[a].type}):t.tableData.push({extraname:e.data[a].name,extrainfo:t.$route.query[e.data[a].id],type:e.data[a].type});var s={};s.value=e.data[a].id,s.label=e.data[a].name+"（"+e.data[a].type+"）",t.ExtraInfoOptions.push(s)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},SubmitNewExtraInfo:function(e){var t=this,a=this;""==e.name||void 0==e.type?this.$alert("请将基本信息填写完整！","提示",{confirmButtonText:"确定"}):a.request("device/info-field",{name:e.name,type:e.type},"POST").then((function(e){console.log(e),a.$message({message:"新增字段成功",type:"success"}),a.getExtraInfo(),a.dialogFormVisible=!1})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},SubmitEditedExtraInfo:function(){var e=this,t=this;if(console.log(t.EditedExtraInfoDialog.name),void 0==t.EditedExtraInfoDialog.id||""==t.EditedExtraInfoDialog.name||void 0==t.EditedExtraInfoDialog.name||void 0==t.EditedExtraInfoDialog.type)t.$message({message:"请将修改字段信息填写完整",type:"warning"});else{var a="device/info-field/edit/"+t.EditedExtraInfoDialog.id;t.request(a,t.EditedExtraInfoDialog,"PUT").then((function(){e.$message({message:"修改成功",type:"success"}),t.EditExtraInfoDialog=!1,t.getExtraInfo(),t.EditedExtraInfoDialog={}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},delectExtraInfo:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("现有的设备中属于该字段的所有信息都会被删除, \n是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.checkedDetail.forEach((function(a){t.tableData.forEach((function(s,n){if(a.extraname==s.extraname){console.log(t.tableData[n]),console.log(t.extraid[n]);var o="device/info-field/"+t.extraid[n];t.request(o,{},"DELETE").then((function(a){console.log(a),t.tableData.splice(n,1),e.$message({message:"删除成功",type:"success"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}))})),setTimeout((function(){t.getExtraInfo()}),300)})).catch((function(){e.$message.info("已取消删除")}))},submitNewDevice:function(e){var t=this,a=[],s=this;if(void 0==e.name||void 0==e.brand||void 0==e.type||void 0==e.deviceNo||void 0==e.crux||void 0==e.clazz)this.$alert("请将基本信息填写完整！","提示",{confirmButtonText:"确定"});else{var n={};"Y"==e.crux?n.crux=!0:"N"==e.crux&&(n.crux=!1);for(var o=0;o<s.tableData.length;o++)"Y"==s.tableData[o].extrainfo?s.tableData[o].extrainfo=!0:"N"==s.tableData[o].extrainfo&&(s.tableData[o].extrainfo=!1),a.push({field:{id:s.extraid[o]},value:s.tableData[o].extrainfo});s.request("device",{name:e.name,brand:e.brand,type:e.type,deviceNo:e.deviceNo,crux:n.crux,clazz:e.clazz,extra:a},"POST").then((function(e){"ok"==e.data.message&&t.$message({message:"添加成功",type:"success"})})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}}},created:function(){var e=this;e.userRole=e.globaldata.userRole,e.getExtraInfo()}},A=O,P=(a("2c6a"),Object(r["a"])(A,R,z,!1,null,null,null)),N=P.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Box"},[a("el-breadcrumb",{staticClass:"breadcrumb-top",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备管理")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("设备信息")])],1),a("el-main",{staticClass:"Main-Box"},[a("div",{staticClass:"head-btn"},[a("div",{staticClass:"oper-btns-left"},[a("div",{staticClass:"select"},[a("el-select",{attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.selectchange},model:{value:e.selectvalue,callback:function(t){e.selectvalue=t},expression:"selectvalue"}},e._l(e.selectoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),a("div",e._l(e.dynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1),a("div",{staticClass:"search"},[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1),a("div",{staticClass:"getall refresh"},[a("el-button",{attrs:{icon:"el-icon-document-copy"},on:{click:e.getAllDevice}},[e._v("获取全部设备 ")])],1),a("div",{staticClass:"import refresh"},[["ROOT","ADMIN","CREATOR"].includes(e.userRole)?a("el-button",{attrs:{icon:"el-icon-upload2"},on:{click:function(t){e.dialogVisible=!0}}},[e._v("导入 ")]):e._e()],1),a("div",{staticClass:"export refresh"},[["ROOT","ADMIN","CREATOR"].includes(e.userRole)?a("el-button",{attrs:{icon:"el-icon-download"},on:{click:e.exportExcel}},[e._v("导出 ")]):e._e()],1)]),a("div",{staticClass:"oper-btns-right"},[["ROOT","ADMIN","CREATOR"].includes(e.userRole)?a("el-button",{staticClass:"bigdel-btn",attrs:{icon:"el-icon-delete"},on:{click:e.delectAll}},[e._v("批量删除")]):e._e()],1)]),a("el-table",{ref:"multipleTable",staticClass:"tablestyle",staticStyle:{width:"100%"},attrs:{data:e.tableData,"tooltip-effect":"dark",stripe:"",id:"outTable"},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"44"}}),a("el-table-column",{attrs:{prop:"index",label:"序号",width:"60"}}),a("el-table-column",{attrs:{prop:"name",label:"设备名称",width:"150"}}),a("el-table-column",{attrs:{prop:"brand",label:"设备品牌",width:"120"}}),a("el-table-column",{attrs:{prop:"type",label:"设备型号",width:"150"}}),a("el-table-column",{attrs:{prop:"deviceNo",label:"设备编号",width:"150"}}),a("el-table-column",{attrs:{prop:"crux",label:"关键设备",width:"150"}}),a("el-table-column",{attrs:{prop:"clazz",label:"设备分类",width:"120"}}),e._l(e.tableHead,(function(e,t){return[a("el-table-column",{key:t,attrs:{prop:e.prop,label:e.label,width:e.width}})]})),["ROOT","ADMIN","CREATOR"].includes(e.userRole)?a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("修改")]),a("el-button",{on:{click:function(a){return e.handleCode(t.row)}}},[e._v("编码")]),a("el-button",{on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}],null,!1,3205568824)}):e._e()],2),e.ifsearch?e._e():a("div",{staticClass:"block"},[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[15,30,50,100],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),a("el-dialog",{attrs:{title:"提示",visible:e.dialogVisible,width:"35%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticStyle:{display:"flex","flex-direction":"column","justify-content":"center","align-items":"center"}},[a("el-upload",{ref:"upload",attrs:{drag:"",action:"http://1.15.236.205/api/device/import",multiple:"","http-request":e.UpLoad,"auto-upload":!1,accept:".xlsx","on-preview":e.handlePreview}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传 xlsx 文件")])]),a("div",{staticStyle:{"margin-top":"10px"}},[a("el-button",{staticStyle:{border:"0",background:"#409eff",color:"#fff","font-weight":"bold"},on:{click:e.submitUpload}},[e._v("确认上传")])],1)],1)]),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},[e.ExtraInfo_String.includes(e.selectvalue)?a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.selectmodel,callback:function(t){e.selectmodel=t},expression:"selectmodel"}}):e._e(),e.ExtraInfo_Int.includes(e.selectvalue)?a("el-input",{attrs:{type:"number",placeholder:"请输入搜索内容"},model:{value:e.selectmodel,callback:function(t){e.selectmodel=t},expression:"selectmodel"}}):e._e(),e.ExtraInfo_Bool.includes(e.selectvalue)?a("el-radio-group",{model:{value:e.selectmodel,callback:function(t){e.selectmodel=t},expression:"selectmodel"}},[a("el-radio-button",{attrs:{label:"是"}}),a("el-radio-button",{attrs:{label:"否"}})],1):e._e(),e.ExtraInfo_Date.includes(e.selectvalue)?a("el-date-picker",{attrs:{type:"daterange","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.selectmodel,callback:function(t){e.selectmodel=t},expression:"selectmodel"}}):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitselect}},[e._v("确 定")])],1)],1)],1)},L=[],B=(a("c975"),a("2532"),a("3ca3"),a("841c"),a("ddb0"),a("2b3d"),""),M="",V="",U="",F="",j="",W=[],J=[],Y=[],H=[],Q=[],X=[],Z=[],K={userid:B,userRole:M,useremail:U,username:V,name:F,avatarurl:j,deviceselectInfo:W,devicedynamicTags:J,extrainfo_Date:Y,taskselectInfo:H,taskdynamicTags:Q,fixselectInfo:X,fixdynamicTags:Z},ee={name:"DeviceInformation",components:{},data:function(){return{ifsearch:!1,selectoptions:[{label:"基本字段",options:[{value:"name",label:"设备名称"},{value:"brand",label:"设备品牌"},{value:"type",label:"设备型号"},{value:"deviceNo",label:"设备编号"},{value:"clazz",label:"设备分类"}]},{label:"附加字段",options:[]}],ExtraInfo_Date:[],ExtraInfo_String:["name","brand","type","deviceNo","clazz"],ExtraInfo_Int:[],ExtraInfo_Bool:[],selectvalue:"",selectmodel:"",dialogSearchVisible:!1,selectInfo:[],dynamicTags:[],dialogVisible:!1,fileList:[],exporturl:"",userRole:"",checkedDetail:[],tableHead:[],tableData:[],multipleSelection:[],currentPage:1,page_size:15,page:1,total:0}},methods:{handleDetailSelectionChange:function(e){this.checkedDetail=e},selectchange:function(){this.dialogSearchVisible=!0,this.selectmodel=""},submitselect:function(){this.ExtraInfo_Date.includes(this.selectvalue)?null==this.selectmodel?this.$message({message:"请选择起止日期",type:"warning"}):new Date(this.selectmodel[0]).getTime()>(new Date).getTime()||new Date(this.selectmodel[1]).getTime()>(new Date).getTime()?this.$message({message:"开始或结束日期必须小于今天",type:"warning"}):(this.dialogSearchVisible=!1,this.selectInfo.push({ziduan:this.selectvalue,value:this.selectmodel}),this.dynamicTags.push(this.selectvalue+" / "+this.selectmodel)):""==this.selectmodel?this.$message({message:"请将查询信息填写完整",type:"warning"}):(this.dialogSearchVisible=!1,this.selectInfo.push({ziduan:this.selectvalue,value:this.selectmodel}),this.dynamicTags.push(this.selectvalue+" / "+this.selectmodel))},handleClose:function(e){var t=this.dynamicTags.indexOf(e);console.log(t),this.dynamicTags.splice(t,1),this.selectInfo.splice(t,1)},search:function(){var e=this,t="",a="",s=1;if(e.ifsearch=!0,console.log(e.selectInfo),K.extrainfo_Date.includes(e.selectInfo[0].ziduan)?(t="device/query?"+e.selectInfo[0].ziduan+"=B"+e.selectInfo[0].value,a="device/export?"+e.selectInfo[0].ziduan+"=B"+e.selectInfo[0].value):(t="device/query?"+e.selectInfo[0].ziduan+"=L"+e.selectInfo[0].value,a="device/export?"+e.selectInfo[0].ziduan+"=L"+e.selectInfo[0].value),1==e.selectInfo.length)e.exporturl=a,e.request(t,{},"GET").then((function(t){if(console.log(t.data),e.tableData=[],0==t.data.content.length)e.$message({message:"无结果",type:"warning"});else{e.total=t.data.totalElements,e.currentPage=1;for(var a=0;a<t.data.content.length;a++){var n={};if(n.id=t.data.content[a].id,n.index=s++,n.name=t.data.content[a].name,n["brand"]=t.data.content[a].brand,n.type=t.data.content[a].type,n.deviceNo=t.data.content[a].deviceNo,0!=t.data.content[a].extra.length)for(var o=0;o<t.data.content[a].extra.length;o++)n[t.data.content[a].extra[o].field.id]=t.data.content[a].extra[o].value;1==t.data.content[a].crux?n.crux="true":0==t.data.content[a].crux&&(n.crux="false"),n.clazz=t.data.content[a].clazz,e.tableData.push(n)}e.$message({message:"查询成功",type:"success"}),K.deviceselectInfo=e.selectInfo,K.devicedynamicTags=e.dynamicTags}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));else{console.log(K.extrainfo_Date);for(var n=1;n<e.selectInfo.length;n++)K.extrainfo_Date.includes(e.selectInfo[n].ziduan)?(t+="&"+e.selectInfo[n].ziduan+"=B"+e.selectInfo[n].value,a+="&"+e.selectInfo[n].ziduan+"=B"+e.selectInfo[n].value):(t+="&"+e.selectInfo[n].ziduan+"=L"+e.selectInfo[n].value,a+="&"+e.selectInfo[n].ziduan+"=L"+e.selectInfo[n].value);e.exporturl=a,e.request(t,{},"GET").then((function(t){if(console.log(t.data),e.tableData=[],0==t.data.content.length)e.$message({message:"无结果",type:"warning"});else{e.total=t.data.totalElements,e.currentPage=1;for(var a=0;a<t.data.content.length;a++){var n={};if(n.id=t.data.content[a].id,n.index=s++,n.name=t.data.content[a].name,n["brand"]=t.data.content[a].brand,n.type=t.data.content[a].type,n.deviceNo=t.data.content[a].deviceNo,0!=t.data.content[a].extra.length)for(var o=0;o<t.data.content[a].extra.length;o++)n[t.data.content[a].extra[o].field.id]=t.data.content[a].extra[o].value;1==t.data.content[a].crux?n.crux="true":0==t.data.content[a].crux&&(n.crux="false"),n.clazz=t.data.content[a].clazz,e.tableData.push(n)}e.$message({message:"查询成功",type:"success"}),K.deviceselectInfo=e.selectInfo,K.devicedynamicTags=e.dynamicTags}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},getAllDevice:function(){var e=this,t=this,a=1;t.ifsearch=!1;var s="device?page=0&size="+t.page_size;t.request(s,{},"GET").then((function(s){console.log(s.data),t.tableData=[],t.total=s.data.totalElements,t.currentPage=1;for(var n=0;n<s.data.content.length;n++){var o={};if(o.id=s.data.content[n].id,o.index=a++,o.name=s.data.content[n].name,o["brand"]=s.data.content[n].brand,o.type=s.data.content[n].type,o.deviceNo=s.data.content[n].deviceNo,0!=s.data.content[n].extra.length)for(var l=0;l<s.data.content[n].extra.length;l++)o[s.data.content[n].extra[l].field.id]=s.data.content[n].extra[l].value;1==s.data.content[n].crux?o.crux="true":0==s.data.content[n].crux&&(o.crux="false"),o.clazz=s.data.content[n].clazz,t.tableData.push(o)}e.$message({message:"已获取全部设备",type:"success"}),t.selectInfo=[],t.selectvalue="",t.selectmodel="",t.dynamicTags=[],K.deviceselectInfo=[],K.devicedynamicTags=[],t.exporturl="device/export?name=! "})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handlePreview:function(e,t){console.log(e,t)},UpLoad:function(e){var t=this,a=new FormData;a.append("file",e.file),t.request("device/import",a,"POST").then((function(e){console.log(e),200==e.status&&(t.dialogVisible=!1,t.$message({message:"上传成功",type:"success"}),setTimeout((function(){t.getAllDevice()}),200))})).catch((function(e){console.log(e),t.$message({message:e.response.data.message,type:"error"})}))},submitUpload:function(){this.$refs.upload.submit()},exportExcel:function(){var e=this;console.log(e.exporturl),e.request(e.exporturl,{},"GET",{},"blob").then((function(e){if(console.log(e),e){var t=new Blob([e.data],{type:"application/vnd.ms-excel;charset=utf-8"}),a=window.URL.createObjectURL(t),s=document.createElement("a");s.style.display="none",s.href=a,s.setAttribute("download","data.xlsx"),document.body.appendChild(s),s.click(),document.body.removeChild(s),window.URL.revokeObjectURL(a)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},delectAll:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("删除后无法更改, 是否确定?（当前页全选仅删除当前页的设备）","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.checkedDetail.forEach((function(e){t.tableData.forEach((function(a,s){if(e.id==a.id){console.log(t.tableData[s]);var n="device/"+t.tableData[s].id;t.request(n,{},"DELETE").catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}}))})),setTimeout((function(){t.getAllDevice(),setTimeout((function(){t.getAllDevice()}),1e3)}),1e3)})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},handleEdit:function(e){var t=this;console.log(e);var a=this,s={};s.id=e.id,s.name=e.name,s.brand=e.brand,s.type=e.type,s.deviceNo=e.deviceNo,s.crux=e.crux,s.clazz=e.clazz,a.request("device/info-field",{},"GET").then((function(a){console.log(a.data);for(var n=0;n<a.data.length;n++)s[a.data[n].id]=e[a.data[n].id];t.$router.push({path:"/editDevice",query:s})})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handleCode:function(e){console.log(e),this.$router.push({path:"./code",query:e})},handleDelete:function(e){var t=this,a=this;this.$confirm("删除后无法更改, 是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s="device/"+e.id;a.request(s,{},"DELETE").then((function(e){"ok"==e.data.message&&t.getAllDevice()})).catch((function(e){a.$message({message:e.response.data.message,type:"error"})}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleSizeChange:function(e){var t=this,a=1;t.tableData=[],console.log(e),t.page_size=e;var s="device?page=0&size="+t.page_size;t.request(s,{},"GET").then((function(e){t.total=e.data.totalElements,t.currentPage=1;for(var s=0;s<e.data.content.length;s++){var n={};if(n.id=e.data.content[s].id,n.index=a++,n.name=e.data.content[s].name,n["brand"]=e.data.content[s].brand,n.type=e.data.content[s].type,n.deviceNo=e.data.content[s].deviceNo,0!=e.data.content[s].extra.length)for(var o=0;o<e.data.content[s].extra.length;o++)n[e.data.content[s].extra[o].field.id]=e.data.content[s].extra[o].value;1==e.data.content[s].crux?n.crux="true":0==e.data.content[s].crux&&(n.crux="false"),n.clazz=e.data.content[s].clazz,t.tableData.push(n)}t.selectInfo=[],t.selectvalue="",t.selectmodel="",t.dynamicTags=[],K.deviceselectInfo=[],K.devicedynamicTags=[],t.exporturl="device/export?name=! "})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handleCurrentChange:function(e){var t=this,a=1;t.page=e,t.currentPage=e,console.log(e);var s="device?page="+(t.page-1)+"&size="+t.page_size;t.request(s,{},"GET").then((function(e){t.tableData=[],t.total=e.data.totalElements;for(var s=0;s<e.data.content.length;s++){var n={};if(n.id=e.data.content[s].id,n.index=a++,n.name=e.data.content[s].name,n["brand"]=e.data.content[s].brand,n.type=e.data.content[s].type,n.deviceNo=e.data.content[s].deviceNo,0!=e.data.content[s].extra.length)for(var o=0;o<e.data.content[s].extra.length;o++)n[e.data.content[s].extra[o].field.id]=e.data.content[s].extra[o].value;1==e.data.content[s].crux?n.crux="true":0==e.data.content[s].crux&&(n.crux="false"),n.clazz=e.data.content[s].clazz,t.tableData.push(n)}t.selectInfo=[],t.selectvalue="",t.selectmodel="",t.dynamicTags=[],K.deviceselectInfo=[],K.devicedynamicTags=[],t.exporturl="device/export?name=! "})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}},created:function(){var e=this;e.userRole=e.globaldata.userRole,0!=K.deviceselectInfo.length?(console.log(K.deviceselectInfo),e.selectInfo=K.deviceselectInfo,e.dynamicTags=K.devicedynamicTags,e.search()):setTimeout((function(){e.request("device/info-field",{},"GET").then((function(t){console.log(t.data);for(var a=0;a<t.data.length;a++){var s={};s.label=t.data[a].name,s.width="130",s.prop=t.data[a].id,e.tableHead.push(s)}for(var n=0;n<t.data.length;n++)switch(e.selectoptions[1].options.push({value:t.data[n].id,label:t.data[n].name}),t.data[n].type){case"String":e.ExtraInfo_String.push(t.data[n].id);break;case"Integer":e.ExtraInfo_Int.push(t.data[n].id);break;case"Bool":e.ExtraInfo_Bool.push(t.data[n].id);break;case"Date":e.ExtraInfo_Date.push(t.data[n].id),K.extrainfo_Date=[],K.extrainfo_Date.push(t.data[n].id);break;default:break}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),e.getAllDevice()}),200)}},te=ee,ae=(a("c000"),a("7f8a"),Object(r["a"])(te,G,L,!1,null,"2ab0e9ed",null)),se=ae.exports,ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Main"},[a("el-breadcrumb",{staticClass:"BreadCrumb"},[a("el-breadcrumb-item",{staticClass:"left"},[e._v("设备管理")]),a("el-breadcrumb-item",{staticClass:"right"},[e._v("编辑设备")])],1),a("div",{staticClass:"AddDeviceInfo"},[a("div",{staticClass:"BaseInfo"},[a("div",{staticClass:"BaseInfoText"},[e._v("基本信息")]),a("div",{staticClass:"BaseInfoTable"},[a("el-form",{ref:"form",attrs:{model:e.form,"label-position":"left",rules:e.rules}},[a("el-form-item",{attrs:{label:"设备名称: ","label-width":e.formLabelWidth,prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入设备名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"设备品牌: ","label-width":e.formLabelWidth,prop:"brand"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备品牌"},model:{value:e.form.brand,callback:function(t){e.$set(e.form,"brand",t)},expression:"form.brand"}})],1),a("el-form-item",{attrs:{label:"设备型号: ","label-width":e.formLabelWidth,prop:"type"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备型号"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}})],1),a("el-form-item",{attrs:{label:"设备编号: ","label-width":e.formLabelWidth,prop:"deviceNo"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备编号"},model:{value:e.form.deviceNo,callback:function(t){e.$set(e.form,"deviceNo",t)},expression:"form.deviceNo"}})],1),a("el-form-item",{attrs:{label:"关键设备:","label-width":e.formLabelWidth,prop:"crux"}},[a("el-radio-group",{model:{value:e.form.crux,callback:function(t){e.$set(e.form,"crux",t)},expression:"form.crux"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1),a("el-form-item",{attrs:{label:"设备分类: ","label-width":e.formLabelWidth,prop:"clazz"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入设备分类"},model:{value:e.form.clazz,callback:function(t){e.$set(e.form,"clazz",t)},expression:"form.clazz"}})],1)],1),a("div",{staticClass:"submitbtn"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitEditDevice(e.form)}}},[e._v("确认修改")])],1)],1)]),a("div",{staticClass:"ExtraInfo"},[a("div",{staticClass:"ExtraInfoText"},[e._v("拓展信息")]),a("div",{staticClass:"Btns"},[a("el-button",{staticClass:"AddBtn",attrs:{icon:"el-icon-circle-plus-outline"},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v("新增字段")]),a("el-button",{staticClass:"EditBtn",attrs:{icon:"el-icon-edit"},on:{click:function(t){e.EditExtraInfoDialog=!0}}},[e._v("修改字段")]),a("el-button",{staticClass:"DelBtn",attrs:{icon:"el-icon-delete"},on:{click:e.delectExtraInfo}},[e._v("删除字段")])],1),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"extraname",label:"字段名"}}),a("el-table-column",{attrs:{label:"字段信息"},scopedSlots:e._u([{key:"default",fn:function(t){return["String"==t.row.type?a("el-input",{attrs:{placeholder:"请输入字段信息"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Integer"==t.row.type?a("el-input",{attrs:{type:"number",placeholder:"请输入字段信息"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Date"==t.row.type?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期",size:"large","value-format":"yyyy-MM-dd"},model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}}):e._e(),"Bool"==t.row.type?a("el-radio-group",{model:{value:t.row.extrainfo,callback:function(a){e.$set(t.row,"extrainfo",a)},expression:"scope.row.extrainfo"}},[a("el-radio",{attrs:{label:"Y"}},[e._v("是")]),a("el-radio",{attrs:{label:"N"}},[e._v("否")])],1):e._e()]}}])})],1),a("div",{staticClass:"ExtraInfoTable"})],1)]),a("el-dialog",{staticClass:"addExtraInfoDialog",attrs:{title:"新增字段",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.ExtraInfoDialog}},[a("el-form-item",{attrs:{label:"字段名称: ","label-width":"100px"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"请输入字段名称"},model:{value:e.ExtraInfoDialog.name,callback:function(t){e.$set(e.ExtraInfoDialog,"name",t)},expression:"ExtraInfoDialog.name"}})],1),a("el-form-item",{attrs:{label:"字段类型: ","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择字段类型"},model:{value:e.ExtraInfoDialog.type,callback:function(t){e.$set(e.ExtraInfoDialog,"type",t)},expression:"ExtraInfoDialog.type"}},[a("el-option",{attrs:{label:"String (字符串型)",value:"String"}}),a("el-option",{attrs:{label:"Date (日期型)",value:"Date"}}),a("el-option",{attrs:{label:"Integer (数字型)",value:"Integer"}}),a("el-option",{attrs:{label:"Bool (布尔型)",value:"Bool"}})],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.SubmitNewExtraInfo(e.ExtraInfoDialog)}}},[e._v("确 定")])],1)],1),a("el-dialog",{staticClass:"EditExtraInfoDialog",attrs:{title:"修改字段",visible:e.EditExtraInfoDialog},on:{"update:visible":function(t){e.EditExtraInfoDialog=t}}},[a("el-form",{attrs:{model:e.EditedExtraInfoDialog}},[a("el-form-item",{attrs:{label:"字段: ","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"请选择需要修改的字段"},model:{value:e.EditedExtraInfoDialog.id,callback:function(t){e.$set(e.EditedExtraInfoDialog,"id",t)},expression:"EditedExtraInfoDialog.id"}},e._l(e.ExtraInfoOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("el-form-item",{attrs:{label:"字段名称: ","label-width":"100px"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"需要修改的字段名称"},model:{value:e.EditedExtraInfoDialog.name,callback:function(t){e.$set(e.EditedExtraInfoDialog,"name",t)},expression:"EditedExtraInfoDialog.name"}})],1),a("el-form-item",{attrs:{label:"字段类型: ","label-width":"100px"}},[a("el-select",{attrs:{placeholder:"需要修改的字段类型",size:"larger"},model:{value:e.EditedExtraInfoDialog.type,callback:function(t){e.$set(e.EditedExtraInfoDialog,"type",t)},expression:"EditedExtraInfoDialog.type"}},[a("el-option",{attrs:{label:"String (字符串型)",value:"String"}}),a("el-option",{attrs:{label:"Date (日期型)",value:"Date"}}),a("el-option",{attrs:{label:"Integer (数字型)",value:"Integer"}}),a("el-option",{attrs:{label:"Bool (布尔型)",value:"Bool"}})],1)],1)],1),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{staticClass:"editcancel",on:{click:function(t){e.EditExtraInfoDialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"warning"},on:{click:function(t){return e.SubmitEditedExtraInfo(e.EditedExtraInfoDialog)}}},[e._v("确 定")])],1)],1)],1)},oe=[],le={data:function(){return{form:{name:"",brand:"",type:"",deviceNo:"",crux:"",clazz:""},formLabelWidth:"150px",dialogFormVisible:!1,EditExtraInfoDialog:!1,EditedExtraInfoDialog:{},ExtraInfoDialog:{},ExtraInfoOptions:[],tableData:[],extraid:[],checkedDetail:[],rules:{name:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],brand:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],type:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],deviceNo:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],crux:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}],clazz:[{required:!0,message:"必填字段不能为空！",trigger:"blur"}]}}},methods:{handleDetailSelectionChange:function(e){this.checkedDetail=e},getExtraInfo:function(){var e=this,t=this;t.tableData=[],t.extraid=[],t.ExtraInfoOptions=[],t.request("device/info-field",{},"GET").then((function(e){console.log(e.data);for(var a=0;a<e.data.length;a++){t.extraid.push(e.data[a].id),"Bool"==e.data[a].type?t.tableData.push({extraname:e.data[a].name,extrainfo:"true"==t.$route.query[e.data[a].id]?"Y":"N",type:e.data[a].type}):t.tableData.push({extraname:e.data[a].name,extrainfo:t.$route.query[e.data[a].id],type:e.data[a].type});var s={};s.value=e.data[a].id,s.label=e.data[a].name+"（"+e.data[a].type+"）",t.ExtraInfoOptions.push(s)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},SubmitNewExtraInfo:function(e){var t=this,a=this;""==e.name||void 0==e.type?this.$alert("请将基本信息填写完整！","提示",{confirmButtonText:"确定"}):a.request("device/info-field",{name:e.name,type:e.type},"POST").then((function(s){console.log(s),a.$message({message:"新增字段成功",type:"success"}),a.tableData.push({extraname:e.name,extrainfo:"",type:e.type}),a.request("device/info-field",{},"GET").then((function(t){console.log(t);for(var s=0;s<t.data.length;s++)if(t.data[s].name==e.name){a.extraid.push(t.data[s].id);break}})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})})),a.dialogFormVisible=!1})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},SubmitEditedExtraInfo:function(){var e=this,t=this;if(console.log(t.EditedExtraInfoDialog.name),void 0==t.EditedExtraInfoDialog.id||""==t.EditedExtraInfoDialog.name||void 0==t.EditedExtraInfoDialog.name||void 0==t.EditedExtraInfoDialog.type)t.$message({message:"请将修改字段信息填写完整",type:"warning"});else{var a="device/info-field/edit/"+t.EditedExtraInfoDialog.id;t.request(a,t.EditedExtraInfoDialog,"PUT").then((function(){e.$message({message:"修改成功",type:"success"}),t.EditExtraInfoDialog=!1,t.getExtraInfo(),t.EditedExtraInfoDialog={}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},delectExtraInfo:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("删除后无法更改, 是否确定?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){console.log(t.checkedDetail),t.checkedDetail.forEach((function(a){t.tableData.forEach((function(s,n){if(console.log(a,s),a.extraname==s.extraname){console.log(t.tableData[n]);var o="device/info-field/"+t.extraid[n];t.request(o,{},"DELETE").then((function(a){console.log(a),200==a.status?(t.tableData.splice(n,1),e.$message({message:"删除成功",type:"success"})):e.$message.error("删除失败")})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}))})),setTimeout((function(){t.getExtraInfo()}),300)})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},submitEditDevice:function(e){var t=this,a=this;if(console.log(e),void 0==e.name||void 0==e.brand||void 0==e.type||void 0==e.deviceNo||void 0==e.crux||void 0==e.clazz)this.$alert("请将基本信息填写完整！","提示",{confirmButtonText:"确定"});else{e.crux="Y"==e.crux;for(var s=[],n=0;n<a.tableData.length;n++)"Y"!=a.tableData[n].extrainfo&&"N"!=a.tableData[n].extrainfo||(a.tableData[n].extrainfo="Y"==a.tableData[n].extrainfo?"true":"false"),s.push({field:{id:a.extraid[n]},value:a.tableData[n].extrainfo});a.request("device",{id:this.$route.query.id,name:e.name,brand:e.brand,type:e.type,deviceNo:e.deviceNo,crux:e.crux,clazz:e.clazz,extra:s},"PUT").then((function(e){console.log(e),200==e.status&&(t.$message({message:"修改成功",type:"success"}),t.$router.push("/deviceInformation"))})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}}},created:function(){console.log(this.$route.query);var e=this;e.form.name=this.$route.query.name,e.form.brand=this.$route.query.brand,e.form.type=this.$route.query.type,e.form.deviceNo=this.$route.query.deviceNo,"true"==this.$route.query.crux?e.form.crux="Y":e.form.crux="N",e.form.clazz=this.$route.query.clazz,e.getExtraInfo()}},ie=le,re=(a("7ef6"),Object(r["a"])(ie,ne,oe,!1,null,null,null)),ce=re.exports,de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"main"},[a("el-breadcrumb",{staticClass:"breadcrumb-top",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备管理")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("生成编码")])],1),void 0!=e.url?a("div",{staticClass:"codeimage"},[a("img",{attrs:{src:e.url}})]):e._e(),a("div",{staticClass:"download"},[a("el-button",{on:{click:e.Download}},[e._v("下载到本地")])],1)],1)},ue=[],pe={data:function(){return{url:""}},methods:{downloadIamge:function(e,t){var a=new Image;a.setAttribute("crossOrigin","anonymous"),a.onload=function(){var e=document.createElement("canvas");e.width=a.width,e.height=a.height;var s=e.getContext("2d");s.drawImage(a,0,0,a.width,a.height);var n=e.toDataURL("image/png"),o=document.createElement("a"),l=new MouseEvent("click");o.download=t||"photo",o.href=n,o.dispatchEvent(l)},a.src=e},Download:function(){this.downloadIamge(this.url,"image")}},created:function(){console.log(this.$route.query),this.url="http://1.15.236.205/api/device/barcode/"+this.$route.query.id}},ve=pe,me=(a("2779"),Object(r["a"])(ve,de,ue,!1,null,null,null)),fe=me.exports,ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-AddTask"},[a("el-breadcrumb",{staticClass:"breadcrumb-top",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("新增标准")])],1),a("div",{staticClass:"head-btn"},[a("div",{staticClass:"oper-btns-left"},[a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-plus"},on:{click:e.addNewTask}},[e._v("新增标准 ")]),a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1)]),["ROOT","ADMIN","CREATOR"].includes(e.userRole)?a("div",{staticClass:"oper-btns-right"},[a("el-button",{staticClass:"bigdel-btn",attrs:{icon:"el-icon-delete"},on:{click:e.delectExtraInfo}},[e._v("批量删除")])],1):e._e()]),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskData,stripe:"",border:""},on:{"selection-change":e.handleDetailSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),a("el-table-column",{attrs:{prop:"name",label:"标准名称"}}),a("el-table-column",{attrs:{prop:"no",label:"标准编号"}}),["ROOT","ADMIN","CREATOR"].includes(e.userRole)?a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.showInfo(t.$index)}}},[e._v("以此为模版新增")]),a("el-button",{on:{click:function(a){return e.editTask(t.$index)}}},[e._v("修改标准")]),a("el-button",{on:{click:function(a){return e.deleteTask(t.$index)}}},[e._v("删除")])]}}],null,!1,2819750728)}):e._e()],1),a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[15,30,50,100],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},he=[],be={created:function(){var e=this;e.userRole=this.globaldata.userRole,e.refresh()},data:function(){return{userRole:"",dialogVisible:!1,devicename:"",deviceclazz:"",taskData:[],checkedDetail:[],currentPage:1,page_size:15,page:1,total:0}},methods:{addNewTask:function(){this.$router.push({path:"/addTaskInside"})},showInfo:function(e){console.log(e),this.$router.push({path:"/addTaskInside",query:this.taskData[e]})},editTask:function(e){this.$router.push({path:"/alterTaskcontent",query:this.taskData[e]})},handleDetailSelectionChange:function(e){this.checkedDetail=e},deleteTask:function(e){var t=this,a=this;a.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s="ops/schedule/"+a.taskData[e].taskID;a.request(s,{},"DELETE").then((function(){a.taskData.splice(e,1),t.$message({message:"删除成功",type:"success"})})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))})).catch((function(){a.$message.info("已取消删除")}))},delectExtraInfo:function(){var e=this,t=this;0==this.checkedDetail.length?t.$alert("请先选择要删除的数据","提示",{confirmButtonText:"确定"}):t.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.checkedDetail.forEach((function(a){t.taskData.forEach((function(s,n){if(a.taskID==s.taskID){var o="ops/schedule/"+s.taskID;t.request(o,{},"DELETE").then((function(){t.taskData.splice(n,1),e.$message({message:"删除成功",type:"success"}),t.taskData.splice(n,1),t.checkedDetail.pop()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}))})),setTimeout((function(){t.refresh()}),300)})).catch((function(){e.$message.info("已取消删除")}))},refresh:function(){var e=this,t=this;t.taskData=[],t.currentPage=1;var a="ops/schedule?page=0&size="+t.page_size;t.request(a,{},"GET").then((function(e){t.total=e.data.totalElements;for(var a=0;a<e.data.content.length;a++)t.taskData.push({taskID:e.data.content[a].id,name:e.data.content[a].name,no:e.data.content[a].no});t.$message({message:"刷新成功",type:"success"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},handleSizeChange:function(e){var t=this,a=this;a.taskData=[],a.currentPage=1,console.log(e),a.page_size=e;var s="ops/schedule?page=0&size="+a.page_size;a.request(s,{},"GET").then((function(e){a.total=e.data.totalElements;for(var t=0;t<e.data.content.length;t++)a.taskData.push({taskID:e.data.content[t].id,name:e.data.content[t].name,no:e.data.content[t].no});a.$message({message:"刷新成功",type:"success"})})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handleCurrentChange:function(e){var t=this,a=this;a.taskData=[],a.page=e,a.currentPage=e;var s="ops/schedule?page="+(a.page-1)+"&size="+a.page_size;a.request(s,{},"GET").then((function(e){a.total=e.data.totalElements;for(var t=0;t<e.data.content.length;t++)a.taskData.push({taskID:e.data.content[t].id,name:e.data.content[t].name,no:e.data.content[t].no});a.$message({message:"刷新成功",type:"success"})})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}}},ye=be,Te=(a("a86b"),Object(r["a"])(ye,ge,he,!1,null,null,null)),ke=Te.exports,xe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-AddTaskInside"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("新增标准")])],1),a("div",{staticClass:"Task-container"},[a("div",{staticClass:"Task-box"},[a("el-form",{ref:"form",attrs:{model:e.TaskInfo,"label-position":"left"}},[a("div",{staticClass:"part"},[a("div",{staticClass:"part_left"},[a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task",attrs:{label:"标准名称"}},[a("el-input",{attrs:{placeholder:"请输入标准名称"},model:{value:e.TaskInfo.name,callback:function(t){e.$set(e.TaskInfo,"name",t)},expression:"TaskInfo.name"}})],1),a("el-form-item",{staticClass:"task",attrs:{label:"标准编号"}},[a("el-input",{attrs:{placeholder:"请输入标准编号"},model:{value:e.TaskInfo.no,callback:function(t){e.$set(e.TaskInfo,"no",t)},expression:"TaskInfo.no"}})],1)],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task tasktime",attrs:{label:"保养周期"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择保养周期"},model:{value:e.TaskInfo.scheduleType,callback:function(t){e.$set(e.TaskInfo,"scheduleType",t)},expression:"TaskInfo.scheduleType"}},e._l(e.tasktime,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task tools",attrs:{label:"保养工具及备件"}},[a("el-input",{staticClass:"inputStyle",attrs:{type:"textarea",rows:8},model:{value:e.TaskInfo.tools,callback:function(t){e.$set(e.TaskInfo,"tools",t)},expression:"TaskInfo.tools"}})],1),a("el-form-item",{staticClass:"task remark",attrs:{label:"注意事项"}},[a("el-input",{staticClass:"inputStyle",attrs:{type:"textarea",rows:8},model:{value:e.TaskInfo.remark,callback:function(t){e.$set(e.TaskInfo,"remark",t)},expression:"TaskInfo.remark"}})],1)],1)]),a("div",{staticClass:"part_right"},[a("el-form-item",{attrs:{label:"保养内容"}},[a("i",{staticClass:"el-icon-circle-plus-outline addicon",on:{click:function(t){e.addcontent=!0}}}),a("div",{staticStyle:{"margin-top":"0px"}},e._l(e.TaskInfo.content,(function(t,s){return a("el-collapse",{key:s,on:{change:e.handleChange}},[a("el-collapse-item",{attrs:{title:t.title,name:s}},[a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(t.detail)}})])])],1)})),1)])],1)]),a("div",{staticClass:"Btns"},[a("div",{staticClass:"sub-btn"},[a("el-button",{on:{click:e.submittask}},[e._v("保存并提交")])],1),a("div",{staticClass:"cancel-btn"},[a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)])])],1)]),a("el-dialog",{attrs:{title:"新增保养内容",visible:e.addcontent,width:"670px"},on:{"update:visible":function(t){e.addcontent=t}}},[a("el-form",{attrs:{model:e.TaskInfo}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.TaskInfo.title,callback:function(t){e.$set(e.TaskInfo,"title",t)},expression:"TaskInfo.title"}})],1)],1),a("div",[e._v(" 内容"),a("br"),a("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"180px","margin-top":"5px"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.TaskInfo.detail,callback:function(t){e.$set(e.TaskInfo,"detail",t)},expression:"TaskInfo.detail"}})],1),a("div",{staticStyle:{"margin-top":"40px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addcontent=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitcontent}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"修改保养内容",visible:e.fixcontent,width:"670px"},on:{"update:visible":function(t){e.fixcontent=t}}},[a("el-form",{attrs:{model:e.TaskInfo}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.TaskInfo.title,callback:function(t){e.$set(e.TaskInfo,"title",t)},expression:"TaskInfo.title"}})],1)],1),a("div",[e._v(" 内容"),a("br"),a("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"180px","margin-top":"5px"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.TaskInfo.detail,callback:function(t){e.$set(e.TaskInfo,"detail",t)},expression:"TaskInfo.detail"}})],1),a("div",{staticStyle:{"margin-top":"40px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.fixcontent=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitfix}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"功能选择",visible:e.confirmfunction,width:"350px",center:""},on:{"update:visible":function(t){e.confirmfunction=t}}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.confirmfunction=!1}}},[e._v("仅查看")]),a("el-button",{attrs:{type:"warning"},on:{click:e.editcontent}},[e._v("修改内容")]),a("el-button",{attrs:{type:"danger"},on:{click:e.deletecontent}},[e._v("删除内容")])],1),a("el-upload",{staticClass:"avatar-uploader",staticStyle:{display:"none"},attrs:{"list-type":"picture",action:"","auto-upload":!1,accept:".jpg, .png","show-file-list":!1,"on-change":e.getFile}})],1)},_e=[],Ie=a("953d"),Ce=(a("a753"),a("8096"),a("14e1"),[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["image"]]),Ee={name:"AddTaskInside",components:{quillEditor:Ie["quillEditor"]},created:function(){var e=this,t=this;if(void 0!=this.$route.query.taskID){console.log(this.$route.query);var a="ops/schedule/detail/"+this.$route.query.taskID;t.request(a,{},"GET").then((function(e){t.TaskInfo.scheduleType=e.data.scheduleType,t.TaskInfo.name=e.data.name,t.TaskInfo.no=e.data.no,t.TaskInfo.tools=e.data.tools,t.TaskInfo.remark=e.data.remark,t.TaskInfo.content=e.data.content})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}else console.log("bbb")},data:function(){return{TaskInfo:{scheduleType:"",name:"",no:"",tools:"",remark:"",title:"",detail:"",content:[]},tasktime:[{value:"Predictability",label:"未知"},{value:"Yearly",label:"每年"},{value:"Seasonally",label:"每季度"},{value:"Monthly",label:"每月"},{value:"Weekly",label:"每周"},{value:"Daily",label:"每天"}],addcontent:!1,fixcontent:!1,confirmfunction:!1,contentindex:-1,editorOption:{placeholder:"请输入保养内容",modules:{toolbar:{container:Ce,handlers:{image:function(e){e?document.querySelector(".avatar-uploader input").click():this.quill.format("image",!1)}}}}}}},methods:{handleChange:function(e){console.log(this.TaskInfo.content[e]),void 0!=this.TaskInfo.content[e]&&(this.confirmfunction=!0),this.contentindex=e},onEditorChange:function(e){var t=e.html;console.log(t),this.TaskInfo.detail=t},getFile:function(e){var t=this,a=this;this.getBase64(e.raw).then((function(e){var s=e.split(",");console.log(s,"params"),s.length>0&&a.request("pic",s[1],"POST",{"Content-Type":"text/plain"}).then((function(e){console.log(e);var t="http://1.15.236.205/api/pic/"+e.data,s=a.$refs.myQuillEditor.quill,n=s.getSelection().index;s.insertEmbed(n,"image",t),s.setSelection(n+1)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}))},getBase64:function(e){return new Promise((function(t,a){var s=new FileReader,n="";s.readAsDataURL(e),s.onload=function(){n=s.result},s.onerror=function(e){a(e)},s.onloadend=function(){t(n)}}))},editcontent:function(){console.log(this.TaskInfo.content[this.contentindex]),this.TaskInfo.title=this.TaskInfo.content[this.contentindex].title,this.TaskInfo.detail=this.TaskInfo.content[this.contentindex].detail,this.fixcontent=!0},submitfix:function(){this.TaskInfo.content.splice(this.contentindex,1,{title:this.TaskInfo.title,detail:this.TaskInfo.detail}),this.fixcontent=!1,this.confirmfunction=!1,this.$message({message:"修改成功",type:"success"})},deletecontent:function(){var e=this;console.log(this.TaskInfo.content[this.contentindex]),this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.TaskInfo.content.splice(e.contentindex,1),e.confirmfunction=!1})).catch((function(){e.$message.info("已取消删除")}))},submitcontent:function(){this.addcontent=!1,this.TaskInfo.content.push({title:this.TaskInfo.title,detail:this.TaskInfo.detail}),console.log(this.TaskInfo)},submittask:function(){var e=this,t=this,a={};""==t.TaskInfo.scheduleType||""==t.TaskInfo.name||""==t.TaskInfo.no||""==t.TaskInfo.tools||""==t.TaskInfo.remark||0==t.TaskInfo.content.length?t.$message({message:"请将信息填写完整",type:"warning"}):(a.scheduleType=t.TaskInfo.scheduleType,a.name=t.TaskInfo.name,a.no=t.TaskInfo.no,a.tools=t.TaskInfo.tools,a.remark=t.TaskInfo.remark,a.content=t.TaskInfo.content,t.request("ops/schedule",a,"POST").then((function(e){console.log(e),t.$message({message:"新增成功",type:"success"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))),console.log(a)},cancel:function(){this.$router.push({path:"/addTask"})}}},De=Ee,$e=(a("d590"),Object(r["a"])(De,xe,_e,!1,null,null,null)),we=$e.exports,qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-EditTask"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("修改任务分配")])],1),a("div",{staticClass:"Task-container"},[a("div",{staticClass:"Task-box"},[a("el-form",{ref:"form",attrs:{model:e.TaskInfo,"label-position":"left"}},[a("div",{staticClass:"part"},[a("div",{staticClass:"part_left"},[a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task name",attrs:{label:"设备"}},[a("span",[e._v(" "+e._s(e.TaskInfo.deviceinfo))])])],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task",attrs:{label:"下次保养时间"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.TaskInfo.nextDate,callback:function(t){e.$set(e.TaskInfo,"nextDate",t)},expression:"TaskInfo.nextDate"}})],1)],1)]),a("div",{staticClass:"part_right"},[a("el-form-item",{staticClass:"task name",attrs:{label:"标准（如果需要修改标准，请先解绑）"}},[a("span",[e._v(" "+e._s(e.TaskInfo.task))])]),a("el-form-item",{staticClass:"task",attrs:{label:"人员选择"}},[a("el-select",{attrs:{clearable:"",filterable:"",multiple:"",placeholder:"请选择保养人员"},model:{value:e.TaskInfo.ops,callback:function(t){e.$set(e.TaskInfo,"ops",t)},expression:"TaskInfo.ops"}},e._l(e.OpUsers,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)]),a("div",{staticClass:"Btns"},[a("div",{staticClass:"sub-btn"},[a("el-button",{on:{click:e.submittask}},[e._v("保存并提交")])],1),a("div",{staticClass:"cancel-btn"},[a("el-button",{on:{click:e.cancel}},[e._v("返回")])],1)])])],1)])],1)},Se=[],Re={components:{},created:function(){var e=this,t=this;console.log(this.$route.query),t.TaskInfo.deviceinfo=this.$route.query.devicename+"（"+this.$route.query.deviceNo+"）",t.TaskInfo.task=1*this.$route.query.taskid,t.TaskInfo.nextDate=this.$route.query.nextDate;var a="ops/schedule/status/"+this.$route.query.taskid;t.request(a,{},"GET").then((function(e){console.log(e.data),t.TaskInfo.nextDate=e.data.nextDate})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){t.request("user/query?role==OPERATOR",{},"GET").then((function(e){for(var a=0;a<e.data.content.length;a++){console.log(e.data.content[a]);var s={};s.value=e.data.content[a].id,s.label=e.data.content[a].username+"(姓名："+e.data.content[a].name+")",t.OpUsers.push(s)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}),300);var s="ops/schedule/detail/"+this.$route.query.taskid;t.request(s,{},"GET").then((function(e){console.log(e.data),t.TaskInfo.task=e.data.name+"("+e.data.no+")";for(var a=0;a<e.data.ops.length;a++)t.TaskInfo.ops.push(e.data.ops[a].id)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},data:function(){return{TaskInfo:{deviceinfo:"",nextDate:"",ops:[],task:""},collapseinfo:[],OpUsers:[],TaskOptions:[]}},methods:{submittask:function(){var e=this;if(console.log(e.TaskInfo),""==e.$route.query.deviceID)e.$message({message:"未分配设备，请先分配设备！",type:"error"});else if(""==e.TaskInfo.nextDate||0==e.TaskInfo.task.length||0==e.TaskInfo.ops.length)e.$message({message:"请将信息填写完整",type:"warning"});else if(new Date(e.TaskInfo.nextDate).getTime()<(new Date).getTime())e.$message({message:"下次开始日期应大于今天",type:"warning"});else{var t=[],a=[];t.push({id:e.TaskInfo.ops}),a.push({id:e.TaskInfo.task});var s="ops/schedule/detail/"+this.$route.query.taskid;e.request(s,{},"GET").then((function(a){console.log(a.data);var n={};n.content=a.data.content,n.id=a.data.id,n.name=a.data.name,n.remark=a.data.remark,n.no=a.data.no,n.startDate=e.TaskInfo.nextDate,n.scheduleType=a.data.scheduleType,n.tools=a.data.tools,n.device=[{id:e.$route.query.deviceID}],n.ops=t,console.log(n),setTimeout((function(){e.request(s,n,"PUT").then((function(t){console.log(t),e.$message({message:"修改成功",type:"success"})})).catch((function(){e.$message({message:"请先解绑！",type:"error"})}))}),500)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},cancel:function(){this.$router.push({path:"/totalTaskList"})}}},ze=Re,Oe=(a("2f03"),Object(r["a"])(ze,qe,Se,!1,null,null,null)),Ae=Oe.exports,Pe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-AddTaskContent"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("修改标准")])],1),a("div",{staticClass:"Task-container"},[a("div",{staticClass:"Task-box"},[a("el-form",{ref:"form",attrs:{model:e.TaskInfo,"label-position":"left"}},[a("div",{staticClass:"part"},[a("div",{staticClass:"part_left"},[a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task",attrs:{label:"标准名称"}},[a("el-input",{attrs:{placeholder:"请输入标准名称"},model:{value:e.TaskInfo.name,callback:function(t){e.$set(e.TaskInfo,"name",t)},expression:"TaskInfo.name"}})],1),a("el-form-item",{staticClass:"task",attrs:{label:"标准编号"}},[a("el-input",{attrs:{placeholder:"请输入标准编号"},model:{value:e.TaskInfo.no,callback:function(t){e.$set(e.TaskInfo,"no",t)},expression:"TaskInfo.no"}})],1)],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task",attrs:{label:"保养周期"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择保养周期"},model:{value:e.TaskInfo.scheduleType,callback:function(t){e.$set(e.TaskInfo,"scheduleType",t)},expression:"TaskInfo.scheduleType"}},e._l(e.tasktime,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("div",{staticClass:"part_left_0"},[a("el-form-item",{staticClass:"task tools",attrs:{label:"保养工具及备件"}},[a("el-input",{staticClass:"inputStyle",attrs:{type:"textarea",rows:8},model:{value:e.TaskInfo.tools,callback:function(t){e.$set(e.TaskInfo,"tools",t)},expression:"TaskInfo.tools"}})],1),a("el-form-item",{staticClass:"task remark",attrs:{label:"注意事项"}},[a("el-input",{staticClass:"inputStyle",attrs:{type:"textarea",rows:8},model:{value:e.TaskInfo.remark,callback:function(t){e.$set(e.TaskInfo,"remark",t)},expression:"TaskInfo.remark"}})],1)],1)]),a("div",{staticClass:"part_right"},[a("el-form-item",{attrs:{label:"保养内容"}},[a("i",{staticClass:"el-icon-circle-plus-outline addicon",on:{click:function(t){e.addcontent=!0}}}),a("div",{staticStyle:{"margin-top":"0px"}},e._l(e.TaskInfo.content,(function(t,s){return a("el-collapse",{key:s,on:{change:e.handleChange}},[a("el-collapse-item",{attrs:{title:t.title,name:s}},[a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(t.detail)}})])])],1)})),1)])],1)]),a("div",{staticClass:"Btns"},[a("div",{staticClass:"sub-btn"},[a("el-button",{on:{click:e.submittask}},[e._v("保存并提交")])],1),a("div",{staticClass:"cancel-btn"},[a("el-button",{on:{click:e.cancel}},[e._v("取消")])],1)])])],1)]),a("el-dialog",{attrs:{title:"新增保养内容",visible:e.addcontent,width:"670px"},on:{"update:visible":function(t){e.addcontent=t}}},[a("el-form",{attrs:{model:e.TaskInfo}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.TaskInfo.title,callback:function(t){e.$set(e.TaskInfo,"title",t)},expression:"TaskInfo.title"}})],1)],1),a("div",[e._v(" 内容"),a("br"),a("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"180px","margin-top":"5px"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.TaskInfo.detail,callback:function(t){e.$set(e.TaskInfo,"detail",t)},expression:"TaskInfo.detail"}})],1),a("div",{staticStyle:{"margin-top":"40px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addcontent=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitcontent}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"修改保养内容",visible:e.fixcontent,width:"670px"},on:{"update:visible":function(t){e.fixcontent=t}}},[a("el-form",{attrs:{model:e.TaskInfo}},[a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:e.TaskInfo.title,callback:function(t){e.$set(e.TaskInfo,"title",t)},expression:"TaskInfo.title"}})],1)],1),a("div",[e._v(" 内容"),a("br"),a("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"180px","margin-top":"5px"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.TaskInfo.detail,callback:function(t){e.$set(e.TaskInfo,"detail",t)},expression:"TaskInfo.detail"}})],1),a("div",{staticStyle:{"margin-top":"40px"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.fixcontent=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitfix}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"功能选择",visible:e.confirmfunction,width:"350px",center:""},on:{"update:visible":function(t){e.confirmfunction=t}}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.confirmfunction=!1}}},[e._v("仅查看")]),a("el-button",{attrs:{type:"warning"},on:{click:e.editcontent}},[e._v("修改内容")]),a("el-button",{attrs:{type:"danger"},on:{click:e.deletecontent}},[e._v("删除内容")])],1),a("el-upload",{staticClass:"avatar-uploader",staticStyle:{display:"none"},attrs:{"list-type":"picture",action:"","auto-upload":!1,accept:".jpg, .png","show-file-list":!1,"on-change":e.getFile}})],1)},Ne=[],Ge=[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["image"]],Le={name:"AddTaskInside",components:{quillEditor:Ie["quillEditor"]},created:function(){var e=this,t=this;if(void 0!=this.$route.query.taskID){console.log(this.$route.query);var a="ops/schedule/detail/"+this.$route.query.taskID;t.request(a,{},"GET").then((function(e){t.TaskInfo.scheduleType=e.data.scheduleType,t.TaskInfo.name=e.data.name,t.TaskInfo.no=e.data.no,t.TaskInfo.tools=e.data.tools,t.TaskInfo.remark=e.data.remark,t.TaskInfo.content=e.data.content})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},data:function(){return{TaskInfo:{scheduleType:"",name:"",no:"",tools:"",remark:"",title:"",detail:"",content:[]},tasktime:[{value:"Predictability",label:"未知"},{value:"Yearly",label:"每年"},{value:"Seasonally",label:"每季度"},{value:"Monthly",label:"每月"},{value:"Weekly",label:"每周"},{value:"Daily",label:"每天"}],addcontent:!1,fixcontent:!1,confirmfunction:!1,contentindex:-1,editorOption:{placeholder:"请输入保养内容",modules:{toolbar:{container:Ge,handlers:{image:function(e){e?document.querySelector(".avatar-uploader input").click():this.quill.format("image",!1)}}}}}}},methods:{handleChange:function(e){console.log(this.TaskInfo.content[e]),void 0!=this.TaskInfo.content[e]&&(this.confirmfunction=!0),this.contentindex=e},onEditorChange:function(e){var t=e.html;console.log(t),this.TaskInfo.detail=t},getFile:function(e){var t=this,a=this;this.getBase64(e.raw).then((function(e){var s=e.split(",");console.log(s,"params"),s.length>0&&a.request("pic",s[1],"POST",{"Content-Type":"text/plain"}).then((function(e){var t="http://1.15.236.205/api/pic/"+e.data,s=a.$refs.myQuillEditor.quill,n=s.getSelection().index;s.insertEmbed(n,"image",t),s.setSelection(n+1)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}))},getBase64:function(e){return new Promise((function(t,a){var s=new FileReader,n="";s.readAsDataURL(e),s.onload=function(){n=s.result},s.onerror=function(e){a(e)},s.onloadend=function(){t(n)}}))},editcontent:function(){console.log(this.TaskInfo.content[this.contentindex]),this.TaskInfo.title=this.TaskInfo.content[this.contentindex].title,this.TaskInfo.detail=this.TaskInfo.content[this.contentindex].detail,this.fixcontent=!0},submitfix:function(){this.TaskInfo.content.splice(this.contentindex,1,{title:this.TaskInfo.title,detail:this.TaskInfo.detail}),this.fixcontent=!1,this.confirmfunction=!1,this.$message({message:"修改成功",type:"success"})},deletecontent:function(){var e=this;console.log(this.TaskInfo.content[this.contentindex]),this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.TaskInfo.content.splice(e.contentindex,1),e.confirmfunction=!1})).catch((function(){e.$message.info("已取消删除")}))},submitcontent:function(){this.addcontent=!1,this.TaskInfo.content.push({title:this.TaskInfo.title,detail:this.TaskInfo.detail}),console.log(this.TaskInfo)},submittask:function(){var e=this,t=this;if(""==t.TaskInfo.scheduleType||""==t.TaskInfo.name||""==t.TaskInfo.no||""==t.TaskInfo.tools||""==t.TaskInfo.remark||0==t.TaskInfo.content.length)t.$message({message:"请将信息填写完整",type:"warning"});else{var a="ops/schedule/detail/"+t.$route.query.taskID;t.request(a,{},"GET").then((function(s){var n={};n.content=t.TaskInfo.content,n.id=s.data.id,n.name=t.TaskInfo.name,n.remark=t.TaskInfo.remark,n.startDate=t.TaskInfo.startDate,n.scheduleType=t.TaskInfo.scheduleType,n.no=t.TaskInfo.no,n.tools=t.TaskInfo.tools,n.device=s.data.device,n.ops=s.data.ops,t.request(a,n,"PUT").then((function(e){console.log(e),t.$message({message:"修改成功",type:"success"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},cancel:function(){this.$router.push({path:"/addTask"})}}},Be=Le,Me=(a("cb33"),Object(r["a"])(Be,Pe,Ne,!1,null,null,null)),Ve=Me.exports,Ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-TaskDetailInfo"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("任务名称："+e._s(e.name)+"（编号："+e._s(e.no)+"） ")])],1),a("div",{staticClass:"Tabs"},[a("el-tabs",{attrs:{"tab-position":"top"},model:{value:e.tabsActiveName,callback:function(t){e.tabsActiveName=t},expression:"tabsActiveName"}},[a("el-tab-pane",{attrs:{label:"保养内容",name:"first"}},[a("div",{staticClass:"tools_remark"},[a("div",{staticClass:"tools"},[e._v(" 工具及备件： "),a("span",[e._v(e._s(e.tools))])]),a("div",{staticClass:"tools"},[e._v(" 注意事项： "),a("span",[e._v(e._s(e.remark))])])]),a("h1",[e._v("保养步骤：")]),["OPERATOR"].includes(e.userRole)?a("div",e._l(e.content,(function(t,s){return a("div",{key:s,staticClass:"content"},[a("el-checkbox-group",{model:{value:e.checkList,callback:function(t){e.checkList=t},expression:"checkList"}},[a("el-checkbox",{attrs:{label:s}},[a("div",{staticClass:"title"},[a("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.contentinfotitle))])])]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(t.contentinfodetail)}})])],1)],1)})),0):e._e(),["ROOT","ADMIN","CREATOR","SUPERVISOR"].includes(e.userRole)?a("div",e._l(e.content,(function(t,s){return a("div",{key:s,staticClass:"content"},[a("div",{staticClass:"title"},[a("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(t.contentinfotitle))])]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(t.contentinfodetail)}})])])})),0):e._e(),e.checkList.length==e.content.length?a("div",{staticClass:"form"},[a("h1",[e._v("记录：")]),a("el-form",{ref:"form",staticStyle:{"margin-top":"10px"},attrs:{model:e.form,"label-position":"left"}},[a("el-form-item",{attrs:{label:"完成记录: ","label-width":e.formLabelWidth,prop:"record"}},[a("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"70%","margin-top":"5px",width:"100%"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.form.record,callback:function(t){e.$set(e.form,"record",t)},expression:"form.record"}})],1),a("el-form-item",{attrs:{label:"是否「不能自我修复」:","label-width":"180px",prop:"hasException"}},[a("el-switch",{attrs:{"active-text":"是"},model:{value:e.form.hasException,callback:function(t){e.$set(e.form,"hasException",t)},expression:"form.hasException"}})],1),e.form.hasException?a("el-form-item",{attrs:{label:"异常报告: ","label-width":e.formLabelWidth,prop:"report"}},[a("el-input",{attrs:{autocomplete:"off",placeholder:"报告「不能自我修复」的异常详情"},model:{value:e.form.report,callback:function(t){e.$set(e.form,"report",t)},expression:"form.report"}})],1):e._e(),e.form.hasException?a("el-form-item",{attrs:{label:"「自我修复」过程: ","label-width":e.formLabelWidth,prop:"fix"}},[a("el-input",{attrs:{placeholder:"简述「自我修复」过程"},model:{value:e.form.fix,callback:function(t){e.$set(e.form,"fix",t)},expression:"form.fix"}})],1):e._e()],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submitrecord}},[e._v("提 交")])],1)],1):e._e()]),a("el-tab-pane",{attrs:{label:"保养记录",name:"second"}},[a("div",[a("el-table",{staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskrecordtableData,stripe:"",border:""}},[a("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[a("el-form-item",{attrs:{label:"完成记录"}},[a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(t.row.record)}})])]),a("el-form-item",{attrs:{label:"异常报告"}},[a("span",[e._v(e._s(t.row.report))])]),a("el-form-item",{attrs:{label:"「自我修复」的异常修复过程"}},[a("span",[e._v(e._s(t.row.fix))])])],1)]}}])}),a("el-table-column",{attrs:{prop:"id",label:"记录ID",width:"200"}}),a("el-table-column",{attrs:{prop:"date",label:"计划保养时间"}}),a("el-table-column",{attrs:{prop:"realDate",label:"实际保养时间"}}),a("el-table-column",{attrs:{prop:"hasException",label:"是否存在「不能自我修复」的异常",width:"140"}}),a("el-table-column",{attrs:{prop:"opUser",label:"保养人员"}})],1),a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[15,30,50,100],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])],1)],1),a("el-upload",{staticClass:"avatar-uploader",staticStyle:{display:"none"},attrs:{"list-type":"picture",action:"","auto-upload":!1,accept:".jpg, .png","show-file-list":!1,"on-change":e.getFile}})],1)},Fe=[],je=[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["image"]],We={created:function(){var e=this,t=this;t.userRole=this.globaldata.userRole,t.userid=this.globaldata.userid,t.taskid=t.$route.query.taskid;var a="ops/schedule/detail/"+t.$route.query.taskid;t.request(a,{},"GET").then((function(a){if(console.log(a.data),t.name=a.data.name,t.no=a.data.no,""!=a.data.content)for(var s=0;s<a.data.content.length;s++)t.content.push({contentinfotitle:a.data.content[s].title,contentinfodetail:a.data.content[s].detail});t.tools=a.data.tools,t.remark=a.data.remark;for(var n=0;n<a.data.ops.length;n++){var o="user/"+a.data.ops[n].id;t.request(o,{},"GET").then((function(e){t.users.push({name:e.data.name,username:e.data.username,useremail:e.data.email,avatar:"http://47.102.214.37:8080/pic/"+e.data.avatar})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){var a="ops/record/schedule/"+t.$route.query.taskid+"?page=0&size="+t.page_size;t.request(a,{},"GET").then((function(a){console.log(a.data),t.total=a.data.totalElements;for(var s=function(s){var n={};n.id=a.data.content[s].id,null==a.data.content[s].date?n.date="暂无":n.date=a.data.content[s].date,null==a.data.content[s].realDate?n.realDate="暂无":n.realDate=a.data.content[s].realDate,null==a.data.content[s].fix?n.fix="暂无":n.fix=a.data.content[s].fix,0==a.data.content[s].hasException?n.hasException="否":n.hasException="是",null==a.data.content[s].record?n.record="暂无":n.record=a.data.content[s].record,null==a.data.content[s].report?n.report="暂无":n.report=a.data.content[s].report,n.ifpicexist=!0,null==a.data.content[s].pic?n.ifpicexist=!1:n.pic="http://1.15.236.205/pic/"+a.data.content[s].pic,setTimeout((function(){if(null==a.data.content[s].opUser)n.opUser="暂无";else{var o="user/"+a.data.content[s].opUser.id;t.request(o,{},"GET").then((function(e){n.opUser=e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}),300),t.taskrecordtableData.unshift(n)},n=0;n<a.data.content.length;n++)s(n)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}),300)},data:function(){return{userRole:"",userid:"",taskid:"",name:null,no:null,opUserid:"",tabsActiveName:"first",users:[],scheduleType:null,startDate:null,scheduleType_info:null,devicetableData:[],content:[],checkList:[],tools:null,remark:null,taskrecordtableData:[],form:{fix:"",record:"",report:"",hasException:!1},formLabelWidth:"150px",fileList:[],dialogVisible:!1,editorOption:{placeholder:"请输入完成记录",modules:{toolbar:{container:je,handlers:{image:function(e){e?document.querySelector(".avatar-uploader input").click():this.quill.format("image",!1)}}}}},currentPage:1,page_size:15,page:1,total:0}},methods:{onEditorChange:function(e){var t=e.html;console.log(t),this.form.record=t},getFile:function(e){var t=this;this.getBase64(e.raw).then((function(e){var a=e.split(",");a.length>0&&t.request("pic",a[1],"POST",{"Content-Type":"text/plain"}).then((function(e){console.log(e);var a="http://1.15.236.205/pic/"+e.data,s=t.$refs.myQuillEditor.quill,n=s.getSelection().index;s.insertEmbed(n,"image",a),s.setSelection(n+1)}))}))},getBase64:function(e){return new Promise((function(t,a){var s=new FileReader,n="";s.readAsDataURL(e),s.onload=function(){n=s.result},s.onerror=function(e){a(e)},s.onloadend=function(){t(n)}}))},submitrecord:function(){var e=this;console.log(e.form),e.opUserid=this.globaldata.userid,setTimeout((function(){if(""==e.form.record)e.$message({message:"请将信息填写完整",type:"warning"});else{var t={};t.fix=e.form.fix,t.record=e.form.record,t.report=e.form.report,0==e.form.hasException?t.hasException=!1:t.hasException=!0,t.schedule={id:1*e.$route.query.taskid},t.opUser={id:e.opUserid},setTimeout((function(){console.log(t),e.request("ops/record",t,"POST").then((function(t){console.log(t),e.$message({message:"新增成功",type:"success"}),1==e.form.hasException&&e.$router.push({path:"/fixApply"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}),300)}}),300)},handleSizeChange:function(e){var t=this,a=this;a.currentPage=1,a.page_size=e,a.taskrecordtableData=[],console.log(e);var s="ops/record/schedule/"+a.$route.query.taskid+"?page=0&size="+a.page_size;console.log(s),a.request(s,{},"GET").then((function(e){console.log(e.data),a.total=e.data.totalElements;for(var t=0;t<e.data.content.length;t++){var s={};s.id=e.data.content[t].id,null==e.data.content[t].date?s.date="暂无":s.date=e.data.content[t].date,null==e.data.content[t].realDate?s.realDate="暂无":s.realDate=e.data.content[t].realDate,null==e.data.content[t].fix?s.fix="暂无":s.fix=e.data.content[t].fix,0==e.data.content[t].hasException?s.hasException="否":s.hasException="是",null==e.data.content[t].record?s.record="暂无":s.record=e.data.content[t].record,null==e.data.content[t].report?s.report="暂无":s.report=e.data.content[t].report,s.ifpicexist=!0,null==e.data.content[t].pic?s.ifpicexist=!1:s.pic="http://1.15.236.205/api/pic/"+e.data.content[t].pic,a.taskrecordtableData.unshift(s)}setTimeout((function(){a.$message({message:"刷新成功",type:"success"})}),300)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handleCurrentChange:function(e){var t=this,a=this;a.page=e,a.currentPage=e,console.log(e);var s="ops/record/schedule/"+a.$route.query.taskid+"?page="+(a.page-1)+"&size="+a.page_size;console.log(s),a.request(s,{},"GET").then((function(e){console.log(e.data),a.taskrecordtableData=[],a.total=e.data.totalElements;for(var t=0;t<e.data.content.length;t++){var s={};s.id=e.data.content[t].id,null==e.data.content[t].date?s.date="暂无":s.date=e.data.content[t].date,null==e.data.content[t].realDate?s.realDate="暂无":s.realDate=e.data.content[t].realDate,null==e.data.content[t].fix?s.fix="暂无":s.fix=e.data.content[t].fix,0==e.data.content[t].hasException?s.hasException="否":s.hasException="是",null==e.data.content[t].record?s.record="暂无":s.record=e.data.content[t].record,null==e.data.content[t].report?s.report="暂无":s.report=e.data.content[t].report,s.ifpicexist=!0,null==e.data.content[t].pic?s.ifpicexist=!1:s.pic="http://1.15.236.205/api/pic/"+e.data.content[t].pic,a.taskrecordtableData.unshift(s)}setTimeout((function(){a.$message({message:"刷新成功",type:"success"})}),300)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}},components:{quillEditor:Ie["quillEditor"]}},Je=We,Ye=(a("a88f"),Object(r["a"])(Je,Ue,Fe,!1,null,null,null)),He=Ye.exports,Qe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-TotalTaskList"},[a("div",{staticClass:"head-btn"},[a("div",{staticClass:"oper-btns-left"},["OPERATOR"!=e.userRole?a("div",{staticClass:"select"},[a("el-select",{staticStyle:{"margin-left":"5px"},attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.selectchange},model:{value:e.selectvalue,callback:function(t){e.selectvalue=t},expression:"selectvalue"}},e._l(e.selectoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1):e._e(),"OPERATOR"!=e.userRole?a("div",e._l(e.dynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1):e._e(),"OPERATOR"!=e.userRole?a("div",{staticClass:"search"},[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1):e._e(),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.getAllDevice}},[e._v("刷新列表 ")])],1),a("div",{staticClass:"refresh check"},[["ROOT"].includes(e.userRole)?a("el-button",{attrs:{icon:"el-icon-coordinate"},on:{click:e.checkall}},[e._v("立即检查所有保养完成状态 ")]):e._e()],1)])]),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"序号",width:"60"}}),a("el-table-column",{attrs:{prop:"devicename",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"deviceNo",label:"设备编号"}}),a("el-table-column",{attrs:{prop:"taskname",label:"标准名称"}}),a("el-table-column",{attrs:{prop:"taskno",label:"标准编号",width:"200"}}),a("el-table-column",{attrs:{prop:"nextDate",label:"下次保养时间",width:"120"}}),a("el-table-column",{attrs:{prop:"opuser",label:"人员"}}),a("el-table-column",{attrs:{prop:"deadline",label:"剩余天数"}}),["ROOT","ADMIN","CREATOR","SUPERVISOR"].includes(e.userRole)?a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[void 0!=t.row.taskname&&["OPERATOR"].includes(e.userRole)?a("el-button",{on:{click:function(a){return e.handleDetail(t.row)}}},[e._v("执行")]):e._e(),void 0==t.row.taskname||["OPERATOR"].includes(e.userRole)?e._e():a("el-button",{on:{click:function(a){return e.handleDetail(t.row)}}},[e._v("查看")]),void 0!=t.row.taskname?a("el-button",{on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("修改")]):e._e(),void 0!=t.row.taskname?a("el-button",{on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("解绑")]):e._e()]}}],null,!1,1314623322)}):a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.handleDetail(t.row)}}},[e._v("执行")])]}}])})],1),e.ifsearch||"OPERATOR"==e.userRole?e._e():a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[15,30,50,100],"page-size":e.page_size,layout:"slot, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}},[a("span",{staticStyle:{"font-size":"14px",color:"#888","font-weight":"normal"}},[e._v("共"),a("span",{staticStyle:{"font-size":"14px",color:"#000","font-weight":"bold"}},[e._v(e._s(e.total))]),e._v("个设备 （当前页最多展示"),a("span",{staticStyle:{"font-size":"14px",color:"#000","font-weight":"bold"}},[e._v(e._s(e.page_size))]),e._v("个设备） ")])])],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},[["name","no"].includes(e.selectvalue)?a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.selectmodel,callback:function(t){e.selectmodel=t},expression:"selectmodel"}}):e._e(),"scheduleType"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择保养周期",filterable:"",clearable:""},model:{value:e.scheduleTypevalue,callback:function(t){e.scheduleTypevalue=t},expression:"scheduleTypevalue"}},e._l(e.scheduleTypeoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"device"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.deviceselectchange},model:{value:e.selectvalue2,callback:function(t){e.selectvalue2=t},expression:"selectvalue2"}},e._l(e.deviceoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"device"==e.selectvalue?a("div",{staticStyle:{"margin-top":"10px"}},e._l(e.devicedynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.devicehandleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1):e._e(),"ops"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择保养人员",filterable:"",clearable:"",multiple:""},model:{value:e.opsvalue,callback:function(t){e.opsvalue=t},expression:"opsvalue"}},e._l(e.opsoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"startDate"==e.selectvalue?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.datevalue,callback:function(t){e.datevalue=t},expression:"datevalue"}}):e._e(),"timeChoose"==e.selectvalue?a("el-date-picker",{attrs:{type:"date",placeholder:"选择开始日期","value-format":"yyyy-MM-dd"},model:{value:e.start,callback:function(t){e.start=t},expression:"start"}}):e._e(),"timeChoose"==e.selectvalue?a("el-date-picker",{staticStyle:{"margin-top":"20px"},attrs:{type:"date",placeholder:"选择结束日期","value-format":"yyyy-MM-dd"},model:{value:e.end,callback:function(t){e.end=t},expression:"end"}}):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitselect}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchDeviceVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchDeviceVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.devicevalue,callback:function(t){e.devicevalue=t},expression:"devicevalue"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchDeviceVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.devicesubmitselect}},[e._v("确 定")])],1)],1)],1)},Xe=[],Ze={created:function(){var e=this,t=this;t.userRole=t.globaldata.userRole,t.userid=t.globaldata.userid,0!=t.globaldata.taskselectInfo.length?(t.selectInfo=t.globaldata.taskselectInfo,t.dynamicTags=t.globaldata.taskdynamicTags,t.search()):setTimeout((function(){t.getAllDevice()}),300),t.request("device/info-field",{},"GET").then((function(e){for(var a=0;a<e.data.length;a++)t.deviceoptions[1].options.push({value:e.data[a].id,label:e.data[a].name})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),t.request("user/query?role==OPERATOR",{},"GET").then((function(e){console.log(e.data);for(var a=0;a<e.data.content.length;a++)t.opsoptions[0].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},data:function(){return{userRole:"",userid:-1,tableData:[],ifsearch:!1,selectoptions:[{label:"字段",options:[{value:"name",label:"标准名称"},{value:"no",label:"标准编号"},{value:"scheduleType",label:"保养周期"},{value:"device",label:"设备"},{value:"ops",label:"人员"},{value:"startDate",label:"开始时间"}]},{label:"时间范围",options:[{value:"timeChoose",label:"时间范围"}]}],selectvalue:"",selectmodel:"",dialogSearchVisible:!1,selectInfo:[],dynamicTags:[],scheduleTypevalue:"",scheduleTypeoptions:[{label:"保养周期",options:[{value:"Monthly",label:"月保养"},{value:"Yearly",label:"年保养"},{value:"Seasonally",label:"季度保养"},{value:"Daily",label:"日保养"},{value:"Weekly",label:"周保养"}]}],devicevalue:"",deviceoptions:[{label:"基本字段",options:[{value:"name",label:"设备名称"},{value:"brand",label:"设备品牌"},{value:"type",label:"设备型号/规格"},{value:"deviceNo",label:"设备编号"},{value:"crux",label:"是否为关键设备"},{value:"clazz",label:"设备分类"}]},{label:"附加字段",options:[]}],devicedynamicTags:[],selectvalue2:"",selectInfo2:[],dialogSearchDeviceVisible:!1,opsvalue:"",opsoptions:[{label:"人员列表",options:[]}],datevalue:"",start:"",end:"",currentPage:1,page_size:15,page:1,total:0,index:1,push_obj:{}}},methods:{selectchange:function(){this.dialogSearchVisible=!0},deviceselectchange:function(){this.dialogSearchDeviceVisible=!0,this.devicevalue=""},devicesubmitselect:function(){this.dialogSearchDeviceVisible=!1,this.selectInfo2.push({ziduan:this.selectvalue2,value:this.devicevalue}),this.devicedynamicTags.push(this.selectvalue+" / "+this.devicevalue)},searchDevice:function(){var e=this,t=this,a=[],s="";if(s="device/query?"+t.selectInfo2[0].ziduan+"=L"+t.selectInfo2[0].value,1==t.selectInfo2.length)t.request(s,{},"GET").then((function(e){console.log(e.data);for(var s=0;s<e.data.content.length;s++)a.push(e.data.content[s].id);t.selectInfo.push({ziduan:"device",value:a}),t.dynamicTags.push("device / "+a)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));else{for(var n=1;n<t.selectInfo2.length;n++)s=s+"&"+t.selectInfo2[n].ziduan+"=L"+t.selectInfo2[n].value;t.request(s,{},"GET").then((function(e){console.log(e.data);for(var s=0;s<e.data.content.length;s++)a.push(e.data.content[s].id);t.selectInfo.push({ziduan:"device",value:a}),t.dynamicTags.push("device / "+a)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},devicehandleClose:function(e){var t=this.devicedynamicTags.indexOf(e);console.log(t),this.devicedynamicTags.splice(t,1),this.selectInfo2.splice(t,1)},submitselect:function(){var e=this,t=this;if(this.dialogSearchVisible=!1,"scheduleType"==this.selectvalue)this.selectInfo.push({ziduan:this.selectvalue,value:this.scheduleTypevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.scheduleTypevalue);else if("ops"==this.selectvalue)console.log(this.opsvalue),this.selectInfo.push({ziduan:this.selectvalue,value:this.opsvalue}),this.dynamicTags.push(this.selectvalue+" / "+this.opsvalue);else if("device"==this.selectvalue)console.log(this.devicevalue),t.searchDevice();else if("timeChoose"==this.selectvalue){t.tableData=[],t.ifsearch=!0,t.selectInfo=[],t.selectvalue="",t.selectmodel="",t.dynamicTags=[],t.globaldata.deviceselectInfo=[],t.globaldata.devicedynamicTags=[];var a="ops/query?startDate=B"+this.start+","+this.end;t.request(a,{},"GET").then((function(a){console.log(a.data),t.total=a.data.totalElements;for(var s=function(s){var n={opuser:"",devicename:"",deviceNo:""};n.id=0==a.data.content[s].device.length?"暂无":a.data.content[s].device[0].id,n.taskname=null==a.data.content[s].name?"未分配":a.data.content[s].name,n.taskno=null==a.data.content[s].no?"未分配":a.data.content[s].no;var o="ops/schedule/status/"+a.data.content[s].id;t.request(o,{},"GET").then((function(e){null==e.data.nextDate?n.nextDate="暂无":n.nextDate=e.data.nextDate,null==e.data.nextDateDay?n.deadline="暂无":n.deadline=e.data.nextDateDay})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){if(0==a.data.content[s].device.length)n.devicename="暂未分配",n.deviceNo="暂未分配";else for(var o=0;o<a.data.content[s].device.length;o++){var l="device/"+a.data.content[s].device[o].id;t.request(l,{},"GET").then((function(e){n.devicename=e.data.name,n.deviceNo=e.data.deviceNo})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){if(0==a.data.content[s].ops.length)n.opuser="暂未分配";else for(var o=0;o<a.data.content[s].ops.length;o++){var l="user/"+a.data.content[s].ops[o].id;t.request(l,{},"GET").then((function(e){n.opuser=e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){t.tableData.push(n)}),600)}),300)}),300)},n=0;n<a.data.content.length;n++)s(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),600)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}else this.selectInfo.push({ziduan:this.selectvalue,value:this.selectmodel}),this.dynamicTags.push(this.selectvalue+" / "+this.selectmodel)},handleClose:function(e){var t=this.dynamicTags.indexOf(e);console.log(t),this.dynamicTags.splice(t,1),this.selectInfo.splice(t,1)},checkall:function(){var e=this;this.request("root/refresh",{},"GET").then((function(t){console.log(t.data),"ok"==t.data.message&&e.$message({message:"已更新至最新状态",type:"success"})})).catch((function(){e.$message({message:"更新失败",type:"error"})}))},search:function(){var e=this,t=this,a="";if(t.ifsearch=!0,t.index=1,t.tableData=[],0==t.selectInfo.length)t.$message({message:"请输入搜索字段",type:"warning"});else{if("name"==t.selectInfo[0].ziduan)a="ops/query?"+t.selectInfo[0].ziduan+"=L"+t.selectInfo[0].value;else if(console.log(t.selectInfo[0]),"device"==t.selectInfo[0].ziduan||"ops"==t.selectInfo[0].ziduan)if(t.selectInfo[0].value.length>1){a="ops/query?"+t.selectInfo[0].ziduan+"=I"+t.selectInfo[0].value[0];for(var s=1;s<t.selectInfo[0].value.length;s++)a=a+","+t.selectInfo[0].value[s]}else a="ops/query?"+t.selectInfo[0].ziduan+"=="+t.selectInfo[0].value;else a="ops/query?"+t.selectInfo[0].ziduan+"=="+t.selectInfo[0].value;if(1==t.selectInfo.length)t.request(a,{},"GET").then((function(a){console.log(a.data),t.total=a.data.totalElements;for(var s=function(s){var n={opuser:"",devicename:"",deviceNo:"",deviceID:""};n.id=0==a.data.content[s].device.length?"暂无":t.index++,n.taskname=null==a.data.content[s].name?"未分配":a.data.content[s].name,n.taskno=null==a.data.content[s].no?"未分配":a.data.content[s].no,n.taskid=a.data.content[s].id;var o="ops/schedule/status/"+a.data.content[s].id;t.request(o,{},"GET").then((function(e){null==e.data.nextDate?n.nextDate="暂无":n.nextDate=e.data.nextDate,null==e.data.nextDateDay?n.deadline="暂无":n.deadline=e.data.nextDateDay})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){if(0==a.data.content[s].device.length)n.devicename="暂未分配",n.deviceNo="暂未分配";else for(var o=0;o<a.data.content[s].device.length;o++){var l="device/"+a.data.content[s].device[o].id;t.request(l,{},"GET").then((function(e){n.devicename=e.data.name,n.deviceNo=e.data.deviceNo,n.deviceID=e.data.id})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){if(0==a.data.content[s].ops.length)n.opuser="暂未分配";else for(var o=0;o<a.data.content[s].ops.length;o++){var l="user/"+a.data.content[s].ops[o].id;t.request(l,{},"GET").then((function(e){n.opuser=e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){t.tableData.push(n)}),600)}),300)}),300)},n=0;n<a.data.content.length;n++)s(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),600),t.globaldata.taskselectInfo=t.selectInfo,t.globaldata.taskdynamicTags=t.dynamicTags})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));else{console.log(t.selectInfo);for(var n=1;n<t.selectInfo.length;n++)if("name"==t.selectInfo[n].ziduan)a=a+"&"+t.selectInfo[n].ziduan+"=L"+t.selectInfo[n].value;else if("device"==t.selectInfo[n].ziduan||"ops"==t.selectInfo[n].ziduan)if(t.selectInfo[n].value.length>1){a=a+"&"+t.selectInfo[n].ziduan+"=I"+t.selectInfo[n].value[0];for(var o=1;o<t.selectInfo[n].value.length;o++)a=a+","+t.selectInfo[n].value[o]}else a=a+"&"+t.selectInfo[n].ziduan+"=="+t.selectInfo[n].value;else a=a+"&"+t.selectInfo[n].ziduan+"=="+t.selectInfo[n].value;t.request(a,{},"GET").then((function(a){console.log(a.data),t.total=a.data.totalElements;for(var s=function(s){var n={opuser:"",devicename:"",deviceNo:"",deviceID:""};n.id=0==a.data.content[s].device.length?"暂无":t.index++,n.taskname=null==a.data.content[s].name?"未分配":a.data.content[s].name,n.taskno=null==a.data.content[s].no?"未分配":a.data.content[s].no,n.taskid=a.data.content[s].id;var o="ops/schedule/status/"+a.data.content[s].id;t.request(o,{},"GET").then((function(e){null==e.data.nextDate?n.nextDate="暂无":n.nextDate=e.data.nextDate,null==e.data.nextDateDay?n.deadline="暂无":n.deadline=e.data.nextDateDay})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){if(0==a.data.content[s].device.length)n.devicename="暂未分配",n.deviceNo="暂未分配";else for(var o=0;o<a.data.content[s].device.length;o++){var l="device/"+a.data.content[s].device[o].id;t.request(l,{},"GET").then((function(e){n.devicename+=e.data.name,n.deviceNo+=e.data.deviceNo,n.deviceID=e.data.id})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){if(0==a.data.content[s].ops.length)n.opuser="暂未分配";else for(var o=0;o<a.data.content[s].ops.length;o++){var l="user/"+a.data.content[s].ops[o].id;t.request(l,{},"GET").then((function(e){n.opuser=e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){t.tableData.push(n)}),600)}),300)}),300)},n=0;n<a.data.content.length;n++)s(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),600),t.globaldata.taskselectInfo=t.selectInfo,t.globaldata.taskdynamicTags=t.dynamicTags})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}},handleDetail:function(e){console.log(e),this.$router.push({path:"/taskDetailInfo",query:e})},getData:function(e,t,a,s){var n=this,o="",l="",i="",r="";"OPERATOR"!=s?(o=a.content[e].name,i=a.content[e].deviceNo,l=a.content[e].id,r="device/"+a.content[e].id+"/bind"):(o=a[e].name,i=a[e].deviceNo,l=a[e].id,r="device/"+a[e].id+"/bind"),n.request(r,{},"GET").then((function(r){if(0!=r.data.length)n.getDeviceTask(0,r.data.length,r.data,o,i,l,{}),++e<t&&setTimeout((function(){n.getData(e,t,a,s)}),500);else{var c={};c.devicename=o,c.deviceNo=i,c.deviceID=l,c.id=n.index++,n.tableData.push(c),++e<t&&n.getData(e,t,a,s)}}))},getDeviceTask:function(e,t,a,s,n,o,l){var i=this;l.devicename=s,l.deviceNo=n,l.deviceID=o,l.taskid=a[e].id,l.taskname=a[e].name,l.taskno=a[e].no,i.getUserData(0,a[e].ops.length,a[e].ops,l,{}),setTimeout((function(){++e<t&&i.getDeviceTask(e,t,a,s,n,o,{})}),300)},getUserData:function(e,t,a,s,n){n.opuser="";var o=this,l="user/"+a[e].id;o.request(l,{},"GET").then((function(e){n.devicename=s.devicename,n.deviceNo=s.deviceNo,n.deviceID=s.deviceID,n.taskid=s.taskid,n.taskname=s.taskname,n.taskno=s.taskno,n.opuser=e.data.name,n.id=o.index++,o.tableData.push(n)}));var i="ops/schedule/status/"+s.taskid;o.request(i,{},"GET").then((function(e){null==e.data.nextDate?n.nextDate="暂无":n.nextDate=e.data.nextDate,null==e.data.nextDateDay?n.deadline="暂无":n.deadline=e.data.nextDateDay})),++e<t&&setTimeout((function(){o.getUserData(e,t,a,s,{})}),200)},getAllDevice:function(){var e=this,t=this;t.ifsearch=!1,t.index=1;var a="";a="OPERATOR"!=t.userRole?"device?page=0&size="+t.page_size:"my/device",t.request(a,{},"GET").then((function(a){t.tableData=[],t.total=a.data.totalElements,t.currentPage=1,0==a.data.length?e.$message({message:"暂无保养任务",type:"warning"}):("OPERATOR"!=t.userRole?t.getData(0,a.data.content.length,a.data,t.userRole):t.getData(0,a.data.length,a.data,t.userRole),e.$message({message:"数据已更新",type:"success"})),t.selectInfo=[],t.selectvalue="",t.selectmodel="",t.dynamicTags=[],t.globaldata.deviceselectInfo=[],t.globaldata.devicedynamicTags=[]})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},handleEdit:function(e){console.log(e),this.$router.push({path:"/editTask",query:e})},handleDelete:function(e){var t=this,a=this;console.log(e),this.$confirm("解绑会删除相关的保养记录，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s="ops/schedule/"+e.taskid;a.request(s,{},"DELETE").then((function(e){console.log(e.data),a.$message({message:"解绑成功",type:"success"}),a.getAllDevice()})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))})).catch((function(){a.$message.info("已取消解绑")}))},handleSizeChange:function(e){var t=this,a=this;a.index=1,a.tableData=[],a.currentPage=1,console.log(e),a.page_size=e;var s="device?page=0&size="+a.page_size;console.log(s),a.request(s,{},"GET").then((function(e){a.tableData=[],a.total=e.data.totalElements,a.currentPage=1,console.log(e.data),"OPERATOR"!=a.userRole?a.getData(0,e.data.content.length,e.data,a.userRole):a.getData(0,e.data.length,e.data,a.userRole),t.$message({message:"数据已更新",type:"success"}),a.selectInfo=[],a.selectvalue="",a.selectmodel="",a.dynamicTags=[],a.globaldata.deviceselectInfo=[],a.globaldata.devicedynamicTags=[]})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handleCurrentChange:function(e){var t=this,a=this;a.index=1,a.tableData=[],a.page=e,a.currentPage=e,console.log(e);var s="device?page="+(a.page-1)+"&size="+a.page_size;a.request(s,{},"GET").then((function(e){a.tableData=[],a.total=e.data.totalElements,console.log(e.data),"OPERATOR"!=a.userRole?a.getData(0,e.data.content.length,e.data,a.userRole):a.getData(0,e.data.length,e.data,a.userRole),t.$message({message:"数据已更新",type:"success"}),a.selectInfo=[],a.selectvalue="",a.selectmodel="",a.dynamicTags=[],a.globaldata.deviceselectInfo=[],a.globaldata.devicedynamicTags=[]})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}}},Ke=Ze,et=(a("c6f3"),Object(r["a"])(Ke,Qe,Xe,!1,null,null,null)),tt=et.exports,at=function(){var e=this,t=e.$createElement,a=e._self._c||t;return["ROOT","ADMIN","CREATOR","SUPERVISOR"].includes(e.userRole)?a("div",{staticClass:"Container-TssignTask"},[a("div",{staticStyle:{"padding-bottom":"20px",width:"100%"}},[a("el-breadcrumb",{staticClass:"Breadcrumb"},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备保养")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("任务标准分配")])],1)],1),a("div",{staticClass:"selectPart"},[a("div",[e._v(" 第一步： "),a("el-select",{attrs:{placeholder:"请选择设备",filterable:""},model:{value:e.devicevalue,callback:function(t){e.devicevalue=t},expression:"devicevalue"}},e._l(e.deviceoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",[e._v(" 第二步： "),a("el-select",{attrs:{placeholder:"请选择标准",filterable:""},model:{value:e.taskvalue,callback:function(t){e.taskvalue=t},expression:"taskvalue"}},e._l(e.taskoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",[e._v(" 第三步： "),a("el-select",{attrs:{placeholder:"请选择保养人员",filterable:"",multiple:"",size:"large"},model:{value:e.opsvalue,callback:function(t){e.opsvalue=t},expression:"opsvalue"}},e._l(e.opsoptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",[e._v(" 第四步： "),a("el-date-picker",{attrs:{type:"date",placeholder:"选择下次保养开始日期","value-format":"yyyy-MM-dd"},model:{value:e.datevalue,callback:function(t){e.datevalue=t},expression:"datevalue"}})],1)]),a("div",{staticClass:"Btns"},[a("div",{staticClass:"sub-btn"},[a("el-button",{on:{click:e.SubTssign}},[e._v("保存并提交")])],1)])]):e._e()},st=[],nt={name:"AddTaskInside",created:function(){var e=this,t=this;t.userRole=this.globaldata.userRole,t.userID=this.globaldata.userid,["ROOT","ADMIN","CREATOR","SUPERVISOR"].includes(t.userRole)&&(t.request("ops/schedule?page=0&size=1000000000",{},"GET").then((function(e){for(var a=0;a<e.data.content.length;a++){var s={};console.log(e.data.content[a]),s.value=e.data.content[a].id,s.label=e.data.content[a].name+"("+e.data.content[a].no+")",t.taskoptions.push(s)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),t.request("device?page=0&size=1000000000",{},"GET").then((function(e){console.log(e.data);for(var a=0;a<e.data.content.length;a++){var s={};s.value=e.data.content[a].id+"/"+e.data.content[a].deviceNo,s.label=e.data.content[a].name+"("+e.data.content[a].deviceNo+")",t.deviceoptions.push(s)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),t.request("user/query?role==OPERATOR",{},"GET").then((function(e){for(var a=0;a<e.data.content.length;a++){var s={};s.value=e.data.content[a].id,s.label=e.data.content[a].username+"(姓名: "+e.data.content[a].name+")",t.opsoptions.push(s)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})))},data:function(){return{userRole:"",taskvalue:"",taskoptions:[],devicevalue:"",deviceoptions:[],datevalue:"",opsvalue:"",opsoptions:[],selectedTaskid:[],selectedDeviceid:[]}},methods:{SubTssign:function(){var e=this,t=this;if(""==t.taskvalue||""==t.devicevalue||""==t.datevalue||""==t.opsvalue)t.$message({message:"请将信息填写完整",type:"warning"});else{var a=[],s=[],n="ops/schedule/detail/"+t.taskvalue,o="ops/schedule/bind/"+t.taskvalue;console.log(n,o),console.log(t.datevalue),new Date(t.datevalue).getTime()<(new Date).getTime()?t.$message({message:"下次开始日期应大于今天",type:"warning"}):t.request(n,{},"GET").then((function(e){console.log(e.data);var n={};a.push({id:1*t.devicevalue.split("/")[0],deviceNo:t.devicevalue.split("/")[1]});for(var l=0;l<t.opsvalue.length;l++)s.push({id:t.opsvalue[l]});n.acceptedStandard=e.data.acceptedStandard,n.content=[{title:e.data.content[0].title,detail:e.data.content[0].detail}],n.id=e.data.id,n.name=e.data.name,n.no=e.data.no,n.remark=e.data.remark,n.scheduleType=e.data.scheduleType,n.startDate=t.datevalue,n.side=e.data.side,n.tools=e.data.tools,n.device=a,n.ops=s,n.manager=null,console.log(n),setTimeout((function(){t.request(o,n,"PUT").then((function(e){console.log(e),t.$message({message:"分配成功",type:"success"})})).catch((function(){t.$message({message:"设备和标准已绑定！",type:"error"})}))}),200)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}}},ot=nt,lt=(a("ba9b"),a("f07e"),Object(r["a"])(ot,at,st,!1,null,"2168ac0a",null)),it=lt.exports,rt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ErrorTask-container"},[a("div",{staticClass:"Task-info"},[a("div",{staticClass:"title"},[e._v("报修申请单")]),a("div",{staticClass:"Users-Name"},[a("div",{staticClass:"part0",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报告人员")]),a("user",{staticStyle:{"margin-top":"5px"},attrs:{name:e.reporter.name,username:e.reporter.username,useremail:e.reporter.useremail,avatar:e.reporter.avatarurl}})],1),a("div",{staticClass:"part0 device",staticStyle:{width:"50%"}},[a("div",{staticClass:"deviceselect"},[a("div",{staticClass:"Text"},[e._v("选择设备")]),a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.device,callback:function(t){e.device=t},expression:"device"}},e._l(e.options1,(function(t){return a("el-option",{key:t.value,attrs:{label:t.devicename,value:t.value}},[a("span",{staticStyle:{float:"left","font-size":"13px"}},[e._v(e._s(t.devicename))]),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px","margin-right":"15px"}},[e._v(e._s(t.devicenumber))])])})),1)],1),"OPERATOR"==e.reporter.role?a("div",{staticClass:"devicesinput"},[a("div",{staticClass:"Text"},[e._v("按编号添加设备")]),a("el-input",{attrs:{placeholder:"请输入设备编号"},model:{value:e.deviceno,callback:function(t){e.deviceno=t},expression:"deviceno"}})],1):e._e(),"OPERATOR"==e.reporter.role?a("div",{staticClass:"devicesbtn"},[a("el-button",{on:{click:e.searchdevice}},[e._v("查找")])],1):e._e()])]),a("div",{staticClass:"Content"},[a("div",{staticClass:"part2",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("异常描述和异常处理请求")]),a("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"70%","margin-top":"5px",width:"100%"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}})],1)]),a("div",{staticClass:"SelectOpreator "},[a("div",{staticClass:"part3"},[a("div",{staticClass:"Text"},[e._v("选择报告接受人")]),a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.assignee,callback:function(t){e.assignee=t},expression:"assignee"}},e._l(e.options2,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1)]),a("div",{staticClass:"submitbtn"},[a("el-button",{on:{click:e.submit}},[e._v("提交")])],1)]),a("el-upload",{staticClass:"avatar-uploader",staticStyle:{display:"none"},attrs:{"list-type":"picture",action:"","auto-upload":!1,accept:".jpg, .png","show-file-list":!1,"on-change":e.getFile}})],1)},ct=[],dt=a("79e2"),ut=[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["image"]],pt={components:{quillEditor:Ie["quillEditor"],User:dt["a"]},created:function(){var e=this,t=this,a="";console.log(),a=this.globaldata.userRole,t.reporter.id=this.globaldata.userid,t.reporter.name=this.globaldata.name,t.reporter.role=this.globaldata.userRole,t.reporter.username=this.globaldata.username,t.reporter.useremail=this.globaldata.useremail,t.reporter.avatarurl=this.globaldata.avatarurl,setTimeout((function(){""!=a&&"OPERATOR"!=a?(t.request("device?page=0&size=1000000000",{},"GET").then((function(e){for(var a=0;a<e.data.content.length;a++){var s={};s.value=e.data.content[a].id,s.devicename=e.data.content[a].name,s.devicenumber=e.data.content[a].deviceNo,t.options1.push(s)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),t.request("user/query",{},"GET").then((function(e){console.log(e.data),setTimeout((function(){for(var a=0;a<e.data.content.length;a++)"SUPERVISOR"==e.data.content[a].role&&t.options2[0].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"})}),300)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))):""!=a&&"OPERATOR"==a&&(t.request("my/device",{},"GET").then((function(e){console.log(e.data);for(var a=0;a<e.data.length;a++){var s={};s.value=e.data[a].id,s.devicename=e.data[a].name,s.devicenumber=e.data[a].deviceNo,t.options1.push(s)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),t.request("user/query",{},"GET").then((function(e){console.log(e.data);for(var a=0;a<e.data.content.length;a++)"SUPERVISOR"==e.data.content[a].role&&t.options2[0].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})))}),300)},data:function(){return{reporter:{},device:[],deviceno:"",options1:[],content:"",assignee:"",options2:[{label:"SUPERVISOR",options:[]}],editorOption:{placeholder:"请输入异常描述和异常处理请求",modules:{toolbar:{container:ut,handlers:{image:function(e){e?document.querySelector(".avatar-uploader input").click():this.quill.format("image",!1)}}}}}}},methods:{onEditorChange:function(e){var t=e.html;console.log(t),this.content=t},getFile:function(e){var t=this,a=this;this.getBase64(e.raw).then((function(e){var s=e.split(",");console.log(s,"params"),s.length>0&&a.request("pic",s[1],"POST",{"Content-Type":"text/plain"}).then((function(e){console.log(e);var t="http://1.15.236.205/api/pic/"+e.data,s=a.$refs.myQuillEditor.quill,n=s.getSelection().index;s.insertEmbed(n,"image",t),s.setSelection(n+1)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}))},getBase64:function(e){return new Promise((function(t,a){var s=new FileReader,n="";s.readAsDataURL(e),s.onload=function(){n=s.result},s.onerror=function(e){a(e)},s.onloadend=function(){t(n)}}))},submit:function(){var e=this,t=this,a=[],s=[];if(console.log(t.device,t.assignee),""==t.assignee||0==t.device.length||""==t.content)t.$message({message:"请将信息填写完整",type:"warning"});else{s.push({id:t.device}),a.push({id:t.assignee});var n={assignee:a,closed:!1,content:t.content,device:s,reporter:{id:t.reporter.id}};console.log(n),t.request("issue",n,"POST").then((function(e){console.log(e),t.$message({message:"申请成功",type:"success"}),setTimeout((function(){t.$router.push({path:"./fixApply"})}),1e3)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},searchdevice:function(){var e=this;console.log(e.deviceno);var t="device/query?deviceNo=="+e.deviceno;e.request(t,{},"GET").then((function(t){if(console.log(t.data),0==t.data.content.length)e.$message({message:"无结果",type:"warning"});else{e.deviceno="";var a={};a.value=t.data.content[0].id,a.devicename=t.data.content[0].name,a.devicenumber=t.data.content[0].deviceNo,e.options1.push(a),e.$message({message:"查找成功，已添加至设备选择列表",type:"success"})}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}},vt=pt,mt=(a("409f"),Object(r["a"])(vt,rt,ct,!1,null,null,null)),ft=mt.exports,gt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-AllError"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("全部报修")])],1),a("div",{staticClass:"head-btn"},[a("div",{staticClass:"oper-btns-left"},[a("div",{staticClass:"select"},[a("el-select",{staticStyle:{"margin-left":"5px"},attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.selectchange},model:{value:e.selectvalue,callback:function(t){e.selectvalue=t},expression:"selectvalue"}},e._l(e.selectoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),a("div",e._l(e.dynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1),a("div",{staticClass:"search"},[a("el-button",{attrs:{icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")])],1),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1)])]),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"errorid",label:"报修流水号",width:"200"}}),a("el-table-column",{attrs:{prop:"errordevicename",label:"故障设备名称"}}),a("el-table-column",{attrs:{prop:"errordeviceNo",label:"故障设备编号"}}),a("el-table-column",{attrs:{prop:"reportername",label:"报修人员"}}),a("el-table-column",{attrs:{prop:"reportertime",label:"报修时间",width:"200"}}),a("el-table-column",{attrs:{prop:"assigneename",label:"维修人员"}}),a("el-table-column",{attrs:{prop:"assigneestatus",label:"维修状态"}}),"OPERATOR"!=e.userRole?a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.errordetail(t.$index)}}},[e._v("查看详情")])]}}],null,!1,2463460010)}):e._e()],1),e.ifsearch?e._e():a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[15,30,50,100],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},["device"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.deviceselectchange},model:{value:e.selectvalue2,callback:function(t){e.selectvalue2=t},expression:"selectvalue2"}},e._l(e.deviceoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"device"==e.selectvalue?a("div",{staticStyle:{"margin-top":"10px"}},e._l(e.devicedynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.devicehandleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1):e._e(),"reporter"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择报修人员",filterable:"",clearable:"",multiple:""},model:{value:e.reportervalue,callback:function(t){e.reportervalue=t},expression:"reportervalue"}},e._l(e.reporteroptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"assignee"==e.selectvalue?a("el-select",{attrs:{placeholder:"请选择维修人员",filterable:"",clearable:"",multiple:""},model:{value:e.assigneevalue,callback:function(t){e.assigneevalue=t},expression:"assigneevalue"}},e._l(e.assigneeoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"closed"==e.selectvalue?a("el-radio-group",{model:{value:e.closed,callback:function(t){e.closed=t},expression:"closed"}},[a("el-radio-button",{attrs:{label:"未分配"}}),a("el-radio-button",{attrs:{label:"已分配"}}),a("el-radio-button",{attrs:{label:"待确认"}}),a("el-radio-button",{attrs:{label:"已完成"}})],1):e._e(),"timeChoose"==e.selectvalue?a("el-date-picker",{attrs:{type:"date",placeholder:"选择开始日期","value-format":"yyyy-MM-dd"},model:{value:e.start,callback:function(t){e.start=t},expression:"start"}}):e._e(),"timeChoose"==e.selectvalue?a("el-date-picker",{staticStyle:{"margin-top":"20px"},attrs:{type:"date",placeholder:"选择结束日期","value-format":"yyyy-MM-dd"},model:{value:e.end,callback:function(t){e.end=t},expression:"end"}}):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitselect}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchDeviceVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchDeviceVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.devicevalue,callback:function(t){e.devicevalue=t},expression:"devicevalue"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchDeviceVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.devicesubmitselect}},[e._v("确 定")])],1)],1)],1)},ht=[],bt=(a("5319"),a("bf19"),{created:function(){var e=this,t=this;t.userRole=this.globaldata.userRole,0!=this.globaldata.fixselectInfo.length?(t.selectInfo=this.globaldata.fixselectInfo,t.dynamicTags=this.globaldata.fixdynamicTags,t.search()):setTimeout((function(){t.refresh()}),200),t.request("user/query",{},"GET").then((function(e){for(var a=0;a<e.data.content.length;a++)if("ROOT"==e.data.content[a].role){var s={};s.value=e.data.content[a].id,s.label=e.data.content[a].name+" (用户名："+e.data.content[a].username+")",t.reporteroptions[0].options.push(s)}else if("ADMIN"==e.data.content[a].role){var n={};n.value=e.data.content[a].id,n.label=e.data.content[a].name+" (用户名："+e.data.content[a].username+")",t.reporteroptions[1].options.push(n)}else if("CREATER"==e.data.content[a].role){var o={};o.value=e.data.content[a].id,o.label=e.data.content[a].name+" (用户名："+e.data.content[a].username+")",t.reporteroptions[2].options.push(o)}else if("SUPERVISOR"==e.data.content[a].role){var l={};l.value=e.data.content[a].id,l.label=e.data.content[a].name+" (用户名："+e.data.content[a].username+")",t.reporteroptions[3].options.push(l)}else if("OPERATOR"==e.data.content[a].role){var i={};i.value=e.data.content[a].id,i.label=e.data.content[a].name+" (用户名："+e.data.content[a].username+")",t.reporteroptions[4].options.push(i),t.assigneeoptions[0].options.push(i)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},data:function(){return{userRole:"",taskData:[],tablewidth:"150",ifsearch:!1,selectoptions:[{label:"字段",options:[{value:"device",label:"设备"},{value:"reporter",label:"报修人员"},{value:"assignee",label:"维修人员"},{value:"closed",label:"维修状态"},{value:"timeChoose",label:"时间范围"}]}],dynamicTags:[],devicevalue:"",deviceoptions:[{label:"基本字段",options:[{value:"name",label:"设备名称"},{value:"brand",label:"设备品牌"},{value:"type",label:"设备型号/规格"},{value:"deviceNo",label:"设备编号"},{value:"crux",label:"是否为关键设备"},{value:"clazz",label:"设备分类"}]},{label:"附加字段",options:[]}],devicedynamicTags:[],selectvalue2:"",selectInfo2:[],dialogSearchDeviceVisible:!1,assigneevalue:"",assigneeoptions:[{label:"OPERATOR",options:[]}],reportervalue:"",reporteroptions:[{label:"ROOT",options:[]},{label:"ADMIN",options:[]},{label:"CREATER",options:[]},{label:"SUPERVISOR",options:[]},{label:"OPERATOR",options:[]}],closed:"",start:"",end:"",selectvalue:"",selectInfo:[],dialogSearchVisible:!1,currentPage:1,page_size:15,page:1,total:0}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return this.active++,new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},selectchange:function(){this.dialogSearchVisible=!0},deviceselectchange:function(){this.dialogSearchDeviceVisible=!0},devicesubmitselect:function(){this.dialogSearchDeviceVisible=!1,this.selectInfo2.push({ziduan:this.selectvalue2,value:this.devicevalue}),this.devicedynamicTags.push(this.selectvalue+" / "+this.devicevalue)},searchDevice:function(){var e=this,t=this,a=[],s="";if(s="device/query?"+t.selectInfo2[0].ziduan+"=L"+t.selectInfo2[0].value+"%25",1==t.selectInfo2.length)t.request(s,{},"GET").then((function(e){for(var s=0;s<e.data.content.length;s++)a.push(e.data.content[s].id);t.selectInfo.push({ziduan:"device",value:a}),t.dynamicTags.push("device / "+a)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));else{for(var n=1;n<t.selectInfo2.length;n++)s=s+"&"+t.selectInfo2[n].ziduan+"=L"+t.selectInfo2[n].value+"%25";t.request(s,{},"GET").then((function(e){for(var s=0;s<e.data.content.length;s++)a.push(e.data.content[s].id);t.selectInfo.push({ziduan:"device",value:a}),t.dynamicTags.push("device / "+a)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},devicehandleClose:function(e){var t=this.devicedynamicTags.indexOf(e);console.log(t),this.devicedynamicTags.splice(t,1),this.selectInfo2.splice(t,1)},submitselect:function(){var e=this;switch(this.dialogSearchVisible=!1,this.selectvalue){case"device":this.searchDevice();break;case"assignee":this.selectInfo.push({ziduan:this.selectvalue,value:this.assigneevalue}),this.dynamicTags.push(this.selectvalue+" / "+this.assigneevalue);break;case"reporter":this.selectInfo.push({ziduan:this.selectvalue,value:this.reportervalue}),this.dynamicTags.push(this.selectvalue+" / "+this.reportervalue);break;case"closed":switch(console.log(this.closed),this.closed){case"未分配":this.selectInfo.push({ziduan:this.selectvalue,value:"false&assignedAt=N"}),this.dynamicTags.push(this.selectvalue+" / "+this.closed);break;case"已分配":this.selectInfo.push({ziduan:this.selectvalue,value:"false&assignedAt=M&fixedAt=N"}),this.dynamicTags.push(this.selectvalue+" / "+this.closed);break;case"待确认":this.selectInfo.push({ziduan:this.selectvalue,value:"false&assignedAt=M&fixedAt=M"}),this.dynamicTags.push(this.selectvalue+" / "+this.closed);break;case"已完成":this.selectInfo.push({ziduan:this.selectvalue,value:"true"}),this.dynamicTags.push(this.selectvalue+" / "+this.closed);break;default:break}break;case"timeChoose":var t=this;t.taskData=[],t.ifsearch=!0,t.selectInfo=[],t.selectvalue="",t.selectmodel="",t.dynamicTags=[],this.globaldata.deviceselectInfo=[],this.globaldata.devicedynamicTags=[];var a="issue/query?createdAt=B"+this.start+"T00:00,"+this.end+"T00:00";t.request(a,{},"GET").then((function(a){console.log(a.data),t.total=a.data.totalElements;for(var s=function(s){var n={};n.errorid=a.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=t.renderTime(a.data.content[s].createdAt),null!=a.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=a.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=a.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==a.data.content[s].closed&&null!=a.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<a.data.content[s].device.length;o++){var l="device/"+a.data.content[s].device[o].id;t.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+a.data.content[s].reporter.id;t.request(o,{},"GET").then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){if(1==a.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<a.data.content[s].assignee.length;o++){var l="user/"+a.data.content[s].assignee[o].id;t.request(l,{},"GET").then((function(e){console.log(e.data),n.assigneename=e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){t.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<a.data.content.length;n++)s(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;default:break}},handleClose:function(e){var t=this.dynamicTags.indexOf(e);console.log(t),this.dynamicTags.splice(t,1),this.selectInfo.splice(t,1)},refresh:function(){var e=this,t=this;t.taskData=[],t.ifsearch=!1;var a="issue?page=0&size="+t.page_size;t.request(a,{},"GET").then((function(a){console.log(a.data),t.total=a.data.totalElements;for(var s=function(s){var n={};n.errorid=a.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=t.renderTime(a.data.content[s].createdAt),null!=a.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=a.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=a.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==a.data.content[s].closed&&null!=a.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<a.data.content[s].device.length;o++){var l="device/"+a.data.content[s].device[o].id;t.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+a.data.content[s].reporter.id;t.request(o,{},"GET").then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){if(1==a.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<a.data.content[s].assignee.length;o++){var l="user/"+a.data.content[s].assignee[o].id;t.request(l,{},"GET").then((function(e){console.log(e.data),n.assigneename=e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){t.taskData.unshift(n)}),800)}),300)}),300)}),300)},n=0;n<a.data.content.length;n++)s(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),t.selectInfo=[],t.selectvalue="",t.selectmodel="",t.dynamicTags=[],this.globaldata.fixselectInfo=[],this.globaldata.fixdynamicTags=[]},errordetail:function(e){var t=this;console.log(t.taskData[e]),t.$router.push({path:"./errorDetail",query:t.taskData[e]})},search:function(){var e=this,t=this,a="";if(t.taskData=[],t.currentPage=1,t.ifsearch=!0,"device"==t.selectInfo[0].ziduan||"reporter"==t.selectInfo[0].ziduan||"assignee"==t.selectInfo[0].ziduan)if(t.selectInfo[0].value.length>1){a="issue/query?"+t.selectInfo[0].ziduan+"=I"+t.selectInfo[0].value[0];for(var s=1;s<t.selectInfo[0].value.length;s++)a=a+","+t.selectInfo[0].value[s]}else a="issue/query?"+t.selectInfo[0].ziduan+"=="+t.selectInfo[0].value;else a="issue/query?"+t.selectInfo[0].ziduan+"=="+t.selectInfo[0].value;if(1==t.selectInfo.length)t.request(a,{},"GET").then((function(a){console.log(a.data),t.total=a.data.totalElements;for(var s=function(s){var n={};n.errorid=a.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=t.renderTime(a.data.content[s].createdAt),null!=a.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=a.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=a.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==a.data.content[s].closed&&null!=a.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<a.data.content[s].device.length;o++){var l="device/"+a.data.content[s].device[o].id;t.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+a.data.content[s].reporter.id;t.request(o,{},"GET").then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){if(1==a.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<a.data.content[s].assignee.length;o++){var l="user/"+a.data.content[s].assignee[o].id;t.request(l,{},"GET").then((function(e){console.log(e.data),n.assigneename=e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){t.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<a.data.content.length;n++)s(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));else{console.log(t.selectInfo);for(var n=1;n<t.selectInfo.length;n++)if("name"==t.selectInfo[n].ziduan)a=a+"&"+t.selectInfo[n].ziduan+"=L"+t.selectInfo[n].value+"%25";else if("device"==t.selectInfo[n].ziduan||"ops"==t.selectInfo[n].ziduan)if(t.selectInfo[n].value.length>1){a=a+"&"+t.selectInfo[n].ziduan+"=I"+t.selectInfo[n].value[0];for(var o=1;o<t.selectInfo[n].value.length;o++)a=a+","+t.selectInfo[n].value[o]}else a=a+"&"+t.selectInfo[n].ziduan+"=="+t.selectInfo[n].value;else a=a+"&"+t.selectInfo[n].ziduan+"=="+t.selectInfo[n].value;t.request(a,{},"GET").then((function(a){console.log(a.data),t.total=a.data.totalElements;for(var s=function(s){var n={};n.errorid=a.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=t.renderTime(a.data.content[s].createdAt),null!=a.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=a.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=a.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==a.data.content[s].closed&&null!=a.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<a.data.content[s].device.length;o++){var l="device/"+a.data.content[s].device[o].id;t.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+a.data.content[s].reporter.id;t.request(o,{},"GET").then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){if(1==a.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<a.data.content[s].assignee.length;o++){var l="user/"+a.data.content[s].assignee[o].id;t.request(l,{},"GET").then((function(e){console.log(e.data),n.assigneename=e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){t.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<a.data.content.length;n++)s(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}},handleSizeChange:function(e){var t=this,a=this;a.taskData=[],console.log(e),a.page_size=e,a.currentPage=1;var s="issue?page=0&size="+a.page_size;console.log(s),a.request(s,{},"GET").then((function(e){console.log(e.data),a.total=e.data.totalElements;for(var s=function(s){var n={};n.errorid=e.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=a.renderTime(e.data.content[s].createdAt),null!=e.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=e.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=e.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==e.data.content[s].closed&&null!=e.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<e.data.content[s].device.length;o++){var l="device/"+e.data.content[s].device[o].id;a.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+e.data.content[s].reporter.id;a.request(o,{},"GET").then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})})),setTimeout((function(){if(1==e.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<e.data.content[s].assignee.length;o++){var l="user/"+e.data.content[s].assignee[o].id;a.request(l,{},"GET").then((function(e){console.log(e.data),n.assigneename=e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){a.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<e.data.content.length;n++)s(n);setTimeout((function(){a.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handleCurrentChange:function(e){var t=this,a=this;a.page=e,a.currentPage=e,console.log(e);var s="issue?page="+(a.page-1)+"&size="+a.page_size;console.log(s),a.request(s,{},"GET").then((function(e){console.log(e.data),a.total=e.data.totalElements;for(var s=function(s){var n={};n.errorid=e.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=a.renderTime(e.data.content[s].createdAt),null!=e.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=e.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=e.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==e.data.content[s].closed&&null!=e.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<e.data.content[s].device.length;o++){var l="device/"+e.data.content[s].device[o].id;a.request(l,{},"GET").then((function(e){n.errordevicename+=e.data.name+" / ",n.errordeviceNo+=e.data.deviceNo+" / "})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+e.data.content[s].reporter.id;a.request(o,{},"GET").then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})})),setTimeout((function(){if(1==e.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<e.data.content[s].assignee.length;o++){var l="user/"+e.data.content[s].assignee[o].id;a.request(l,{},"GET").then((function(e){console.log(e.data),n.assigneename=e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){a.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<e.data.content.length;n++)s(n);setTimeout((function(){a.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}}}),yt=bt,Tt=(a("c2e6"),Object(r["a"])(yt,gt,ht,!1,null,null,null)),kt=Tt.exports,xt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-ErrorDetail"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("查看详情 ")])],1),a("div",{staticClass:"Task-container"},[a("div",{staticClass:"Step"},[a("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"申请",description:e.applytime}}),a("el-step",{attrs:{title:"分配",description:e.assigntime}}),a("el-step",{attrs:{title:"修复",description:e.fixtime}}),a("el-step",{attrs:{title:"确认",description:e.completetime}})],1)],1),a("div",{staticClass:"Task-info"},[e._m(0),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报修流水号")]),a("div",{staticClass:"Info"},[e._v(e._s(e.errorid))])]),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报修人员")]),e._l(e.applyusers,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail,avatar:e.avatar}})}))],2)]),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("异常描述和异常处理请求")]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.errorcontent)}})])])]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("报修设备")]),a("el-table",{staticClass:"extraTable",staticStyle:{"margin-top":"10px",width:"100%"},attrs:{data:e.devicetableData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"设备ID"}}),a("el-table-column",{attrs:{prop:"name",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"brand",label:"设备品牌"}}),a("el-table-column",{attrs:{prop:"deviceNo",label:"设备编号"}}),a("el-table-column",{attrs:{prop:"clazz",label:"设备分类"}})],1)],1)])]),a("div",{staticClass:"Task-info"},[e._m(1),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("维修分配人员-Supervisor")]),e._l(e.supervisor,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail,avatar:e.avatar}})}))],2),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("维修人员-Operator")]),e._l(e.operator,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail,avatar:e.avatar}})}))],2)]),"SUPERVISOR"==e.userRole&&0==e.assigned?a("div",{staticClass:"Part lastpart TssignFixBtn"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("分配申请")]),a("el-button",{on:{click:e.TssignFix}},[e._v("分配此申请")])],1)]):e._e()]),e.assigned&&e.opstofix&&!e.closed?a("div",{staticClass:"Task-info Last"},[e._m(2),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("异常类型")]),a("el-input",{attrs:{type:"text",placeholder:"异常类型"},model:{value:e.exceptionType,callback:function(t){e.exceptionType=t},expression:"exceptionType"}})],1),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("发生原因")]),a("el-input",{attrs:{type:"text",placeholder:"发生原因"},model:{value:e.reason,callback:function(t){e.reason=t},expression:"reason"}})],1)]),a("div",{staticClass:"Part"},[a("div",{staticClass:"part result",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("异常解决措施和处理结果")]),a("quill-editor",{ref:"myQuillEditor",staticStyle:{height:"70%","margin-top":"5px",width:"100%"},attrs:{options:e.editorOption},on:{change:function(t){return e.onEditorChange(t)}},model:{value:e.solution,callback:function(t){e.solution=t},expression:"solution"}})],1)]),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("报修人员拒绝原因")]),a("div",{staticClass:"Info"},[e._v(e._s(e.refusereason))])])]),"OPERATOR"!=e.userRole||e.closed?e._e():a("div",{staticClass:"Part lastpart TssignFixBtn"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("提交诊断")]),a("el-button",{on:{click:e.submitbtn}},[e._v("确认提交")])],1)])]):e._e(),e.assigned&&!e.opstofix||e.assigned&&e.closed?a("div",{staticClass:"Task-info Last"},[e._m(3),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("异常类型")]),a("div",{staticClass:"Info"},[e._v(e._s(e.exceptionType))])]),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("发生原因")]),a("div",{staticClass:"Info"},[e._v(e._s(e.reason))])])]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("异常解决措施和处理结果")]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.solution)}})])]),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报修人员拒绝原因")]),a("div",{staticClass:"Info"},[e._v(e._s(e.refusereason))])])])]):e._e()]),a("el-dialog",{attrs:{title:"选择维修人",visible:e.dialogFixVisible},on:{"update:visible":function(t){e.dialogFixVisible=t}}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.assigneeOp,callback:function(t){e.assigneeOp=t},expression:"assigneeOp"}},e._l(e.options,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value,disabled:e.disabled}})})),1)})),1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFixVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitTssign}},[e._v("确 定")])],1)],1),a("el-upload",{staticClass:"avatar-uploader",staticStyle:{display:"none"},attrs:{"list-type":"picture",action:"","auto-upload":!1,accept:".jpg, .png","show-file-list":!1,"on-change":e.getFile}})],1)},_t=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 申请 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 分配 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 修复 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 修复 ")])])])}],It=(a("96cf"),a("1da1")),Ct=[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["image"]],Et={created:function(){var e=this,t=this;t.active=0,console.log(t.$route.query),t.errorid=t.$route.query.errorid,t.userid=this.globaldata.userid,t.userRole=this.globaldata.userRole;var a="issue/"+t.$route.query.errorid;t.request(a,{},"GET").then((function(a){console.log(a.data),t.reporterid=a.data.reporter.id,t.errorcontent=a.data.content,t.reason=null==a.data.reason?"暂无":a.data.reason,t.solution=null==a.data.solution?"暂无":a.data.solution,t.exceptionType=null==a.data.exceptionType?"暂无":a.data.exceptionType,t.closed=a.data.closed,t.refusereason=null==a.data.rejectReason?"无":a.data.rejectReason,null!=a.data.createdAt&&(t.applytime=t.renderTime(a.data.createdAt)),null!=a.data.assignedAt&&(t.assigntime=t.renderTime(a.data.assignedAt)),null!=a.data.fixedAt&&(t.fixtime=t.renderTime(a.data.fixedAt),t.openconfirm=!0),1==a.data.closed&&null!=a.data.closedAt&&(t.completetime=t.renderTime(a.data.closedAt));for(var s={fixusersid:[]},n=0;n<a.data.assignee.length;n++)s.fixusersid.push({assigneeid:a.data.assignee[n].id});s.applyusersid=a.data.reporter.id,setTimeout((function(){var a="user/query?id=="+s.applyusersid;if(t.request(a,{},"GET").then((function(e){t.applyusers.push({name:e.data.content[0].name,userid:e.data.content[0].id,username:e.data.content[0].username,useremail:e.data.content[0].email,avatar:null==e.data.content[0].avatar?void 0:"http://1.15.236.205/api/pic/"+e.data.content[0].avatar})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),void 0!=s.fixusersid){var n="user/query?id=="+s.fixusersid[0].assigneeid;if(t.request(n,{},"GET").then((function(e){console.log(e),t.supervisor.push({name:e.data.content[0].name,userid:e.data.content[0].id,username:e.data.content[0].username,useremail:e.data.content[0].email,avatar:null==e.data.content[0].avatar?void 0:"http://1.15.236.205/api/pic/"+e.data.content[0].avatar})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),1==s.fixusersid.length)t.operator.push({name:"暂未分配",username:"暂未分配",useremail:"暂未分配",avatar:void 0});else{t.assigned=!0;for(var o=1;o<s.fixusersid.length;o++){s.fixusersid[o].assigneeid==e.userid&&(t.opstofix=!0);var l="user/query?id=="+s.fixusersid[o].assigneeid;t.request(l,{},"GET").then((function(e){t.operator.push({name:e.data.content[0].name,username:e.data.content[0].username,useremail:e.data.content[0].email,avatar:null==e.data.content[0].avatar?void 0:"http://1.15.236.205/api/pic/"+e.data.content[0].avatar})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}}}),200);for(var o=0;o<a.data.device.length;o++){var l="device/"+a.data.device[o].id;t.request(l,{},"GET").then((function(e){var a={};a.id=e.data.id,a.name=e.data.name,a.brand=e.data.brand,a.deviceNo=e.data.deviceNo,a.clazz=e.data.clazz,t.devicetableData.push(a)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){t.request("user/query",{},"GET").then((function(e){console.log(e);for(var a=0;a<e.data.content.length;a++)"OPERATOR"==e.data.content[a].role&&(t.applyusers[0].userid==e.data.content[a].id?t.options[0].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")",disabled:!0}):t.options[0].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}))})).catch((function(t){console.log(t),e.$message({message:t.response.data.message,type:"error"})}))}),500)},data:function(){return{userid:"",userRole:"",reporterid:"",assigned:!1,opstofix:!1,active:0,closed:!1,errorid:"",applyusers:[],errorcontent:"",fixusers:[],assigneeid:"",supervisor:[],operator:[],devicetableData:[],deviceinfo:[],dialogFixVisible:!1,assigneeOp:"",options:[{label:"OPERATOR",options:[]}],reason:"",solution:"",exceptionType:"",refusereason:"",editorOption:{placeholder:"请输入异常描述和异常处理请求",modules:{toolbar:{container:Ct,handlers:{image:function(e){e?document.querySelector(".avatar-uploader input").click():this.quill.format("image",!1)}}}}},picid:"",applytime:"",assigntime:"",fixtime:"",completetime:""}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return this.active++,new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},TssignFix:function(){this.dialogFixVisible=!0},onEditorChange:function(e){var t=e.html;console.log(t),this.content=t},getFile:function(e){var t=this,a=this;this.getBase64(e.raw).then((function(e){var s=e.split(",");s.length>0&&a.request("pic",s[1],"POST",{"Content-Type":"text/plain"}).then((function(e){a.picid=e.data;var t="http://1.15.236.205/api/pic/"+e.data,s=a.$refs.myQuillEditor.quill,n=s.getSelection().index;s.insertEmbed(n,"image",t),s.setSelection(n+1)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}))},getBase64:function(e){return new Promise((function(t,a){var s=new FileReader,n="";s.readAsDataURL(e),s.onload=function(){n=s.result},s.onerror=function(e){a(e)},s.onloadend=function(){t(n)}}))},submitTssign:function(){var e=this,t=this,a="issue/"+t.errorid;console.log(""==t.assigneeOp),""==t.assigneeOp?this.$message({message:"请选择维修人员",type:"warning"}):t.request(a,{},"GET").then((function(e){var s={};s.assignee=e.data.assignee,s.closed=e.data.closed,s.content=e.data.content,s.descriptionPic=e.data.descriptionPic,s.device=e.data.device,s.exceptionType=e.data.exceptionType,s.id=e.data.id,s.reason=e.data.reason,s.record=e.data.record,s.reporter=e.data.reporter,s.solution=e.data.solution,s.assignee.push({id:t.assigneeOp}),t.request(a,s,"PUT").then((function(){t.$message({message:"分配成功",type:"success"}),t.dialogFixVisible=!1,setTimeout((function(){location.reload()}),300)})).catch((function(){t.$message({message:"分配失败",type:"error"})}))})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},submitbtn:function(){var e=this;return Object(It["a"])(regeneratorRuntime.mark((function t(){var a,s,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,console.log(a.exceptionType,a.reason,a.solution),""!=a.exceptionType&&""!=a.reason&&""!=a.solution&&null!=a.exceptionType&&null!=a.reason&&null!=a.solution){t.next=6;break}a.$message({message:"请将修复信息填写完整",type:"warning"}),t.next=12;break;case 6:return s={},n="issue/"+a.errorid,t.next=10,a.request(n,{},"GET").then((function(e){s.assignee=e.data.assignee,s.closed=e.data.closed,s.content=e.data.content,s.descriptionPic=e.data.descriptionPic,s.device=e.data.device,s.exceptionType=a.exceptionType,s.id=e.data.id,s.reason=a.reason,s.record=e.data.record,s.reporter=e.data.reporter,s.solution=a.solution})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));case 10:console.log(s),a.request(n,s,"PUT").then((function(){a.$message({message:"提交成功",type:"success"}),setTimeout((function(){location.reload()}),300)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));case 12:case"end":return t.stop()}}),t)})))()}},components:{User:dt["a"],quillEditor:Ie["quillEditor"]}},Dt=Et,$t=(a("0c15"),Object(r["a"])(Dt,xt,_t,!1,null,null,null)),wt=$t.exports,qt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-AlreadyFix"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("分配到我的")])],1),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"errorid",label:"报修流水号",width:"200"}}),a("el-table-column",{attrs:{prop:"errordevicename",label:"故障设备名称",width:"200"}}),a("el-table-column",{attrs:{prop:"errordeviceNo",label:"故障设备编号",width:"200"}}),a("el-table-column",{attrs:{prop:"reportername",label:"报修人员",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"reportertime",label:"报修时间",width:"180"}}),a("el-table-column",{attrs:{prop:"assigneename",label:"维修人员",width:"180"}}),a("el-table-column",{attrs:{prop:"assigneestatus",label:"维修状态",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.errordetail(t.$index)}}},[e._v("查看详情")])]}}])})],1),a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[15,30,50,100],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},St=[],Rt={created:function(){this.refresh()},data:function(){return{taskData:[],tablewidth:"150",currentPage:1,page_size:15,page:1,total:0}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return this.active++,new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},refresh:function(){var e=this,t=this;t.taskData=[];var a="issue/assignee?page=0&size="+t.page_size;t.request(a,{},"GET").then((function(a){console.log(a.data),t.total=a.data.totalElements;for(var s=function(s){var n={};n.errorid=a.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=t.renderTime(a.data.content[s].createdAt),null!=a.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=a.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=a.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==a.data.content[s].closed&&null!=a.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<a.data.content[s].device.length;o++){var l="device/"+a.data.content[s].device[o].id;t.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+a.data.content[s].reporter.id;t.request(o,{},"GET").then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){if(1==a.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<a.data.content[s].assignee.length;o++){var l="user/"+a.data.content[s].assignee[o].id;t.request(l,{},"GET").then((function(e){console.log(e.data),n.assigneename=e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){t.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<a.data.content.length;n++)s(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},errordetail:function(e){var t=this;console.log(t.taskData[e]),t.$router.push({path:"./errorDetail",query:t.taskData[e]})},handleSizeChange:function(e){var t=this,a=this;a.taskData=[],console.log(e),a.page_size=e,a.currentPage=1;var s="issue/assignee?page=0&size="+a.page_size;console.log(s),a.request(s,{},"GET").then((function(e){console.log(e.data),a.total=e.data.totalElements;for(var s=function(s){var n={};n.errorid=e.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=a.renderTime(e.data.content[s].createdAt),null!=e.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=e.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=e.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==e.data.content[s].closed&&null!=e.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<e.data.content[s].device.length;o++){var l="device/"+e.data.content[s].device[o].id;a.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+e.data.content[s].reporter.id;a.request(o,{},"GET").then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})})),setTimeout((function(){if(1==e.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<e.data.content[s].assignee.length;o++){var l="user/"+e.data.content[s].assignee[o].id;a.request(l,{},"GET").then((function(e){console.log(e.data),n.assigneename=e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){a.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<e.data.content.length;n++)s(n);setTimeout((function(){a.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handleCurrentChange:function(e){var t=this,a=this;a.page=e,a.currentPage=e,console.log(e);var s="issue/assignee?page=0"+(a.page-1)+"&size="+a.page_size;console.log(s),a.request(s,{},"GET").then((function(e){console.log(e.data),a.total=e.data.totalElements;for(var s=function(s){var n={};n.errorid=e.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=a.renderTime(e.data.content[s].createdAt),null!=e.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=e.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=e.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==e.data.content[s].closed&&null!=e.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<e.data.content[s].device.length;o++){var l="device/"+e.data.content[s].device[o].id;a.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+e.data.content[s].reporter.id;a.request(o,{},"GET").then((function(e){console.log(e.data),n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})})),setTimeout((function(){if(1==e.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<e.data.content[s].assignee.length;o++){if(1==e.data.content[s].assignee.length)n.assigneename="未分配";else for(var l=1;l<e.data.content[s].assignee.length;l++){var i="user/"+e.data.content[s].assignee[l].id;a.request(i,{},"GET").then((function(e){console.log(e.data),n.assigneename=e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){a.taskData.push(n)}),800)}setTimeout((function(){a.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<e.data.content.length;n++)s(n);setTimeout((function(){a.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}}},zt=Rt,Ot=(a("bbed"),Object(r["a"])(zt,qt,St,!1,null,null,null)),At=Ot.exports,Pt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-FixDiagnosis"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("我发布的")])],1),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表 ")])],1),a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"errorid",label:"报修流水号",width:"200"}}),a("el-table-column",{attrs:{prop:"errordevicename",label:"故障设备名称",width:"200"}}),a("el-table-column",{attrs:{prop:"errordeviceNo",label:"故障设备编号",width:"200"}}),a("el-table-column",{attrs:{prop:"reportername",label:"报修人员",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"reportertime",label:"报修时间",width:"180"}}),a("el-table-column",{attrs:{prop:"assigneename",label:"维修人员",width:"180"}}),a("el-table-column",{attrs:{prop:"assigneestatus",label:"维修状态",width:e.tablewidth}}),a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.errordetail(t.$index)}}},[e._v("查看详情")]),e.iffixed?e._e():a("el-button",{on:{click:function(a){return e.reverterror(t.$index)}}},[e._v("撤销")])]}}])})],1),a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[15,30,50,100],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},Nt=[],Gt={created:function(){this.refresh()},data:function(){return{taskData:[],tablewidth:"150",iffixed:!1,currentPage:1,page_size:15,page:1,size:5,total:0}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return this.active++,new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},refresh:function(){var e=this,t=this;t.taskData=[];var a="issue/reporter?page=0&size="+t.page_size;t.request(a,{},"GET").then((function(a){console.log(a.data),t.total=a.data.totalElements;for(var s=function(s){var n={};n.errorid=a.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=t.renderTime(a.data.content[s].createdAt),null!=a.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=a.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=a.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==a.data.content[s].closed&&null!=a.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<a.data.content[s].device.length;o++){var l="device/"+a.data.content[s].device[o].id;t.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+a.data.content[s].reporter.id;t.request(o,{},"GET").then((function(e){n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){if(1==a.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<a.data.content[s].assignee.length;o++){var l="user/"+a.data.content[s].assignee[o].id;t.request(l,{},"GET").then((function(e){n.assigneename=e.data.name})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){t.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<a.data.content.length;n++)s(n);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},errordetail:function(e){var t=this;console.log(t.taskData[e]),t.$router.push({path:"./mySubmitDetail",query:t.taskData[e]})},reverterror:function(e){var t=this;console.log(t.taskData[e]),this.$confirm("确定撤销此报修申请吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a="issue/revert/"+t.taskData[e].errorid;t.request(a,{},"POST").then((function(){t.$message({message:"撤销成功",type:"success"}),t.refresh()})).catch((function(){t.$message({message:"撤销失败",type:"error"})}))}))},handleSizeChange:function(e){var t=this,a=this;a.taskData=[],console.log(e),a.size=e,a.page_size=e;var s="issue/reporter?page=0&size="+a.size;console.log(s),a.request(s,{},"GET").then((function(e){console.log(e.data),a.total=e.data.totalElements;for(var s=function(s){var n={};n.errorid=e.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=a.renderTime(e.data.content[s].createdAt),null!=e.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=e.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=e.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==e.data.content[s].closed&&null!=e.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<e.data.content[s].device.length;o++){var l="device/"+e.data.content[s].device[o].id;a.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+e.data.content[s].reporter.id;a.request(o,{},"GET").then((function(e){n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})})),setTimeout((function(){if(1==e.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<e.data.content[s].assignee.length;o++){var l="user/"+e.data.content[s].assignee[o].id;a.request(l,{},"GET").then((function(e){n.assigneename=e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){a.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<e.data.content.length;n++)s(n);setTimeout((function(){a.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handleCurrentChange:function(e){var t=this,a=this;a.page=e,a.currentPage=e,console.log(e);var s="issue/reporter?page="+(a.page-1)+"&size="+a.size;console.log(s),a.request(s,{},"GET").then((function(e){console.log(e.data),a.total=e.data.totalElements;for(var s=function(s){var n={};n.errorid=e.data.content[s].id,n.errordevicename="",n.errordeviceNo="",n.assigneename="",n.reportertime=a.renderTime(e.data.content[s].createdAt),null!=e.data.content[s].createdAt&&(n.assigneestatus="未分配"),null!=e.data.content[s].assignedAt&&(n.assigneestatus="已分配"),null!=e.data.content[s].fixedAt&&(n.assigneestatus="待确认"),1==e.data.content[s].closed&&null!=e.data.content[s].closedAt&&(n.assigneestatus="已完成"),setTimeout((function(){for(var o=0;o<e.data.content[s].device.length;o++){var l="device/"+e.data.content[s].device[o].id;a.request(l,{},"GET").then((function(e){n.errordevicename=e.data.name,n.errordeviceNo=e.data.deviceNo})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){var o="user/"+e.data.content[s].reporter.id;a.request(o,{},"GET").then((function(e){n.reportername=void 0==e.data.name?"未分配":e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})})),setTimeout((function(){if(1==e.data.content[s].assignee.length)n.assigneename="未分配";else for(var o=1;o<e.data.content[s].assignee.length;o++){var l="user/"+e.data.content[s].assignee[o].id;a.request(l,{},"GET").then((function(e){n.assigneename=e.data.name})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}setTimeout((function(){a.taskData.push(n)}),800)}),300)}),300)}),300)},n=0;n<e.data.content.length;n++)s(n);setTimeout((function(){a.$message({message:"刷新成功",type:"success"})}),1e3)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}}},Lt=Gt,Bt=(a("945e"),Object(r["a"])(Lt,Pt,Nt,!1,null,null,null)),Mt=Bt.exports,Vt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-MySubmitDetail"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("设备维修")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("我发布的详情 ")])],1),a("div",{staticClass:"Task-container"},[a("div",{staticClass:"Step"},[a("el-steps",{attrs:{active:e.active,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"申请",description:e.applytime}}),a("el-step",{attrs:{title:"分配",description:e.assigntime}}),a("el-step",{attrs:{title:"修复",description:e.fixtime}}),a("el-step",{attrs:{title:"确认",description:e.completetime}})],1)],1),a("div",{staticClass:"Task-info"},[e._m(0),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报修流水号")]),a("div",{staticClass:"Info"},[e._v(e._s(e.errorid))])]),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报修人员")]),e._l(e.applyusers,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail,avatar:e.avatar}})}))],2)]),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("异常描述和异常处理请求")]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.errorcontent)}})])])]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("报修设备")]),a("el-table",{staticClass:"extraTable",staticStyle:{"margin-top":"10px",width:"100%"},attrs:{data:e.devicetableData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"id",label:"设备ID"}}),a("el-table-column",{attrs:{prop:"name",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"brand",label:"设备品牌"}}),a("el-table-column",{attrs:{prop:"deviceNo",label:"设备编号"}}),a("el-table-column",{attrs:{prop:"clazz",label:"设备分类"}})],1)],1)])]),a("div",{staticClass:"Task-info"},[e._m(1),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("维修人员-Supervisor")]),e._l(e.supervisor,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail,avatar:e.avatar}})}))],2),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("维修人员-Operator")]),e._l(e.operator,(function(e,t){return a("user",{key:t,staticStyle:{"margin-top":"10px"},attrs:{name:e.name,username:e.username,useremail:e.useremail,avatar:e.avatar}})}))],2)])]),a("div",{staticClass:"Task-info Last"},[e._m(2),a("div",{staticClass:"Part"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("异常类型")]),a("div",{staticClass:"Info"},[e._v(e._s(e.exceptionType))])]),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("发生原因")]),a("div",{staticClass:"Info"},[e._v(e._s(e.reason))])])]),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("异常解决措施和处理结果")]),a("div",{staticClass:"ql-snow"},[a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.solution)}})])]),a("div",{staticClass:"part",staticStyle:{width:"50%"}},[a("div",{staticClass:"Text"},[e._v("报修人员拒绝原因")]),a("div",{staticClass:"Info"},[e._v(e._s(e.refusereason))])])])]),e.reporterid==e.userid&&e.openconfirm?a("div",{staticClass:"Task-info Last"},[e._m(3),a("div",{staticClass:"Part lastpart"},[a("div",{staticClass:"part",staticStyle:{width:"100%"}},[a("div",{staticClass:"Text"},[e._v("接受维修处理")]),e.closed?a("div",{staticStyle:{"font-weight":"bold","margin-top":"10px",color:"#4cd137"}},[e._v(" 已确认 ")]):a("div",{staticClass:"backbtn_right"},[a("el-button",{staticClass:"confirm",on:{click:e.confirm}},[e._v("确认")]),a("el-button",{staticClass:"refuse",on:{click:e.refuse}},[e._v("拒绝")])],1)])])]):e._e()]),a("el-dialog",{attrs:{title:"拒绝原因",visible:e.refusedialog,width:"35%"},on:{"update:visible":function(t){e.refusedialog=t}}},[a("el-input",{attrs:{placeholder:"请输入拒绝原因",type:"textarea",rows:"6"},model:{value:e.refusereason,callback:function(t){e.refusereason=t},expression:"refusereason"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.refusedialog=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitrefusereason}},[e._v("确 定")])],1)],1)],1)},Ut=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 申请 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 分配 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 修复 ")])])])},function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Part"},[a("div",{staticClass:"part"},[a("div",{staticClass:"Text",staticStyle:{color:"#409eff","font-size":"30px","font-weight":"normal"}},[e._v(" 完成 ")])])])}],Ft={created:function(){var e=this,t=this;t.active=0,console.log(t.$route.query),t.errorid=t.$route.query.errorid,t.userid=this.globaldata.userid;var a="issue/"+t.$route.query.errorid;t.request(a,{},"GET").then((function(a){console.log(a.data),t.reporterid=a.data.reporter.id,t.errorcontent=a.data.content,t.reason=null==a.data.reason?"暂无":a.data.reason,t.solution=null==a.data.solution?"暂无":a.data.solution,t.exceptionType=null==a.data.exceptionType?"暂无":a.data.exceptionType,t.closed=a.data.closed,t.refusereason=null==a.data.rejectReason?"无":a.data.rejectReason,null!=a.data.createdAt&&(t.applytime=t.renderTime(a.data.createdAt)),null!=a.data.assignedAt&&(t.assigntime=t.renderTime(a.data.assignedAt)),null!=a.data.fixedAt&&(t.fixtime=t.renderTime(a.data.fixedAt),t.openconfirm=!0),1==a.data.closed&&null!=a.data.closedAt&&(t.completetime=t.renderTime(a.data.closedAt));for(var s={fixusersid:[]},n=0;n<a.data.assignee.length;n++)s.fixusersid.push({assigneeid:a.data.assignee[n].id});s.applyusersid=a.data.reporter.id,setTimeout((function(){var a="user/query?id=="+s.applyusersid;if(t.request(a,{},"GET").then((function(e){console.log(e.data),t.applyusers.push({name:e.data.content[0].name,username:e.data.content[0].username,useremail:e.data.content[0].email,avatar:null==e.data.content[0].avatar?void 0:"http://1.15.236.205/api/pic/"+e.data.content[0].avatar})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),void 0!=s.fixusersid){var n="user/query?id=="+s.fixusersid[0].assigneeid;if(t.request(n,{},"GET").then((function(e){console.log(e.data);var a={};a.name=e.data.content[0].name,a.username=e.data.content[0].username,a.useremail=e.data.content[0].email,a.avatar=null==e.data.content[0].avatar?void 0:"http://1.15.236.205/api/pic/"+e.data.content[0].avatar,console.log(a),t.supervisor.push(a)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),1==s.fixusersid.length)t.operator.push({name:"暂未分配",username:"暂未分配",useremail:"暂未分配",avatar:void 0});else{t.assigned=!0;for(var o=1;o<s.fixusersid.length;o++){s.fixusersid[o].assigneeid==e.userid&&(t.opstofix=!0);var l="user/query?id=="+s.fixusersid[o].assigneeid;t.request(l,{},"GET").then((function(e){console.log(e.data.content[0].avatar);var a={};a.name=e.data.content[0].name,a.username=e.data.content[0].username,a.useremail=e.data.content[0].email,a.avatar=null==e.data.content[0].avatar?void 0:"http://1.15.236.205/api/pic/"+e.data.content[0].avatar,console.log(a),t.operator.push(a)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}}}),500);for(var o=0;o<a.data.device.length;o++){var l="device/"+a.data.device[o].id;t.request(l,{},"GET").then((function(e){var a={};a.id=e.data.id,a.name=e.data.name,a.brand=e.data.brand,a.deviceNo=e.data.deviceNo,a.clazz=e.data.clazz,t.devicetableData.push(a)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},data:function(){return{userid:"",reporterid:"",refusedialog:!1,active:0,closed:!1,openconfirm:!1,errorid:"",applyusers:[],errorcontent:"",fixusers:[],assigneeid:"",supervisor:[],operator:[],devicetableData:[],deviceinfo:[],reason:"",solution:"",exceptionType:"",refusereason:"",applytime:"",assigntime:"",fixtime:"",completetime:""}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return this.active++,new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},confirm:function(){var e=this,t=this;t.$confirm("确定接受处理吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a="issue/close/"+t.$route.query.errorid+"?closed=true";t.request(a,{},"POST").then((function(){t.$message({message:"接受处理成功",type:"success"}),setTimeout((function(){location.reload()}),300)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))})).catch((function(){e.$message({type:"info",message:"已取消"})}))},refuse:function(){var e=this,t=this;t.$confirm("确定拒绝处理吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.refusedialog=!0})).catch((function(){e.$message({type:"info",message:"已取消"})}))},submitrefusereason:function(){var e=this,t=this;console.log(t.refusereason);var a="issue/close/"+t.$route.query.errorid+"?closed=false&reason="+t.refusereason;t.request(a,{},"POST").then((function(){t.$message({message:"拒绝处理成功",type:"success"}),t.refusedialog=!1,setTimeout((function(){location.reload()}),300)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},imgurl:function(e){this.dialogImageUrl=e,this.dialogVisible=!0}},components:{User:dt["a"]}},jt=Ft,Wt=(a("a5c0"),Object(r["a"])(jt,Vt,Ut,!1,null,null,null)),Jt=Wt.exports,Yt=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-DailyRecord"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("数据分析")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("使用日志")])],1),a("div",{staticClass:"refresh"},[a("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:e.refresh}},[e._v("刷新列表")])],1),a("div",{staticClass:"Result"},[a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.LogData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"logid",label:"日志编号",width:"200"}}),a("el-table-column",{attrs:{prop:"logtime",label:"操作时间"}}),a("el-table-column",{attrs:{prop:"logcontent",label:"操作内容"}}),a("el-table-column",{attrs:{prop:"loguser",label:"操作人员"}}),a("el-table-column",{attrs:{prop:"setting",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{on:{click:function(a){return e.detail(t.$index)}}},[e._v("详情")])]}}])})],1),a("div",[a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[15,30,50,100],"page-size":e.page_size,layout:"sizes,total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)],1)},Ht=[],Qt={components:{},created:function(){var e=this;e.refresh()},data:function(){return{LogData:[],currentPage:1,page_size:15,page:1,total:0}},methods:{renderTime:function(e){if(null==e)return"暂无";var t=new Date(e).toJSON();return new Date(+new Date(t)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")},refresh:function(){var e=this,t=this;t.LogData=[],t.currentPage=1;var a="logging?page=0&size="+t.page_size;t.request(a,{},"GET").then((function(e){console.log(e.data),t.total=e.data.totalElements;for(var a=function(a){var s={};s.logid=e.data.content[a].id,s.logcontent=e.data.content[a].opName,s.opContent=e.data.content[a].opContent,s.logtime=t.renderTime(e.data.content[a].createdAt),setTimeout((function(){var n="user/"+e.data.content[a].operator.id;t.request(n,{},"GET").then((function(e){s.loguser=e.data.name})).catch((function(){s.loguser="获取失败"})),setTimeout((function(){t.LogData.push(s)}),1e3)}),300)},s=0;s<e.data.content.length;s++)a(s);setTimeout((function(){t.$message({message:"刷新成功",type:"success"})}),600)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},detail:function(e){var t=this;console.log(t.LogData[e]),t.$router.push({path:"./dailyRecordDetail",query:t.LogData[e]})},handleSizeChange:function(e){var t=this,a=this;a.LogData=[],a.currentPage=1,console.log(e),a.page_size=e;var s="logging?page=0&size="+a.page_size;console.log(s),a.request(s,{},"GET").then((function(e){console.log(e.data),a.total=e.data.totalElements;for(var t=function(t){var s={};s.logid=e.data.content[t].id,s.logcontent=e.data.content[t].opName,s.opContent=e.data.content[t].opContent,s.logtime=a.renderTime(e.data.content[t].createdAt),setTimeout((function(){var n="user/"+e.data.content[t].operator.id;a.request(n,{},"GET").then((function(e){console.log(e.data),s.loguser=e.data.name})).catch((function(){s.loguser="获取失败"})),setTimeout((function(){a.LogData.push(s)}),1e3)}),300)},s=0;s<e.data.content.length;s++)t(s);setTimeout((function(){a.$message({message:"刷新成功",type:"success"})}),600)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))},handleCurrentChange:function(e){var t=this,a=this;a.LogData=[],a.page=e,a.currentPage=e;var s="logging?page="+(a.page-1)+"&size="+a.page_size;a.request(s,{},"GET").then((function(e){console.log(e.data),a.total=e.data.totalElements;for(var t=function(t){var s={};s.logid=e.data.content[t].id,s.logcontent=e.data.content[t].opName,s.opContent=e.data.content[t].opContent,s.logtime=a.renderTime(e.data.content[t].createdAt),setTimeout((function(){var n="user/"+e.data.content[t].operator.id;a.request(n,{},"GET").then((function(e){s.loguser=e.data.name})).catch((function(){s.loguser="获取失败"})),setTimeout((function(){a.LogData.push(s)}),1e3)}),300)},s=0;s<e.data.content.length;s++)t(s);setTimeout((function(){a.$message({message:"刷新成功",type:"success"})}),600)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))}}},Xt=Qt,Zt=(a("8ed7"),Object(r["a"])(Xt,Yt,Ht,!1,null,null,null)),Kt=Zt.exports,ea=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container_DailyRecordDetail"},[a("div",{staticClass:"Box"},[a("div",{staticClass:"opuser_optime"},[a("div",{staticClass:"opuser"},[e._v(" 操作人员 "),a("span",[e._v(e._s(e.opusers))])]),a("div",{staticClass:"opuser"},[e._v(" 操作时间 "),a("span",[e._v(e._s(e.optime))])])]),a("div",{staticClass:"opuser_optime opcontent "},[a("div",{staticClass:"opuser content"},[e._v(" 操作具体内容 "),"创建维护记录"!=e.$route.query.logcontent?a("span",[e._v(e._s(e.opContent))]):e._e(),"创建维护记录"==e.$route.query.logcontent?a("div",{staticClass:"ql-snow"},[a("span",[e._v("用户创建的维护记录：")]),a("div",{staticClass:"ql-editor",domProps:{innerHTML:e._s(e.opContent)}})]):e._e()])])])])},ta=[],aa={created:function(){var e=this;switch(console.log(this.$route.query),console.log(JSON.parse(this.$route.query.opContent)),e.opusers=this.$route.query.loguser,e.optime=this.$route.query.logtime,this.$route.query.logcontent){case"用户登录":e.opContent="用户进行了登录操作";break;case"新增报修":e.opContent="新增报修的流水号："+JSON.parse(this.$route.query.opContent)[0].id;break;case"跟进报修":e.opContent="跟进报修的流水号："+JSON.parse(this.$route.query.opContent)[0];break;case"撤销报修":e.opContent="用户撤销了报修";break;case"确认报修完成":e.opContent="确认的报修流水号："+JSON.parse(this.$route.query.opContent)[0];break;case"添加设备":e.opContent="添加的设备："+JSON.parse(this.$route.query.opContent)[0].name+"（"+JSON.parse(this.$route.query.opContent)[0].deviceNo+"）";break;case"编辑设备":e.opContent="编辑的设备："+JSON.parse(this.$route.query.opContent)[0].name+"（"+JSON.parse(this.$route.query.opContent)[0].deviceNo+"）";break;case"删除设备":e.opContent="删除的设备ID："+this.$route.query.opContent;break;case"导入设备":e.opContent="用户进行了导入设备";break;case"导出设备":e.opContent="用户导出的设备条件："+this.$route.query.opContent;break;case"创建维护任务":e.opContent="创建的维护标准名称："+JSON.parse(this.$route.query.opContent)[0].name;break;case"编辑维护任务":e.opContent="编辑的维护标准名称："+JSON.parse(this.$route.query.opContent)[1].name;break;case"删除维护任务":e.opContent="删除的维护任务ID："+JSON.parse(this.$route.query.opContent)[0];break;case"创建维护记录":e.opContent=JSON.parse(this.$route.query.opContent)[0].record;break;case"编辑用户":e.opContent="编辑的用户ID："+JSON.parse(this.$route.query.opContent)[0];break;case"删除用户":e.opContent="用户进行了登录操作";break;case"添加额外字段":e.opContent="添加的额外字段名："+JSON.parse(this.$route.query.opContent)[0].name;break;case"删除额外字段":e.opContent="删除的额外字段id："+JSON.parse(this.$route.query.opContent)[0];break;default:break}},data:function(){return{opusers:"",optime:"",opContent:""}},methods:{}},sa=aa,na=(a("64b8"),Object(r["a"])(sa,ea,ta,!1,null,null,null)),oa=na.exports,la=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-FixAnalysis"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("数据分析")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("维修分析")])],1),a("div",{staticClass:"Search"},[a("div",{staticClass:"searchtask"},[e._v(" 选择设备： "),a("el-select",{attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.devicechange},model:{value:e.selectvalue,callback:function(t){e.selectvalue=t},expression:"selectvalue"}},e._l(e.selectoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1),a("div",e._l(e.dynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.handleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("div",{staticClass:"searchtask",staticStyle:{"margin-top":"10px"}},[e._v(" 选择报修人员： "),a("el-select",{attrs:{placeholder:"请选择报修人员",filterable:"",clearable:"",multiple:"","collapse-tags":""},on:{change:e.reporterchange},model:{value:e.reportervalue,callback:function(t){e.reportervalue=t},expression:"reportervalue"}},e._l(e.reporteroptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),a("div",{staticClass:"searchtask",staticStyle:{"margin-top":"10px"}},[e._v(" 选择维修人员： "),a("el-select",{attrs:{placeholder:"请选择维修人员",filterable:"",clearable:"",multiple:"","collapse-tags":""},on:{change:e.assigneechange},model:{value:e.assigneevalue,callback:function(t){e.assigneevalue=t},expression:"assigneevalue"}},e._l(e.assigneeoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),a("div",{staticClass:"searchpart"},[a("div",{staticStyle:{"margin-left":"5px"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"开始日期","value-format":"yyyy-MM-dd"},model:{value:e.startDate,callback:function(t){e.startDate=t},expression:"startDate"}})],1),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.endDate,callback:function(t){e.endDate=t},expression:"endDate"}})],1),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-button",{on:{click:e.search}},[e._v("查询")])],1),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-button",{staticClass:"clear",on:{click:e.clear}},[e._v("清空条件")])],1)])]),a("div",{staticClass:"Result"},[a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.deviceAnalysisData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"deviceid",label:"序号",width:"60"}}),a("el-table-column",{attrs:{prop:"unhealthyTime",label:"设备故障总时间（分钟）"}}),a("el-table-column",{attrs:{prop:"issueCount",label:"设备故障数"}}),a("el-table-column",{attrs:{prop:"avgFixPeriod",label:"设备平均维修耗时（分钟）"}}),a("el-table-column",{attrs:{prop:"avgIssuePeriod",label:"设备平均故障周期（分钟）"}})],1)],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.selectmodel,callback:function(t){e.selectmodel=t},expression:"selectmodel"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitselect}},[e._v("确 定")])],1)],1)],1)},ia=[],ra=(a("b680"),{components:{},created:function(){var e=this,t=this;t.$message({message:"选取了全部人员时，无需选择其他人员，以免搜索结果有误",type:"warning",duration:5e3}),t.request("device/info-field",{},"GET").then((function(e){for(var a=0;a<e.data.length;a++)t.selectoptions[1].options.push({value:e.data[a].id,label:e.data[a].name})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),t.request("user/query",{},"GET").then((function(e){for(var a=0;a<e.data.content.length;a++)"ROOT"==e.data.content[a].role?t.reporteroptions[0].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}):"ADMIN"==e.data.content[a].role?t.reporteroptions[1].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}):"OPERATOR"==e.data.content[a].role?t.reporteroptions[2].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}):"CREATOR"==e.data.content[a].role?t.reporteroptions[3].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"}):"SUPERVISOR"==e.data.content[a].role&&t.reporteroptions[4].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),t.request("user/query",{},"GET").then((function(e){for(var a=0;a<e.data.content.length;a++)"OPERATOR"==e.data.content[a].role&&t.assigneeoptions[0].options.push({value:e.data.content[a].id,label:e.data.content[a].name+" (用户名："+e.data.content[a].username+")"})})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))},data:function(){return{selectoptions:[{label:"基本字段",options:[{value:"name",label:"设备名称"},{value:"brand",label:"设备品牌"},{value:"type",label:"设备型号/规格"},{value:"deviceNo",label:"设备编号"},{value:"clazz",label:"设备分类"}]},{label:"附加字段",options:[]},{label:"全部维修",options:[{value:"all",label:"全部维修设备分析"}]}],ifdeviceall:!1,selectvalue:"",selectmodel:"",dialogSearchVisible:!1,selectInfo:[],dynamicTags:[],device:[],device1:[],startDate:"",endDate:"",deviceAnalysisData:[],ifreporterall:!1,reportervalue:[],reporteroptions:[{label:"ROOT",options:[]},{label:"ADMIN",options:[]},{label:"OPERATOR",options:[]},{label:"CREATOR",options:[]},{label:"SUPERVISOR",options:[]},{label:"全部人员",options:[{label:"全部人员",value:"reporterall"}]}],ifassigneeall:!1,assigneevalue:[],assigneeoptions:[{label:"OPERATOR",options:[]},{label:"全部人员",options:[{label:"全部人员",value:"assigneeall"}]}],avgFixPeriodTotal:0,avgIssuePeriodTotal:0,unhealthyTimeTotal:0,issueCountTotal:0}},methods:{devicechange:function(e){var t=this,a=this;a.ifdeviceall=!1,this.ifdevice=!1,"all"==e?(a.ifdeviceall=!0,a.device=[],a.request("device?page=0&size=1000000000",{},"GET").then((function(e){var t=0;for(console.log(e.data),t=0;t<e.data.content.length;t++)a.device.push(e.data.content[t].id);t==e.data.content.length&&(console.log(a.device),a.selectInfo=[],a.dynamicTags=[])})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))):this.dialogSearchVisible=!0},reporterchange:function(e){var t=this,a=this;"reporterall"==e&&(a.reportervalue=[],a.request("user/query",{},"GET").then((function(e){for(var t=0;t<e.data.content.length;t++)a.reportervalue.push(e.data.content[t].id)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))),console.log(a.reportervalue)},assigneechange:function(e){var t=this,a=this;"assigneeall"==e&&(a.assigneevalue=[],a.request("user/query",{},"GET").then((function(e){for(var t=0;t<e.data.content.length;t++)"OPERATOR"==e.data.content[t].role&&a.assigneevalue.push(e.data.content[t].id)})).catch((function(e){t.$message({message:e.response.data.message,type:"error"})}))),console.log(a.assigneevalue)},submitselect:function(){this.dialogSearchVisible=!1,this.selectInfo.push({ziduan:this.selectvalue,value:this.selectmodel}),this.dynamicTags.push(this.selectvalue+" / "+this.selectmodel)},handleClose:function(e){var t=this.dynamicTags.indexOf(e);console.log(t),this.dynamicTags.splice(t,1),this.selectInfo.splice(t,1)},search:function(){var e=this,t=this;if(t.avgFixPeriodTotal=0,t.avgIssuePeriodTotal=0,t.unhealthyTimeTotal=0,t.issueCountTotal=0,t.deviceAnalysisData=[],console.log(t.device),console.log(t.reportervalue),console.log(t.assigneevalue),t.device1=[],t.ifdeviceall)if(0==t.device.length||""==t.startDate||""==t.endDate||null==t.startDate||null==t.endDate)t.$message({message:"请输入将查询信息填写完整",type:"warning"});else if(new Date(this.startDate).getTime()>=new Date(this.endDate).getTime())t.$message({message:"结束时间必须大于开始时间",type:"warning"});else if(new Date(this.endDate).getTime()>(new Date).getTime())t.$message({message:"结束时间必须小于今天",type:"warning"});else{var a="issue/query?reporter=I"+t.reportervalue[0]+"&assignee=I"+t.assigneevalue[0];switch(!0){case 1==t.reportervalue.length&&1==t.assigneevalue.length:console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);t.device1=o;for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case 1==t.reportervalue.length&&t.assigneevalue.length>1:for(var s=1;s<t.assigneevalue.length;s++)a=a+","+t.assigneevalue[s];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);t.device1=o;for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case t.reportervalue.length>1&&1==t.assigneevalue.length:a="issue/query?assignee=I"+t.assigneevalue[0]+"&reporter=I"+t.reportervalue[0];for(var n=1;n<t.reportervalue.length;n++)a=a+","+t.reportervalue[n];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);t.device1=o;for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case t.reportervalue.length>1&&t.assigneevalue.length>1:a="issue/query?assignee=I"+t.assigneevalue[0];for(var o=1;o<t.assigneevalue.length;o++)a=a+","+t.assigneevalue[o];a+="&reporter=I"+t.reportervalue[0];for(var l=1;l<t.reportervalue.length;l++)a=a+","+t.reportervalue[l];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);t.device1=o;for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);t.device=a,console.log(t.device),0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case 0==t.reportervalue.length&&0==t.assigneevalue.length:console.log(t.device),0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice();break;case 0==t.reportervalue.length&&0!=t.assigneevalue.length:a="issue/query?assignee=I"+t.assigneevalue[0];for(var i=1;i<t.assigneevalue.length;i++)a=a+","+t.assigneevalue[i];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);t.device1=o;for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);t.device=a,console.log(t.device),0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case 0!=t.reportervalue.length&&0==t.assigneevalue.length:a="issue/query?reporter=I"+t.reportervalue[0];for(var r=1;r<t.reportervalue.length;r++)a=a+","+t.reportervalue[r];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);t.device1=o;for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);t.device=a,console.log(t.device),0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;default:break}}else if(0==t.selectInfo.length||""==t.startDate||""==t.endDate||null==t.startDate||null==t.endDate)t.$message({message:"请输入将查询信息填写完整",type:"warning"});else if(new Date(this.startDate).getTime()>=new Date(this.endDate).getTime())t.$message({message:"结束时间必须大于开始时间",type:"warning"});else if(new Date(this.endDate).getTime()>(new Date).getTime())t.$message({message:"结束时间必须小于今天",type:"warning"});else{t.device=[];var c="device/query?"+t.selectInfo[0].ziduan+"=L"+t.selectInfo[0].value+"%25";if(1==t.selectInfo.length)console.log(c),t.request(c,{},"GET").then((function(a){if(0==a.data.content.length)t.$message({message:"无结果",type:"warning"});else{console.log(a.data);for(var s=0;s<a.data.content.length;s++)t.device.push(a.data.content[s].id);setTimeout((function(){var a="issue/query?reporter=I"+t.reportervalue[0]+"&assignee=I"+t.assigneevalue[0];switch(!0){case 1==t.reportervalue.length&&1==t.assigneevalue.length:t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);if(t.device1=o,t.device.length>t.device1.length)for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);else for(var c=0;c<t.device1.length;c++)for(var d=0;d<t.device.length;d++)t.device[d]===t.device1[c]&&a.push(t.device[d]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case 1==t.reportervalue.length&&t.assigneevalue.length>1:for(var s=1;s<t.assigneevalue.length;s++)a=a+","+t.assigneevalue[s];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);if(t.device1=o,console.log(t.device1),console.log(t.device),t.device.length>t.device1.length)for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);else for(var c=0;c<t.device1.length;c++)for(var d=0;d<t.device.length;d++)t.device[d]===t.device1[c]&&a.push(t.device[d]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case t.reportervalue.length>1&&1==t.assigneevalue.length:a="issue/query?assignee=I"+t.assigneevalue[0]+"&reporter=I"+t.reportervalue[0];for(var n=1;n<t.reportervalue.length;n++)a=a+","+t.reportervalue[n];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);if(t.device1=o,console.log(t.device1),console.log(t.device),t.device.length>t.device1.length)for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);else for(var c=0;c<t.device1.length;c++)for(var d=0;d<t.device.length;d++)t.device[d]===t.device1[c]&&a.push(t.device[d]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case t.reportervalue.length>1&&t.assigneevalue.length>1:a="issue/query?assignee=I"+t.assigneevalue[0];for(var o=1;o<t.assigneevalue.length;o++)a=a+","+t.assigneevalue[o];a+="&reporter=I"+t.reportervalue[0];for(var l=1;l<t.reportervalue.length;l++)a=a+","+t.reportervalue[l];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);if(t.device1=o,console.log(t.device1),console.log(t.device),t.device.length>t.device1.length)for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);else for(var c=0;c<t.device1.length;c++)for(var d=0;d<t.device.length;d++)t.device[d]===t.device1[c]&&a.push(t.device[d]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case 0==t.reportervalue.length&&0==t.assigneevalue.length:console.log(t.device),0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice();break;case 0==t.reportervalue.length&&0!=t.assigneevalue.length:a="issue/query?assignee=I"+t.assigneevalue[0];for(var i=1;i<t.assigneevalue.length;i++)a=a+","+t.assigneevalue[i];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);t.device1=o;for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);t.device=a,console.log(t.device),0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case 0!=t.reportervalue.length&&0==t.assigneevalue.length:a="issue/query?reporter=I"+t.reportervalue[0];for(var r=1;r<t.reportervalue.length;r++)a=a+","+t.reportervalue[r];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);t.device1=o;for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);t.device=a,console.log(t.device),0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;default:break}}),300)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));else{for(var d=1;d<t.selectInfo.length;d++)c=c+"&"+t.selectInfo[d].ziduan+"=L"+t.selectInfo[d].value+"%25";console.log(c),t.request(c,{},"GET").then((function(a){if(0==a.data.content.length)t.$message({message:"无结果",type:"warning"});else{console.log(a.data);for(var s=0;s<a.data.content.length;s++)t.device.push(a.data.content[s].id);setTimeout((function(){var a="issue/query?reporter=I"+t.reportervalue[0]+"&assignee=I"+t.assigneevalue[0];switch(!0){case 1==t.reportervalue.length&&1==t.assigneevalue.length:t.request(c,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);if(t.device1=o,t.device.length>t.device1.length)for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);else for(var c=0;c<t.device1.length;c++)for(var d=0;d<t.device.length;d++)t.device[d]===t.device1[c]&&a.push(t.device[d]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case 1==t.reportervalue.length&&t.assigneevalue.length>1:for(var s=1;s<t.assigneevalue.length;s++)a=a+","+t.assigneevalue[s];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);if(t.device1=o,console.log(t.device1),console.log(t.device),t.device.length>t.device1.length)for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);else for(var c=0;c<t.device1.length;c++)for(var d=0;d<t.device.length;d++)t.device[d]===t.device1[c]&&a.push(t.device[d]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case t.reportervalue.length>1&&1==t.assigneevalue.length:a="issue/query?assignee=I"+t.assigneevalue[0]+"&reporter=I"+t.reportervalue[0];for(var n=1;n<t.reportervalue.length;n++)a=a+","+t.reportervalue[n];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);if(t.device1=o,console.log(t.device1),console.log(t.device),t.device.length>t.device1.length)for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);else for(var c=0;c<t.device1.length;c++)for(var d=0;d<t.device.length;d++)t.device[d]===t.device1[c]&&a.push(t.device[d]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case t.reportervalue.length>1&&t.assigneevalue.length>1:a="issue/query?assignee=I"+t.assigneevalue[0];for(var o=1;o<t.assigneevalue.length;o++)a=a+","+t.assigneevalue[o];a+="&reporter=I"+t.reportervalue[0];for(var l=1;l<t.reportervalue.length;l++)a=a+","+t.reportervalue[l];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);if(t.device1=o,console.log(t.device1),console.log(t.device),t.device.length>t.device1.length)for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);else for(var c=0;c<t.device1.length;c++)for(var d=0;d<t.device.length;d++)t.device[d]===t.device1[c]&&a.push(t.device[d]);t.device=a,0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case 0==t.reportervalue.length&&0==t.assigneevalue.length:console.log(t.device),0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice();break;case 0==t.reportervalue.length&&0!=t.assigneevalue.length:a="issue/query?assignee=I"+t.assigneevalue[0];for(var i=1;i<t.assigneevalue.length;i++)a=a+","+t.assigneevalue[i];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);t.device1=o;for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);t.device=a,console.log(t.device),0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;case 0!=t.reportervalue.length&&0==t.assigneevalue.length:a="issue/query?reporter=I"+t.reportervalue[0];for(var r=1;r<t.reportervalue.length;r++)a=a+","+t.reportervalue[r];console.log(a),t.request(a,{},"GET").then((function(e){console.log(e.data);for(var a=[],s=0;s<e.data.content.length;s++)for(var n=0;n<e.data.content[s].device.length;n++)t.device1.push(e.data.content[s].device[n].id);for(var o=[],l=0;l<t.device1.length;l++)-1==o.indexOf(t.device1[l])&&o.push(t.device1[l]);t.device1=o;for(var i=0;i<t.device.length;i++)for(var r=0;r<t.device1.length;r++)t.device1[r]===t.device[i]&&a.push(t.device1[r]);t.device=a,console.log(t.device),0==t.device.length?t.$message({message:"无结果",type:"warning"}):t.confirmdevice()})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}));break;default:break}}),300)}})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}}},confirmdevice:function(){var e=this,t=this,a=1;if(console.log(t.device),t.device.length<=1){var s="analysis/device?did="+t.device[0]+"&start="+t.startDate+"&end="+t.endDate;t.request(s,{},"GET").then((function(e){console.log(e.data);var s={};s.deviceid=a++,s.avgFixPeriod=e.data[t.device[0]].avgFixPeriod,s.avgIssuePeriod=e.data[t.device[0]].avgIssuePeriod,s.unhealthyTime=e.data[t.device[0]].unhealthyTime,s.issueCount=e.data[t.device[0]].issueCount,console.log(s),setTimeout((function(){t.deviceAnalysisData.push(s)}),600)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}else{for(var n="analysis/device?did="+t.device[0],o=1;o<t.device.length;o++)n=n+","+t.device[o];n=n+"&start="+t.startDate+"&end="+t.endDate,console.log(n),t.request(n,{},"GET").then((function(e){console.log(e);var s=0,n=function(){var n={};n.deviceid=a++,n.avgFixPeriod=e.data[t.device[s]].avgFixPeriod.toFixed(3),t.avgFixPeriodTotal+=e.data[t.device[s]].avgFixPeriod,n.avgIssuePeriod=e.data[t.device[s]].avgIssuePeriod.toFixed(3),t.avgIssuePeriodTotal+=e.data[t.device[s]].avgIssuePeriod,n.unhealthyTime=e.data[t.device[s]].unhealthyTime.toFixed(3),t.unhealthyTimeTotal+=e.data[t.device[s]].unhealthyTime,n.issueCount=e.data[t.device[s]].issueCount,t.issueCountTotal+=e.data[t.device[s]].issueCount,console.log(n),setTimeout((function(){t.deviceAnalysisData.push(n)}),600)};for(s=0;s<t.device.length;s++)n();setTimeout((function(){var e={deviceid:"总计"};e.avgFixPeriod=(1*t.avgFixPeriodTotal/t.deviceAnalysisData.length).toFixed(3),e.avgIssuePeriod=(1*t.avgIssuePeriodTotal/t.deviceAnalysisData.length).toFixed(3),e.unhealthyTime=t.unhealthyTimeTotal.toFixed(3),e.issueCount=t.issueCountTotal,console.log(e),t.deviceAnalysisData.unshift(e)}),800)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})}))}setTimeout((function(){t.$message({message:"查询成功",type:"success"})}),500)},clear:function(){this.ifdeviceall=!1,this.ifreporterall=!1,this.ifassigneeall=!1,this.selectvalue="",this.selectInfo=[],this.reportervalue=[],this.assigneevalue=[],this.dynamicTags=[],this.startDate="",this.endDate="",this.deviceAnalysisData=[],this.ifdevice=!1}}}),ca=ra,da=(a("c789"),Object(r["a"])(ca,la,ia,!1,null,null,null)),ua=da.exports,pa=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"Container-TaskAnalysis"},[a("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[a("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("数据分析")]),a("el-breadcrumb-item",{staticClass:"active"},[e._v("保养分析")])],1),a("div",{staticClass:"Search"},[a("div",{staticClass:"searchtask"},[e._v(" 选择设备： "),a("el-select",{attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.deviceselectchange},model:{value:e.deviceselectvalue,callback:function(t){e.deviceselectvalue=t},expression:"deviceselectvalue"}},e._l(e.deviceoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1),a("div",e._l(e.devicedynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.devicehandleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("div",{staticClass:"searchtask"},[e._v(" 选择人员： "),a("el-select",{attrs:{placeholder:"请选择保养人员",filterable:"",clearable:"",multiple:"","collapse-tags":""},on:{change:e.opsselectchange},model:{value:e.opsvalue,callback:function(t){e.opsvalue=t},expression:"opsvalue"}},e._l(e.opsoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1)],1),a("div",{staticClass:"searchtask"},[e._v(" 选择保养： "),a("el-select",{attrs:{placeholder:"请选择搜索字段",filterable:"",clearable:""},on:{change:e.taskselectchange},model:{value:e.taskselectvalue,callback:function(t){e.taskselectvalue=t},expression:"taskselectvalue"}},e._l(e.selectoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1),a("div",e._l(e.taskdynamicTags,(function(t){return a("el-tag",{key:t,staticStyle:{"margin-left":"5px"},attrs:{closable:""},on:{close:function(a){return e.taskhandleClose(t)}}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("div",{staticClass:"searchpart"},[a("div",{staticStyle:{"margin-left":"5px"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"开始日期","value-format":"yyyy-MM-dd"},model:{value:e.start,callback:function(t){e.start=t},expression:"start"}})],1),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"结束日期","value-format":"yyyy-MM-dd"},model:{value:e.end,callback:function(t){e.end=t},expression:"end"}})],1),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-button",{on:{click:e.search}},[e._v("查询")])],1),a("div",{staticStyle:{"margin-left":"10px"}},[a("el-button",{staticClass:"clear",on:{click:e.clear}},[e._v("清空条件")])],1)])]),a("div",{staticClass:"Result"},[a("el-table",{ref:"multipleTable",staticClass:"extraTable",staticStyle:{width:"100%"},attrs:{data:e.taskAnalysisData,stripe:"",border:""}},[a("el-table-column",{attrs:{prop:"taskid",label:"序号",width:"60"}}),a("el-table-column",{attrs:{prop:"times",label:"保养总数"}}),a("el-table-column",{attrs:{prop:"incompleteTimes",label:"未按时保养次数"}}),a("el-table-column",{attrs:{prop:"overdueTimes",label:"逾期完成次数"}}),a("el-table-column",{attrs:{prop:"recordTimes",label:"记录次数"}}),a("el-table-column",{attrs:{prop:"onTimeRate",label:"准时完成保养率"}}),a("el-table-column",{attrs:{prop:"completeRate",label:"保养完成率"}})],1)],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchTaskVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchTaskVisible=t}}},["name"==e.taskselectvalue?a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.namevalue,callback:function(t){e.namevalue=t},expression:"namevalue"}}):e._e(),"scheduleType"==e.taskselectvalue?a("el-select",{attrs:{placeholder:"请选择保养周期",filterable:"",clearable:""},model:{value:e.scheduleTypevalue,callback:function(t){e.scheduleTypevalue=t},expression:"scheduleTypevalue"}},e._l(e.scheduleTypeoptions,(function(t){return a("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)})),1):e._e(),"startDate"==e.taskselectvalue?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.datevalue,callback:function(t){e.datevalue=t},expression:"datevalue"}}):e._e(),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchTaskVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.tasksubmitselect}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"搜索条件",visible:e.dialogSearchDeviceVisible,width:"35%"},on:{"update:visible":function(t){e.dialogSearchDeviceVisible=t}}},[a("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.devicevalue,callback:function(t){e.devicevalue=t},expression:"devicevalue"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSearchDeviceVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.devicesubmitselect}},[e._v("确 定")])],1)],1)],1)},va=[],ma={components:{},created:function(){var e=Object(It["a"])(regeneratorRuntime.mark((function e(){var t,a,s,n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this,t.$message({message:"选取了全部人员时，请勿选择其他人员，以免搜索结果有误",type:"warning",duration:5e3}),e.next=4,t.request("device/info-field",{},"GET");case 4:for(a=e.sent,s=0;s<a.data.length;s++)t.deviceoptions[1].options.push({value:a.data[s].id,label:a.data[s].name});return e.next=8,t.request("user/query?role==OPERATOR",{},"GET");case 8:for(n=e.sent,o=0;o<n.data.content.length;o++)t.opsoptions[0].options.push({value:n.data.content[o].id,label:n.data.content[o].name+" (用户名："+n.data.content[o].username+")"});case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),data:function(){return{url:"",selectoptions:[{label:"字段",options:[{value:"name",label:"标准名称"},{value:"scheduleType",label:"保养周期"},{value:"startDate",label:"开始时间"}]},{label:"全部保养",options:[{value:"taskall",label:"全部保养分析"}]}],ifdeviceall:!1,iftaskall:!1,ifopsall:!1,deviceselectvalue:"",taskselectvalue:"",namevalue:"",dialogSearchTaskVisible:!1,dialogSearchDeviceVisible:!1,deviceselectInfo:[],taskselectInfo:[],opsselectInfo:[],devicedynamicTags:[],taskdynamicTags:[],scheduleTypevalue:"",scheduleTypeoptions:[{label:"保养周期",options:[{value:"Monthly",label:"月保养"},{value:"Yearly",label:"年保养"},{value:"Seasonly",label:"季度保养"},{value:"Daily",label:"日保养"},{value:"Weekly",label:"周保养"}]}],devicevalue:"",deviceoptions:[{label:"基本字段",options:[{value:"name",label:"设备名称"},{value:"brand",label:"设备品牌"},{value:"type",label:"设备型号/规格"},{value:"deviceNo",label:"设备编号"},{value:"clazz",label:"设备分类"}]},{label:"附加字段",options:[]},{label:"全部",options:[{value:"deviceall",label:"全部设备"}]}],opsvalue:[],opsoptions:[{label:"人员列表",options:[]},{label:"全部人员",options:[{value:"opsall",label:"全部人员"}]}],datevalue:"",task:[],device:[],task1:[],task2:[],task3:[],start:"",end:"",taskAnalysisData:[],timesTotal:0,overdueTimesTotal:0,recordTimesTotal:0,incompleteTimesTotal:0,completeRateTotal:0,onTimeRateTotal:0}},methods:{taskselectchange:function(e){var t=this;return Object(It["a"])(regeneratorRuntime.mark((function a(){var s,n,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(s=t,s.devicedisabled=!0,s.opsdisabled=!0,s.iftaskall=!1,"taskall"!=e){a.next=15;break}return s.iftaskall=!0,s.task=[],a.next=9,s.request("ops/schedule?page=0&size=100000000",{},"GET");case 9:for(n=a.sent,o=0,o=0;o<n.data.content.length;o++)s.task.push(n.data.content[o].id);o==n.data.content.length&&(s.taskselectInfo=[],s.dynamicTags=[]),a.next=16;break;case 15:t.dialogSearchTaskVisible=!0;case 16:case"end":return a.stop()}}),a)})))()},deviceselectchange:function(e){var t=this;t.taskdisabled=!0,t.ifdeviceall=!1,"deviceall"==e?(t.ifdeviceall=!0,t.device=[],t.deviceselectInfo=[],t.devicedynamicTags=[]):this.dialogSearchDeviceVisible=!0},opsselectchange:function(e){var t=this;"opsall"==e?(t.ifopsall=!0,t.opsselectInfo=[]):t.opsselectInfo.unshift({ziduan:"ops",value:t.opsvalue}),console.log(t.opsvalue)},tasksubmitselect:function(){this.dialogSearchTaskVisible=!1,"scheduleType"==this.taskselectvalue?(this.taskselectInfo.push({ziduan:this.taskselectvalue,value:this.scheduleTypevalue}),this.taskdynamicTags.push(this.taskselectvalue+" / "+this.scheduleTypevalue)):"startDate"==this.taskselectvalue?(console.log(this.opsvalue),this.taskselectInfo.push({ziduan:this.taskselectvalue,value:this.datevalue}),this.taskdynamicTags.push(this.taskselectvalue+" / "+this.datevalue)):(this.taskselectInfo.push({ziduan:this.taskselectvalue,value:this.namevalue}),this.taskdynamicTags.push(this.taskselectvalue+" / "+this.namevalue))},devicesubmitselect:function(){this.dialogSearchDeviceVisible=!1,this.deviceselectInfo.push({ziduan:this.deviceselectvalue,value:this.devicevalue}),this.devicedynamicTags.push(this.deviceselectvalue+" / "+this.devicevalue)},devicehandleClose:function(e){var t=this.devicedynamicTags.indexOf(e);console.log(t),this.devicedynamicTags.splice(t,1),this.deviceselectInfo.splice(t,1)},taskhandleClose:function(e){var t=this.taskdynamicTags.indexOf(e);console.log(t),this.taskdynamicTags.splice(t,1),this.taskselectInfo.splice(t,1)},searchdata:function(){var e=this;return Object(It["a"])(regeneratorRuntime.mark((function t(){var a,s,n,o,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,a.timesTotal=0,a.overdueTimesTotal=0,a.recordTimesTotal=0,a.incompleteTimesTotal=0,a.completeRateTotal=0,a.onTimeRateTotal=0,""==a.start||""==a.end||null==a.start||null==a.end)a.$message({message:"请选择起止日期",type:"warning"});else if(new Date(a.start).getTime()>=new Date(a.end).getTime())a.$message({message:"结束时间必须大于开始时间",type:"warning"});else if(new Date(a.end).getTime()>(new Date).getTime())a.$message({message:"结束时间必须小于今天",type:"warning"});else if(s=1,a.taskAnalysisData=[],console.log(a.task),0==a.task.length)a.$message({message:"无结果",type:"warning"});else if(a.task.length>1){for(n="analysis/schedule?sid="+a.task[0],o=1;o<a.task.length;o++)n=n+","+a.task[o];n=n+"&start="+a.start+"&end="+a.end,console.log(n),a.request(n,{},"GET").then((function(e){for(var t=function(t){console.log(e.data[a.task[t]]);var n={};n.taskid=s++,n.times=e.data[a.task[t]].times,a.timesTotal+=e.data[a.task[t]].times,n.incompleteTimes=e.data[a.task[t]].incompleteTimes,a.incompleteTimesTotal=e.data[a.task[t]].incompleteTimes,n.completeRate=e.data[a.task[t]].completeRate.toFixed(2)+"%",a.completeRateTotal+=e.data[a.task[t]].completeRate,n.overdueTimes=e.data[a.task[t]].overdueTimes,a.overdueTimesTotal+=e.data[a.task[t]].overdueTimes,n.recordTimes=e.data[a.task[t]].recordTimes,a.recordTimesTotal+=e.data[a.task[t]].recordTimes,n.onTimeRate=e.data[a.task[t]].onTimeRate+"%",a.onTimeRateTotal+=e.data[a.task[t]].onTimeRate,console.log(n),console.log(a.onTimeRateTotal),setTimeout((function(){a.taskAnalysisData.push(n)}),600)},n=0;n<a.task.length;n++)t(n)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){var e={};console.log(a.onTimeRateTotal,a.completeRateTotal),e.taskid="总计",e.times=a.timesTotal,e.recordTimes=a.recordTimesTotal,e.overdueTimes=a.overdueTimesTotal,e.incompleteTimes=a.incompleteTimesTotal/a.task.length,e.completeRate=(a.completeRateTotal/a.task.length).toFixed(2)+"%",e.onTimeRate=(a.onTimeRateTotal/a.task.length).toFixed(2)+"%",console.log(e),a.taskAnalysisData.unshift(e),a.$message({message:"查询成功",type:"success"})}),500)}else l="analysis/schedule?sid="+a.task[0]+"&start="+a.start+"&end="+a.end,a.request(l,{},"GET").then((function(e){console.log(e);for(var t=function(t){var n={};n.taskid=s++,n.times=e.data[a.task[0]].times,n.incompleteTimes=e.data[a.task[0]].incompleteTimes,n.completeRate=e.data[a.task[0]].completeRate.toFixed(2)+"%",n.onTimeRate=e.data[a.task[0]].onTimeRate.toFixed(2)+"%",n.overdueTimes=e.data[a.task[0]].overdueTimes,n.recordTimes=e.data[a.task[0]].recordTimes,console.log(n),setTimeout((function(){a.taskAnalysisData.push(n)}),600)},n=0;n<a.task.length;n++)t(n)})).catch((function(t){e.$message({message:t.response.data.message,type:"error"})})),setTimeout((function(){a.$message({message:"查询成功",type:"success"})}),300);case 8:case"end":return t.stop()}}),t)})))()},search:function(){var e=this;if(e.timesTotal=0,e.recordTimesTotal=0,e.incompleteTimesTotal=0,e.overdueTimesTotal=0,e.completeRateTotal=0,0==e.ifdeviceall&&0==e.deviceselectInfo.length||0==e.ifopsall&&0==e.opsvalue.length||0==e.iftaskall&&0==e.taskselectInfo.length)e.$message({message:"请将搜索信息填写完整",type:"warning"});else switch(!0){case 1==e.ifdeviceall&&1==e.ifopsall&&1==e.iftaskall:e.searchdata();break;case 1==e.ifdeviceall&&1==e.ifopsall&&0==e.iftaskall:e.confirmtask(),setTimeout((function(){e.task=e.task3,e.searchdata()}),1e3);break;case 1==e.ifdeviceall&&0==e.ifopsall&&1==e.iftaskall:e.confirmops(),setTimeout((function(){e.task=e.task2,e.searchdata()}),1e3);break;case 0==e.ifdeviceall&&1==e.ifopsall&&1==e.iftaskall:e.confirmdevice(),setTimeout((function(){e.task=e.task1,e.searchdata()}),1e3);break;case 0==e.ifdeviceall&&0==e.ifopsall&&1==e.iftaskall:e.confirmdevice(),e.confirmops(),setTimeout((function(){if(e.task=[],e.task2.length>e.task1.length)for(var t=0;t<e.task2.length;t++)for(var a=0;a<e.task1.length;a++)e.task1[a]===e.task2[t]&&e.task.push(e.task1[a]);else for(var s=0;s<e.task1.length;s++)for(var n=0;n<e.task2.length;n++)e.task2[n]===e.task1[s]&&e.task.push(e.task2[n]);e.searchdata()}),1e3);break;case 1==e.ifdeviceall&&0==e.ifopsall&&0==e.iftaskall:e.confirmops(),e.confirmtask(),setTimeout((function(){if(e.task=[],e.task3.length>e.task2.length)for(var t=0;t<e.task3.length;t++)for(var a=0;a<e.task2.length;a++)e.task2[a]===e.task3[t]&&e.task.push(e.task2[a]);else for(var s=0;s<e.task2.length;s++)for(var n=0;n<e.task3.length;n++)e.task3[n]===e.task2[s]&&e.task.push(e.task3[n]);e.searchdata()}),1e3);break;case 0==e.ifdeviceall&&1==e.ifopsall&&0==e.iftaskall:e.confirmdevice(),e.confirmtask(),setTimeout((function(){if(console.log(e.task1),console.log(e.task3),e.task=[],e.task3.length>e.task1.length)for(var t=0;t<e.task3.length;t++)for(var a=0;a<e.task1.length;a++)e.task1[a]===e.task3[t]&&e.task.push(e.task1[a]);else for(var s=0;s<e.task1.length;s++)for(var n=0;n<e.task3.length;n++)e.task3[n]===e.task1[s]&&e.task.push(e.task3[n]);e.searchdata()}),1e3);break;case 0==e.ifdeviceall&&0==e.ifopsall&&0==e.iftaskall:e.confirmdevice(),e.confirmops(),e.confirmtask(),setTimeout((function(){if(console.log(e.task1),console.log(e.task2),console.log(e.task3),e.task=[],e.task1.length>e.task2.length)if(e.task1.length>e.task3.length){for(var t=[],a=[],s=0;s<e.task1.length;s++)for(var n=0;n<e.task3.length;n++)e.task3[n]===e.task1[s]&&t.push(e.task3[n]);for(var o=0;o<e.task2.length;o++)for(var l=0;l<e.task1.length;l++)e.task1[l]===e.task2[o]&&a.push(e.task1[l]);if(t.length>a.length){for(var i=0;i<t.length;i++)for(var r=0;r<a.length;r++)a[r]===t[i]&&e.task.push(a[r]);e.searchdata()}else{for(var c=0;c<a.length;c++)for(var d=0;d<t.length;d++)t[d]===a[c]&&e.task.push(t[d]);e.searchdata()}}else{for(var u=[],p=[],v=0;v<e.task3.length;v++)for(var m=0;m<e.task1.length;m++)e.task1[m]===e.task3[v]&&u.push(e.task1[m]);for(var f=0;f<e.task3.length;f++)for(var g=0;g<e.task2.length;g++)e.task2[g]===e.task3[f]&&p.push(e.task2[g]);if(u.length>p.length){for(var h=0;h<u.length;h++)for(var b=0;b<p.length;b++)p[b]===u[h]&&e.task.push(p[b]);e.searchdata()}else{for(var y=0;y<p.length;y++)for(var T=0;T<u.length;T++)u[T]===p[y]&&e.task.push(u[T]);e.searchdata()}}else if(e.task3.length>e.task2.length){for(var k=[],x=[],_=0;_<e.task3.length;_++)for(var I=0;I<e.task1.length;I++)e.task1[I]===e.task3[_]&&k.push(e.task1[I]);for(var C=0;C<e.task3.length;C++)for(var E=0;E<e.task2.length;E++)e.task2[E]===e.task3[C]&&x.push(e.task2[E]);if(k.length>x.length){for(var D=0;D<k.length;D++)for(var $=0;$<x.length;$++)x[$]===k[D]&&e.task.push(x[$]);e.searchdata()}else{for(var w=0;w<x.length;w++)for(var q=0;q<k.length;q++)k[q]===x[w]&&e.task.push(k[q]);e.searchdata()}}else{for(var S=[],R=[],z=0;z<e.task2.length;z++)for(var O=0;O<e.task1.length;O++)e.task1[O]===e.task2[z]&&S.push(e.task1[O]);for(var A=0;A<e.task2.length;A++)for(var P=0;P<e.task3.length;P++)e.task3[P]===e.task2[A]&&R.push(e.task3[P]);if(S.length>R.length){for(var N=0;N<S.length;N++)for(var G=0;G<R.length;G++)R[G]===S[N]&&e.task.push(R[G]);e.searchdata()}else{for(var L=0;L<R.length;L++)for(var B=0;B<S.length;B++)S[B]===R[L]&&e.task.push(S[B]);e.searchdata()}}}),1e3);break;default:break}},confirmdevice:function(){var e=this;return Object(It["a"])(regeneratorRuntime.mark((function t(){var a,s,n,o,l,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,a.device=[],a.url="device/query?"+a.deviceselectInfo[0].ziduan+"=L"+a.deviceselectInfo[0].value+"%25",1!=a.deviceselectInfo.length){t.next=11;break}return t.next=6,a.request(a.url,{},"GET");case 6:for(s=t.sent,console.log(s.data),n=0;n<s.data.content.length;n++)a.device.push(s.data.content[n].id);t.next=17;break;case 11:for(o=1;o<a.deviceselectInfo.length;o++)a.url=a.url+"&"+a.deviceselectInfo[o].ziduan+"=L"+a.deviceselectInfo[o].value+"%25";return t.next=14,a.request(a.url,{},"GET");case 14:for(l=t.sent,console.log(l.data),i=0;i<l.data.content.length;i++)a.device.push(l.data.content[i].id);case 17:setTimeout((function(){if(console.log(a.device[0]),a.device.length>1){a.url="ops/query?device=I"+a.device[0];for(var e=1;e<a.device.length;e++)a.url=a.url+","+a.device[e]}else a.url="ops/query?device=I"+a.device[0];console.log(a.url);var t=a.request(a.url,{},"GET");console.log(t.data),a.task1=[];for(var s=0;s<t.data.content.length;s++)a.task1.push(t.data.content[s].id)}),300);case 18:case"end":return t.stop()}}),t)})))()},confirmops:function(){var e=this;return Object(It["a"])(regeneratorRuntime.mark((function t(){var a,s,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,a.opsselectInfo[0].value.length>1)for(a.url="ops/query?"+a.opsselectInfo[0].ziduan+"=I"+a.opsselectInfo[0].value[0],s=1;s<a.opsselectInfo[0].value.length;s++)a.url=a.url+","+a.opsselectInfo[0].value[s];else a.url="ops/query?"+a.opsselectInfo[0].ziduan+"=="+a.opsselectInfo[0].value;return console.log(a.url),t.next=5,a.request(a.url,{},"GET");case 5:for(n=t.sent,console.log(n.data),a.task2=[],o=0;o<n.data.content.length;o++)a.task2.push(n.data.content[o].id);case 9:case"end":return t.stop()}}),t)})))()},confirmtask:function(){var e=this;return Object(It["a"])(regeneratorRuntime.mark((function t(){var a,s,n,o,l,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,"name"==a.taskselectInfo[0].ziduan?a.url="ops/query?"+a.taskselectInfo[0].ziduan+"=L"+a.taskselectInfo[0].value+"%25":a.url="ops/query?"+a.taskselectInfo[0].ziduan+"=="+a.taskselectInfo[0].value,1!=a.taskselectInfo.length){t.next=11;break}return t.next=5,a.request(a.url,{},"GET");case 5:for(s=t.sent,console.log(s.data),a.task3=[],n=0;n<s.data.content.length;n++)a.task3.push(s.data.content[n].id);t.next=16;break;case 11:for(o=1;o<a.taskselectInfo.length;o++)"name"==a.taskselectInfo[o].ziduan?a.url=a.url+"&"+a.taskselectInfo[o].ziduan+"=L"+a.taskselectInfo[o].value+"%25":a.url=a.url+"&"+a.taskselectInfo[o].ziduan+"=="+a.taskselectInfo[o].value;for(l=a.request(a.url,{},"GET"),console.log(l.data),a.task3=[],i=0;i<l.data.content.length;i++)a.task3.push(l.data.content[i].id);case 16:case"end":return t.stop()}}),t)})))()},clear:function(){this.ifall=!1,this.taskselectvalue="",this.deviceselectvalue="",this.opsvalue="",this.deviceselectInfo=[],this.taskselectInfo=[],this.opsselectInfo=[],this.devicedynamicTags=[],this.taskdynamicTags=[],this.start="",this.end="",this.taskAnalysisData=[]}}},fa=ma,ga=(a("8b19"),Object(r["a"])(fa,pa,va,!1,null,null,null)),ha=ga.exports,ba=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"Container-BeginUse"},[s("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[s("el-breadcrumb-item",{staticClass:"pathActive"},[e._v("使用说明")]),s("el-breadcrumb-item",{staticClass:"active"},[e._v("开始使用")])],1),s("div",{staticClass:"Tabs"},[s("el-tabs",{attrs:{"tab-position":"top"},model:{value:e.tabsActiveName,callback:function(t){e.tabsActiveName=t},expression:"tabsActiveName"}},[s("el-tab-pane",{attrs:{label:"开始使用",name:"begin"}},[s("el-timeline",{staticStyle:{padding:"0 5px"}},[s("el-timeline-item",{attrs:{timestamp:"Tip1",placement:"top"}},[s("el-card",[s("h4",[e._v("1、软件首次使用者获得授权方的注册账号及密码；")]),s("h4",[e._v("2、该账号为系统管理员，具有Root权限；")]),s("h4",[e._v(" 3、使用该账号登录后可先更改密码，然后创建一个具有管理员权限的用户进行日常管理。 ")])])],1),s("el-timeline-item",{attrs:{timestamp:"Tip2",placement:"top"}},[s("el-card",[s("h4",[e._v(" 使用管理员账号登录后可创建并管理普通用户账号，分配普通用户权限，权限分为： ")]),s("p",{staticStyle:{"margin-top":"10px"}},[s("span",{staticStyle:{"font-weight":"bold"}},[e._v("Creator")]),e._v(" - 可创建维护设备、保养标准及协助"),s("span",{staticStyle:{"font-weight":"bold"}},[e._v(" Supervisor ")]),e._v("分配保养任务和查看维修任务，"),s("span",{staticStyle:{"font-weight":"bold",color:"red"}},[e._v(" 但不能进行数据分析 ")]),s("br"),s("span",{staticStyle:{"font-weight":"bold"}},[e._v("Supervisor")]),e._v(" - 可查看设备清单，可管理、分配保养和维修任务及进行数据分析，"),s("span",{staticStyle:{"font-weight":"bold",color:"red"}},[e._v(" 但不能创建和编辑 ")]),s("br"),s("span",{staticStyle:{"font-weight":"bold"}},[e._v("Operator")]),e._v(" - 可对分配到自己的设备进行保养、维修及报修 ")]),s("img",{staticStyle:{width:"98%","margin-top":"10px"},attrs:{src:a("4643")}})])],1),s("el-timeline-item",{attrs:{timestamp:"Tip3",placement:"top"}},[s("el-card",[s("h4",[e._v(" 1、用户使用管理员分配的账号及密码登录，密码可在登录后进行修改； ")]),s("h4",[e._v("2、当前登录用户的信息和权限显示在程序界面右上角。")])])],1),s("el-timeline-item",{attrs:{timestamp:"Tip4",placement:"top"}},[s("el-card",[s("h4",[e._v("用户根据权限完成相应的设备管理、保养维修及数据分析任务")])])],1)],1)],1),s("el-tab-pane",{attrs:{label:"用户管理",name:"first"}},[s("el-timeline",{staticStyle:{padding:"0 5px"}},[s("el-timeline-item",{attrs:{timestamp:"创建管理员账号",placement:"top"}},[s("el-card",[s("h4",[e._v("1、以Root权限账号和密码登录系统；")]),s("h4",[e._v(' 2、在"用户管理"菜单项下，点击'),s("a",{attrs:{href:"./#/authorize"}},[e._v("人员管理")]),e._v("； ")]),s("h4",[e._v("3、填入管理员用户注册信息，其中权限可随意选择；")]),s("h4",[e._v('4、点击"注册"按钮完成用户注册；')]),s("h4",[e._v(" 5、重新回到"),s("a",{attrs:{href:"./#/authorize"}},[e._v("人员管理")]),e._v("页面在右侧的授权区选择管理员用户名； ")]),s("h4",[e._v("6、更改权限为ADMIN。")])])],1),s("el-timeline-item",{attrs:{timestamp:"创建普通用户账号",placement:"top"}},[s("el-card",[s("h4",[e._v("1、以Root权限账号和密码登录系统；")]),s("h4",[e._v(' 2、在"用户管理"菜单项下，点击'),s("a",{attrs:{href:"./#/authorize"}},[e._v("人员管理")]),e._v("； ")]),s("h4",[e._v("3、填入普通用户注册信息，根据需要选择权限；")]),s("h4",[e._v('4、点击"注册"按钮完成用户注册。')])])],1),s("el-timeline-item",{attrs:{timestamp:"更改注册信息",placement:"top"}},[s("el-card",[s("h4",[e._v("1、以自己的账号和密码登录系统；")]),s("h4",[e._v(' 2、在"用户管理"菜单项下，点击'),s("a",{attrs:{href:"./#/edituser"}},[e._v("修改信息")]),e._v("； ")]),s("h4",[e._v("3、可修改姓名、头像、邮箱和密码；")]),s("h4",[e._v('4、修改完成后，点击"保存修改"按钮。')])])],1),s("el-timeline-item",{attrs:{timestamp:"管理员修改普通用户注册信息",placement:"top"}},[s("el-card",[s("h4",[e._v("1、以管理员账号和密码登录系统；")]),s("h4",[e._v(' 2、在"用户管理"菜单项下，点击'),s("a",{attrs:{href:"./#/userList"}},[e._v("用户列表")]),e._v("，可看到当前所有注册用户； ")]),s("h4",[e._v(' 3、选择需要修改信息的用户，在最右列的"操作"项下点击"修改"； ')]),s("h4",[e._v("4、更新用户注册信息；")]),s("h4",[e._v('5、点击"保存修改"按钮。')])])],1),s("el-timeline-item",{attrs:{timestamp:"管理员删除普通用户",placement:"top"}},[s("el-card",[s("h4",[e._v("1、以管理员账号和密码登录系统；")]),s("h4",[e._v(' 2、在"用户管理"菜单项下，点击'),s("a",{attrs:{href:"./#/userList"}},[e._v("用户列表")]),e._v("，可看到当前所有注册用户； ")]),s("h4",[e._v('3、选择需要删除的用户，在最右列的"操作"项下点击"删除"；')]),s("h4",[e._v("4、该用户将从用户列表中删除，不能再登录系统。")])])],1),s("el-timeline-item",{attrs:{timestamp:"管理员更改普通用户权限",placement:"top"}},[s("el-card",[s("h4",[e._v("1、以管理员账号和密码登录系统；")]),s("h4",[e._v(' 2、在"用户管理"菜单项下，点击'),s("a",{attrs:{href:"./#/authorize"}},[e._v("人员管理")]),e._v("； ")]),s("h4",[e._v("3、在右侧的授权区选择要更改权限的用户及新的权限；")]),s("h4",[e._v('4、点击"保存修改"按钮。')])])],1)],1)],1),s("el-tab-pane",{attrs:{label:"设备管理",name:"second"}},[s("el-timeline",{staticStyle:{padding:"0 5px"}},[s("el-timeline-item",{attrs:{timestamp:"从空白模板创建设备信息",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备管理"菜单项下，点击'),s("a",{attrs:{href:"./#/addDevice"}},[e._v("新增设备")]),e._v("； ")]),s("h4",[e._v(" 2、根据字段名填入相应的字段信息（程序预置了基本字段，为必填项）； ")]),s("h4",[e._v(' 3、如需增加新的字段，点击右边拓展信息下的"新增字段"按钮，并输入字段名和字段信息； ')]),s("h4",[e._v("4、保存提交；")]),s("h4",[e._v(" 5、在"),s("a",{attrs:{href:"./#/deviceInformation"}},[e._v("设备信息")]),e._v("中，可以看到当前设备清单； ")])])],1),s("el-timeline-item",{attrs:{timestamp:"从EXCEL文件导入设备信息",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备管理"菜单项下点击'),s("a",{attrs:{href:"./#/addDevice"}},[e._v("新增设备")]),e._v("，创建一条设备记录； ")]),s("h4",[e._v(' 2、在新增设备页面点击"新增字段"按钮，创建EXCEL文件中需要导入的字段； ')]),s("h4",[e._v(' 3、在"设备管理"菜单项下点击'),s("a",{attrs:{href:"./#/deviceInformation"}},[e._v("设备信息")]),e._v("，确保所有需导入的字段都出现在列表中，然后将此条设备记录删除； ")]),s("h4",[e._v(" 4、点击"),s("a",{attrs:{href:"./#/deviceInformation"}},[e._v("设备信息")]),e._v('页面上方的"导出"按钮，将在系统默认目录下生成空的EXCEL文件； ')]),s("h4",[e._v(" 5、将要导入的EXCEL文件中内容复制到生成的EXCEL文件中并保存； ")]),s("h4",[e._v('6、点击"导入"按钮，选择导入生成的EXCEL文件；')]),s("h4",[e._v(" 7、在"),s("a",{attrs:{href:"./#/deviceInformation"}},[e._v("设备信息")]),e._v("中，可以看到从EXCEL文件导入的设备清单； ")])])],1),s("el-timeline-item",{attrs:{timestamp:"修改设备信息",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备管理"菜单项下点击'),s("a",{attrs:{href:"./#/deviceInformation"}},[e._v("设备信息")]),e._v("； ")]),s("h4",[e._v('2、在设备列表页面的最右列的"操作"项下，点击"修改"；')]),s("h4",[e._v("3、在设备信息编辑框中修改设备信息；")]),s("h4",[e._v('4、点击"确认修改"按钮。')])])],1),s("el-timeline-item",{attrs:{timestamp:"修改设备字段",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备管理"菜单项下，点击'),s("a",{attrs:{href:"./#/addDevice"}},[e._v("新增设备")]),e._v("； ")]),s("h4",[e._v(" 2、在"),s("a",{attrs:{href:"./#/addDevice"}},[e._v("新增设备")]),e._v('页面的"拓展信息"下能看到用户自行添加的设备字段； ')]),s("h4",[e._v(' 3、点击"修改字段"按钮，在跳出的对话框中选择要更改的字段及更改内容； ')]),s("h4",[e._v('4、点击"确定"按钮。')])])],1),s("el-timeline-item",{attrs:{timestamp:"删除单台设备",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备管理"菜单项下点击'),s("a",{attrs:{href:"./#/deviceInformation"}},[e._v("设备信息")]),e._v("； ")]),s("h4",[e._v("2、在设备列表页面中找到要删除的设备；")]),s("h4",[e._v('3、在最右列的"操作"项下，点击"删除"。')])])],1),s("el-timeline-item",{attrs:{timestamp:"删除多台设备",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备管理"菜单项下点击'),s("a",{attrs:{href:"./#/deviceInformation"}},[e._v("设备信息")]),e._v("； ")]),s("h4",[e._v(" 2、在设备列表页面勾选要删除的设备或利用设备查询功能选出要删除的设备并勾选全部； ")]),s("h4",[e._v('3、点击右上角的"批量删除"按钮。')])])],1),s("el-timeline-item",{attrs:{timestamp:"删除设备字段",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备管理"菜单项下，点击'),s("a",{attrs:{href:"./#/addDevice"}},[e._v("新增设备")]),e._v("； ")]),s("h4",[e._v(" 2、在"),s("a",{attrs:{href:"./#/addDevice"}},[e._v("新增设备")]),e._v('页面的"拓展信息"下能看到用户自行添加的设备字段； ')]),s("h4",[e._v("3、勾选需要删除的字段名；")]),s("h4",[e._v(' 4、点击"删除字段"按钮。（注意： '),s("span",{staticStyle:{"font-weight":"bold",color:"red"}},[e._v(" 该操作将删除所有在设备列表中已经生成的设备相应字段及其内容 ")]),e._v("） ")])])],1),s("el-timeline-item",{attrs:{timestamp:"设备查询",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备管理"菜单项下点击'),s("a",{attrs:{href:"./#/deviceInformation"}},[e._v("设备信息")]),e._v("； ")]),s("h4",[e._v("2、在设备列表页面上方的下拉框中选择按照哪个字段查询；")]),s("h4",[e._v("3、在跳出的对话框中输入该字段的查询内容；")]),s("h4",[e._v("4、点击确定后该搜索条件将显示在下拉框和搜索按钮之间；")]),s("h4",[e._v("5、可重复第2-4步设定多个字段的组合查询条件；")]),s("h4",[e._v(' 6、点击"搜索"按钮，符合查询条件的设备将显示在设备列表中。 ')])])],1),s("el-timeline-item",{attrs:{timestamp:"导出设备信息到EXCEL文件",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备管理"菜单项下点击'),s("a",{attrs:{href:"./#/deviceInformation"}},[e._v("设备信息")]),e._v("； ")]),s("h4",[e._v(' 2、在设备列表页面上方点击"获取全部设备"按钮，或设定条件查询设备； ')]),s("h4",[e._v('3、点击"导出"按钮，将在系统默认目录下生成EXCEL文件。')])])],1)],1)],1),s("el-tab-pane",{attrs:{label:"设备保养",name:"third"}},[s("el-timeline",{staticStyle:{padding:"0 5px"}},[s("el-timeline-item",{attrs:{timestamp:"从空白模板创建保养标准",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备保养"菜单项下，点击'),s("a",{attrs:{href:"./#/addTask"}},[e._v("新增标准")]),e._v("； ")]),s("h4",[e._v('2、点击"新增标准"按钮；')]),s("h4",[e._v(" 3、在页面中输入用户自行定义的标准名、标准编号、保养周期等基本项； ")]),s("h4",[e._v(' 4、在页面右侧的保养内容部分，点击"+"输入标题项（通常为保养执行步骤），再输入具体保养内容。保养内容输入支持Rich Text（富文本编辑）格式，并可插入图片。可重复点击"+"输入多个保养步骤； ')]),s("h4",[e._v('5、完成全部输入后点击"保存并提交"按钮；')]),s("h4",[e._v(" 6、在"),s("a",{attrs:{href:"./#/addTask"}},[e._v("新增标准")]),e._v("页面可以看到当前已创建的保养标准清单。 ")])])],1),s("el-timeline-item",{attrs:{timestamp:"从已有模板创建保养标准",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备保养"菜单项下，点击'),s("a",{attrs:{href:"./#/addTask"}},[e._v("新增标准")]),e._v("； ")]),s("h4",[e._v("2、在新增标准页面找到某个已创建的保养标准；")]),s("h4",[e._v('3、在最右列的"操作"项下点击"以此为模板新增"；')]),s("h4",[e._v(' 4、在新增标准页面上修改已有保养标准的变化部分。如需修改保养内容，点击保养内容标题项，在弹出的"功能选择"对话框中选择"修改内容"； ')]),s("h4",[e._v('5、完成修改后点击"保存并提交"按钮。')])])],1),s("el-timeline-item",{attrs:{timestamp:"修改保养标准",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备保养"菜单项下，点击'),s("a",{attrs:{href:"./#/addTask"}},[e._v("新增标准")]),e._v("； ")]),s("h4",[e._v("2、在新增标准页面找到需要修改的保养标准；")]),s("h4",[e._v('3、在最右列的"操作"项下点击"修改标准"；')]),s("h4",[e._v(' 4、编辑需要修改的部分。如需修改保养内容，点击保养内容标题项，在弹出的"功能选择"对话框中选择"修改内容"； ')]),s("h4",[e._v('5、完成修改后点击"保存并提交"按钮。')])])],1),s("el-timeline-item",{attrs:{timestamp:"删除保养标准",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备保养"菜单项下，点击'),s("a",{attrs:{href:"./#/addTask"}},[e._v("新增标准")]),e._v("； ")]),s("h4",[e._v("2、在新增标准页面找到需要删除的保养标准；")]),s("h4",[e._v('3、在最右列的"操作"项下点击"删除"；')]),s("h4",[e._v(' 4、也可勾选多个要删除的保养标准并点击右上角的"批量删除"按钮。 ')])])],1),s("el-timeline-item",{attrs:{timestamp:"分配保养任务",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备保养"菜单项下，点击'),s("a",{attrs:{href:"./#/tssignTask"}},[e._v("任务分配")]),e._v("； ")]),s("h4",[e._v(" 2、按照页面提示选择待保养的设备、保养标准、保养执行人员以及下次保养开始时间； ")]),s("h4",[e._v("3、保存并提交；")]),s("h4",[e._v(" 4、点击"),s("a",{attrs:{href:"./#/totalTaskList"}},[e._v("保养列表")]),e._v("可看到针对每台设备所分配的保养任务。 ")])])],1),s("el-timeline-item",{attrs:{timestamp:"修改保养任务",placement:"top"}},[s("el-card",[s("h4",[e._v(" 1、在"),s("a",{attrs:{href:"./#/totalTaskList"}},[e._v("保养列表")]),e._v("页面找到需要修改的保养任务； ")]),s("h4",[e._v('2、在最右列"操作"任务下点击"修改"；')]),s("h4",[e._v(" 3、在修改任务分配页面中可更改对当前设备分配的保养人员及下次保养开始时间。（注意： "),s("span",{staticStyle:{"font-weight":"bold",color:"red"}},[e._v(" 如需更改保养任务参照的保养标准，则需要先删除该保养任务，再重新分配 ")]),e._v("）； ")]),s("h4",[e._v("4、保存并提交。")])])],1),s("el-timeline-item",{attrs:{timestamp:"删除保养任务",placement:"top"}},[s("el-card",[s("h4",[e._v(" 1、在"),s("a",{attrs:{href:"./#/totalTaskList"}},[e._v("保养列表")]),e._v("页面找到需要修改的保养任务； ")]),s("h4",[e._v(' 2、在最右列"操作"任务下点击"解绑"。该操作将与某台设备提供任务分配绑定的保养标准和人员解除绑定。 ')])])],1),s("el-timeline-item",{attrs:{timestamp:"在Web端执行保养任务",placement:"top",color:"#409eff"}},[s("el-card",[s("h4",[e._v(" 1、在"),s("a",{attrs:{href:"./#/totalTaskList"}},[e._v("保养列表")]),e._v("页面找到需要执行的保养任务； ")]),s("h4",[e._v('2、在最右列"操作"任务下点击"执行"；')]),s("h4",[e._v(" 3、参照保养内容执行具体步骤，每步执行完毕后勾选该步骤标题； ")]),s("h4",[e._v(" 4、所有步骤完成并勾选后，填写底部的保养记录，该记录支持Rich Text格式编辑（富文本编辑）并可上传图片； ")]),s("h4",[e._v(' 5、若保养执行中发现保养人员不能自我修复的问题，打开"是否不能自我修复"开关到"是"状态。否则忽略此步骤； ')]),s("h4",[e._v(' 6、点击"提交"。若第5步存在不能自我修复的问题，则保养任务提交后会自动进入故障'),s("a",{attrs:{href:"./#/fixApply"}},[e._v("报修申请")]),e._v("页面。请参照故障报修相关操作进行后续处理。 ")])])],1),s("el-timeline-item",{attrs:{timestamp:"在移动端执行保养任务",placement:"top",color:"#409eff"}},[s("el-card",[s("h4",[e._v(" 1、以 Operator 权限用户ID登录后，在首页上可直接看到分配到此ID的保养和维修任务； ")]),s("h4",[e._v("2、点击任务后进入具体的任务执行页面；")]),s("h4",[e._v("3、按步骤执行保养内容并勾选相应步骤；")]),s("h4",[e._v(" 4、所有步骤完成并勾选后，填写底部的保养记录并可上传图片。 ")])])],1),s("el-timeline-item",{attrs:{timestamp:"查询保养任务",placement:"top"}},[s("el-card",[s("h4",[e._v(" 1、在"),s("a",{attrs:{href:"./#/totalTaskList"}},[e._v("保养列表")]),e._v("页面上方的下拉框选择按哪个字段查询； ")]),s("h4",[e._v("2、在跳出的对话框中输入该字段的查询内容；")]),s("h4",[e._v("3、点击确定后该搜索条件将显示在下拉框和搜索按钮之间；")]),s("h4",[e._v("4、可重复第1步到第3步设定多个字段的组合查询条件；")]),s("h4",[e._v('5、点击"查询"按钮。')])])],1)],1)],1),s("el-tab-pane",{attrs:{label:"设备维修",name:"fourth"}},[s("el-timeline",{staticStyle:{padding:"0 5px"}},[s("el-timeline-item",{attrs:{timestamp:"设备故障报修申请",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备维修"菜单项下，点击'),s("a",{attrs:{href:"./#/fixApply"}},[e._v("报修申请")]),e._v("； ")]),s("h4",[e._v(" 2、在报修申请页面通过下拉框选择故障设备。（Tips： "),s("span",{staticStyle:{"font-weight":"normal"}},[e._v(" 下拉框中无设备可选时，需要输入故障设备编号，点击查找按钮。查找成功后该设备将进入下拉框可供选择。")]),s("span",{staticStyle:{"font-weight":"bold",color:"red"}},[e._v(" Tips中功能仅对 Operator 权限开放 ")]),e._v("）； ")]),s("h4",[e._v("3、在异常描述和处理请求编辑框输入文字或图片；")]),s("h4",[e._v(" 4、输入完成后在底部的下拉框选择提交给管理人员。只有具备 Supervisor 权限的用户才能出现在下拉框中供选择； ")]),s("h4",[e._v(' 5、在"设备维修"菜单项下点击'),s("a",{attrs:{href:"./#/mySubmit"}},[e._v("我发布的")]),e._v('，可以看到当前用户报修申请的处理状态变为"已申请"。 ')])])],1),s("el-timeline-item",{attrs:{timestamp:"分配报修任务",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、具有 Supervisor 权限的用户登录后，在"设备维修"菜单项下点击'),s("a",{attrs:{href:"./#/alreadyFix"}},[e._v("分配到我的")]),e._v("，可以看到所有提交给当前用户的报修申请； ")]),s("h4",[e._v('2、点击最右列"操作"项下的"查看详情"；')]),s("h4",[e._v(' 3、在"查看详情"页面"分配"这一步下，点击"分配此申请"按钮； ')]),s("h4",[e._v('4、在跳出的对话框中选择维修人员，并点击"确定"按钮；')]),s("h4",[e._v(' 5、在"查看详情"页面上方的时间线中可以看到当前维修任务的分配已完成。报修列表中的"维修状态"变为"已分配"。 ')])])],1),s("el-timeline-item",{attrs:{timestamp:"在Web端执行报修任务",placement:"top",color:"#409eff"}},[s("el-card",[s("h4",[e._v(" 1、以 Operator 权限用户ID登录，在“设备维修“菜单项下点击"),s("a",{attrs:{href:"./#/alreadyFix"}},[e._v("分配到我的")]),e._v("； ")]),s("h4",[e._v(' 2、选择要处理的维修任务，在最右列的"操作"项下点击"查看详情"； ')]),s("h4",[e._v(' 3、在"查看详情"页面"修复"这一步下，输入故障诊断和修复情况，然后点击"确认提交"； ')]),s("h4",[e._v(' 4、在"查看详情"页面上方的时间线中可以看到当前维修任务的修复已完成。报修列表中的"维修状态"变为"已修复"。 ')]),s("h4",[e._v(' 5、报修人员在"设备维修"菜单项下点击'),s("a",{attrs:{href:"./#/mySubmit"}},[e._v("我发布的")]),e._v("； ")]),s("h4",[e._v(" 6、在"),s("a",{attrs:{href:"./#/mySubmit"}},[e._v("我发布的")]),e._v('页面找到维修状态为"已修复"的任务，在最右列的操作项下点击"查看详情"； ')]),s("h4",[e._v(' 7、在查看详情页面"完成"这一步下，点击"确认"按钮，上方的时间线中可以看到当前维修任务已完成。报修列表中的"维修状态"变为"已完成"。任务结束。 ')]),s("h4",[e._v(' 8、若报修人员认为仍然存在故障，可点击"拒绝"按钮，维修任务的状态退回到"已分配"，由维修人员重新进行维修诊断直至报修人员最终确认。 ')])])],1),s("el-timeline-item",{attrs:{timestamp:"在移动端执行报修任务",placement:"top",color:"#409eff"}},[s("el-card",[s("h4",[e._v(" 1、以 Operator 权限用户ID登录后，在首页上可直接看到分配到此ID的保养和维修任务； ")]),s("h4",[e._v(" 2、在维修任务下点击待处理的异常设备，可看到具体的异常描述和维修需求； ")]),s("h4",[e._v('3、点击"开始维修"按钮；')]),s("h4",[e._v(" 4、按要求记录维修过程。其中解决措施部分支持Rich Text文本输入及图片上传； ")]),s("h4",[e._v('5、点击"维修完成"按钮；')])])],1),s("el-timeline-item",{attrs:{timestamp:"查询报修任务",placement:"top"}},[s("el-card",[s("h4",[e._v(' 1、在"设备维修"菜单项下，点击'),s("a",{attrs:{href:"./#/allError"}},[e._v("全部报修")]),e._v("； ")]),s("h4",[e._v(" 2、在全部报修列表页面上方的下拉框中选择查询字段，设定查询内容； ")]),s("h4",[e._v("3、点击确定后该搜索条件将显示在下拉框和搜索按钮之间；")]),s("h4",[e._v("4、可重复第1步到第3步设定多个字段的组合查询条件；")]),s("h4",[e._v('5、点击"查询"按钮。')])])],1)],1)],1),s("el-tab-pane",{attrs:{label:"数据分析",name:"fifth"}},[s("el-timeline",{staticStyle:{padding:"0 5px"}},[s("el-timeline-item",{attrs:{timestamp:"使用日志",placement:"top"}},[s("el-card",[s("h4",[e._v(" 点击"),s("a",{attrs:{href:"./#/dailyRecord"}},[e._v("使用日志")]),e._v("可查看用户登录情况及进行的操作。（"),s("span",{staticStyle:{"font-weight":"bold",color:"red"}},[e._v(" 仅对管理员开放")]),e._v("） ")])])],1),s("el-timeline-item",{attrs:{timestamp:"保养分析",placement:"top"}},[s("el-card",[s("h4",[e._v("1、点击"),s("a",{attrs:{href:"./#/taskAnalysis"}},[e._v("保养分析")]),e._v("；")]),s("h4",[e._v(" 2、确定分析范围。可通过选择设备、人员、保养及时间段来确定数据分析的范围； ")]),s("h4",[e._v(" 3、结果显示在分析范围内的应该执行的保养总数、完成率等指标。 ")])])],1),s("el-timeline-item",{attrs:{timestamp:"维修分析",placement:"top"}},[s("el-card",[s("h4",[e._v("1、点击"),s("a",{attrs:{href:"./#/fixAnalysis"}},[e._v("维修分析")]),e._v("；")]),s("h4",[e._v(" 2、确定分析范围。可通过选择设备、人员及时间段来确定数据分析的范围； ")]),s("h4",[e._v(" 3、结果显示在分析范围内设备故障总时间、平均维修耗时（MTTR）及平均故障周期（MTBF）等指标。 ")])])],1)],1)],1)],1)],1)],1)},ya=[],Ta={data:function(){return{tabsActiveName:"begin"}}},ka=Ta,xa=(a("d81b"),Object(r["a"])(ka,ba,ya,!1,null,null,null)),_a=xa.exports,Ia=function(){return a.e("chunk-28f0112b").then(a.bind(null,"f398"))},Ca=function(){return a.e("chunk-072d4340").then(a.bind(null,"57da"))};s["default"].use(u["a"]);var Ea=[{path:"/",name:"Login",component:Ia},{path:"/",component:Ca,redirect:"/userList",children:[{path:"/userList",component:h},{path:"/authorize",component:_},{path:"/edituser",component:S},{path:"/addDevice",component:N},{path:"/deviceInformation",component:se},{path:"/editDevice",component:ce},{path:"/code",component:fe},{path:"/addTask",component:ke},{path:"/addTaskInside",component:we},{path:"/editTask",component:Ae},{path:"/alterTaskContent",component:Ve},{path:"/taskDetailInfo",component:He},{path:"/totalTaskList",component:tt},{path:"/tssignTask",component:it},{path:"/allError",component:kt},{path:"/errorDetail",component:wt},{path:"/fixApply",component:ft},{path:"/alreadyFix",component:At},{path:"/mySubmit",component:Mt},{path:"/mySubmitDetail",component:Jt},{path:"/dailyRecord",component:Kt},{path:"/dailyRecordDetail",component:oa},{path:"/fixAnalysis",component:ua},{path:"/taskAnalysis",component:ha},{path:"/beginUse",component:_a}]}],Da=new u["a"]({routes:Ea}),$a=Da,wa=a("5c96"),qa=a.n(wa);a("0fae"),a("34c4"),a("82da");D.a.defaults.withCredentials=!0,D.a.defaults.headers.common["Authorization"]=localStorage.getItem("token");var Sa=function(){var e=Object(It["a"])(regeneratorRuntime.mark((function e(t){var a,s,n,o,l,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=i.length>1&&void 0!==i[1]?i[1]:{},s=i.length>2&&void 0!==i[2]?i[2]:"",n=i.length>3&&void 0!==i[3]?i[3]:{},o=i.length>4&&void 0!==i[4]?i[4]:"",l="http://1.15.236.205/api/",e.prev=5,e.abrupt("return",new Promise((function(e,i){console.log(l+t),D()({url:l+t,data:a,method:s,headers:n,responseType:o}).then((function(t){e(t)})).catch((function(e){i(e)}))})));case 9:e.prev=9,e.t0=e["catch"](5),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[5,9]])})));return function(t){return e.apply(this,arguments)}}();s["default"].prototype.$http=D.a,s["default"].prototype.request=Sa,s["default"].prototype.globaldata=K,s["default"].config.productionTip=!1,s["default"].use(qa.a),s["default"].use(Ie["quillEditor"]),new s["default"]({el:"#app",router:$a,render:function(e){return e(d)}}).$mount("#app")},5885:function(e,t,a){},"5cd3":function(e,t,a){},"64b8":function(e,t,a){"use strict";a("1652")},6918:function(e,t,a){e.exports=a.p+"img/avator.ec2dda3b.png"},"6aa7":function(e,t,a){},"77ec":function(e,t,a){},"79e2":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"User_info"},[s("div",{staticClass:"user_info_icon"},[1==e.ifavator?s("img",{attrs:{src:e.avatar,id:"img"}}):s("img",{attrs:{src:a("6918")}})]),s("div",{staticClass:"user_info_detail"},[s("div",{staticClass:"info"},[s("span",[e._v("姓名：")]),e._v(e._s(e.name))]),s("div",{staticClass:"info"},[s("span",[e._v("用户名：")]),e._v(e._s(e.username))]),s("div",{staticClass:"info"},[s("span",[e._v("用户邮箱：")]),e._v(e._s(e.useremail))])])])},n=[],o={data:function(){return{ifavator:""}},props:{name:String,username:String,useremail:String,avatar:String},created:function(){var e=this;setTimeout((function(){e.ifavator=!1,console.log(e.avatar),e.ifavator=void 0!=e.avatar}),500)},methods:{}},l=o,i=(a("8dd7"),a("2877")),r=Object(i["a"])(l,s,n,!1,null,null,null);t["a"]=r.exports},"7ef6":function(e,t,a){"use strict";a("eae6")},"7f8a":function(e,t,a){"use strict";a("bf6c")},"82da":function(e,t,a){},"85ec":function(e,t,a){},"88d9":function(e,t,a){},"8b19":function(e,t,a){"use strict";a("3b09")},"8dd7":function(e,t,a){"use strict";a("c439")},"8ed7":function(e,t,a){"use strict";a("b118")},"945e":function(e,t,a){"use strict";a("056a")},9847:function(e,t,a){},"9b3f":function(e,t,a){},a5c0:function(e,t,a){"use strict";a("edee")},a86b:function(e,t,a){"use strict";a("5051")},a88f:function(e,t,a){"use strict";a("02ea")},a9e7:function(e,t,a){},b118:function(e,t,a){},ba9b:function(e,t,a){"use strict";a("9847")},bbed:function(e,t,a){"use strict";a("77ec")},bf6c:function(e,t,a){},c000:function(e,t,a){"use strict";a("f5ed")},c2e6:function(e,t,a){"use strict";a("181c")},c439:function(e,t,a){},c6f3:function(e,t,a){"use strict";a("406b")},c789:function(e,t,a){"use strict";a("4e39")},cb33:function(e,t,a){"use strict";a("a9e7")},d590:function(e,t,a){"use strict";a("11e3")},d81b:function(e,t,a){"use strict";a("5cd3")},db90:function(e,t,a){},df4d:function(e,t,a){"use strict";a("00ea")},eae6:function(e,t,a){},edee:function(e,t,a){},f07e:function(e,t,a){"use strict";a("5885")},f2ba:function(e,t,a){},f5ed:function(e,t,a){}});